<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="eda_files/libs/clipboard/clipboard.min.js"></script>
<script src="eda_files/libs/quarto-html/quarto.js"></script>
<script src="eda_files/libs/quarto-html/popper.min.js"></script>
<script src="eda_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="eda_files/libs/quarto-html/anchor.min.js"></script>
<link href="eda_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="eda_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="eda_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="eda_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="eda_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="eda_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="eda_files/libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="eda_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="eda_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="eda_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="eda_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="eda_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="eda_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="exploratory-data-analysis" class="level1">
<h1>3 Exploratory Data Analysis</h1>
<p>Let’s proceed with our exploratory data analysis to ensure a thorough analysis that will contribute to answering our research question. As mentioned in our data description, we’ve consolidated our principal variables into a single dataframe named <code>raw_df</code>. This particular dataframe retains this name because it presents data in its original form, without scaling for population size, which is useful for analyzing overall data patterns. Additionally, we have created <code>all_df</code>, a dataframe that standardizes data on a per capita basis for all of our 77 countries. These dataframes form the basis of our exploratory data analysis.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center" data-result="asis">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the table</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variables =</span> <span class="fu">c</span>(<span class="st">"Country"</span>,<span class="st">"Year"</span>, <span class="st">"CO2 emissions"</span>, <span class="st">"PM2.5"</span>, <span class="st">"Wind Generation - TWh"</span>, <span class="st">"Solar Generation - TWh"</span>, <span class="st">"Geo Biomass Other - TWh"</span>, <span class="st">"Hydro Generation - TWh"</span>, <span class="st">"Nuclear Generation - TWh"</span>,   <span class="st">"Population"</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Meaning =</span> <span class="fu">c</span>(<span class="st">"Country"</span>,<span class="st">"Year"</span>,<span class="st">"Country"</span>,<span class="st">"Year"</span>, <span class="st">"TWh generation from Wind"</span>, <span class="st">"TWh generation from Solar"</span>, <span class="st">"TWh generation from Geothermal and others"</span>, <span class="st">"TWh generation from Hydro"</span>, <span class="st">"TWh generation from Nuclear"</span>, <span class="st">"Number of inhabitants in the country"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rendering the table with knitr::kable</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(data_table, <span class="at">format =</span> <span class="st">"html"</span>, <span class="at">caption =</span> <span class="st">"Table 3.1: raw_df"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 3.1: raw_df</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variables</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Country</td>
<td style="text-align: left;">Country</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: left;">Year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2 emissions</td>
<td style="text-align: left;">Country</td>
</tr>
<tr class="even">
<td style="text-align: left;">PM2.5</td>
<td style="text-align: left;">Year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wind Generation - TWh</td>
<td style="text-align: left;">TWh generation from Wind</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solar Generation - TWh</td>
<td style="text-align: left;">TWh generation from Solar</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Geo Biomass Other - TWh</td>
<td style="text-align: left;">TWh generation from Geothermal and others</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hydro Generation - TWh</td>
<td style="text-align: left;">TWh generation from Hydro</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nuclear Generation - TWh</td>
<td style="text-align: left;">TWh generation from Nuclear</td>
</tr>
<tr class="even">
<td style="text-align: left;">Population</td>
<td style="text-align: left;">Number of inhabitants in the country</td>
</tr>
</tbody>
</table>


</div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 3.1: raw_df</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variables</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Country</td>
<td style="text-align: left;">Country</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: left;">Year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2 emissions</td>
<td style="text-align: left;">Country</td>
</tr>
<tr class="even">
<td style="text-align: left;">PM2.5</td>
<td style="text-align: left;">Year</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wind Generation - TWh</td>
<td style="text-align: left;">TWh generation from Wind</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solar Generation - TWh</td>
<td style="text-align: left;">TWh generation from Solar</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Geo Biomass Other - TWh</td>
<td style="text-align: left;">TWh generation from Geothermal and others</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hydro Generation - TWh</td>
<td style="text-align: left;">TWh generation from Hydro</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nuclear Generation - TWh</td>
<td style="text-align: left;">TWh generation from Nuclear</td>
</tr>
<tr class="even">
<td style="text-align: left;">Population</td>
<td style="text-align: left;">Number of inhabitants in the country</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We will begin this EDA by identifying any noticeable trends and data structure by contrasting data from all, developed and undeveloped countries. This will help us better understand the different effect that renewable energy generation may have depending of the development of countries. Subsequently, we will examine the specifics of renewable energy generation, CO2 emissions and PM2.5 exposure, looking at both the global perspective and individual country scale. Lastly, we will aim to explore the relationship between renewable energy generation, CO2 emissions, and PM2.5 levels.</p>
<section id="data-distribution" class="level2">
<h2 class="anchored" data-anchor-id="data-distribution">3.1 Data distribution</h2>
<section id="histogram-plot" class="level3">
<h3 class="anchored" data-anchor-id="histogram-plot">3.1.1 Histogram plot</h3>
<p>We begin our analysis by examining the spread of our numerical data. To visualize this, we have created a histogram that displays the distribution across all countries, as well as separately for developed and developing nations. This initial comparison will offer us a glimpse into how renewable energy generation and CO2 emissions vary among countries with diverse economic and demographic profiles.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Facet grid for histogram</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape our dataframes into a long format to create an histogram</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>longall_df <span class="ot">&lt;-</span> <span class="fu">melt</span>(all100_1990[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>)]) <span class="co"># for all country</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>longdev_df <span class="ot">&lt;-</span> <span class="fu">melt</span>(alldev100_1990[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>)]) <span class="co"># for developed country</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>longnondev_df <span class="ot">&lt;-</span> <span class="fu">melt</span>(allnondev100_1990[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>)]) <span class="co"># for non developed country</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column to each to indicate the development status</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>longall_df<span class="sc">$</span>Status <span class="ot">&lt;-</span> <span class="st">'All'</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>longdev_df<span class="sc">$</span>Status <span class="ot">&lt;-</span> <span class="st">'Developed'</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>longnondev_df<span class="sc">$</span>Status <span class="ot">&lt;-</span> <span class="st">'Non-Developed'</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the three dataframes into one</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>hcombined_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(longall_df,longdev_df, longnondev_df)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histograms with facet_grid to ensure same scales</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hcombined_df, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Status <span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free_x"</span>, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">variable =</span> <span class="fu">c</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>               <span class="st">"CO2_emissions"</span> <span class="ot">=</span> <span class="st">"CO2 Emissions"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PM_exposure"</span> <span class="ot">=</span> <span class="st">"PM2.5 Exposure"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>               <span class="st">"wind_generation"</span> <span class="ot">=</span> <span class="st">"Wind Generation"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>               <span class="st">"solar_generation"</span> <span class="ot">=</span> <span class="st">"Solar Generation"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>               <span class="st">"geo_generation"</span> <span class="ot">=</span> <span class="st">"Geo Biomass"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">"hydro_generation"</span> <span class="ot">=</span> <span class="st">"Hydro Generation"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">"nuclear_generation"</span> <span class="ot">=</span> <span class="st">"Nuclear Generation"</span>))) <span class="sc">+</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="co"># Apply log scale for x</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"TWh generations for energy sources / CO2 emissions in tons"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>), </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of variables by development status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : For this histogram plot, we’ve used our per capita dataframe, <code>all_df</code>, which has been multiplied by 100 to make low per capita values more visible, <code>all100_df</code>. This adjustment also allows us to apply log scaling for better visualization. The analysis focuses on data from 1990 to 2021 (<code>all100_1990</code>). This timeframe was chosen because it corresponds to a period when renewable energy generation started to gain more prominence globally. These choices aid in highlighting trends between developed and non-developed countries.</em></p>
<p>We observe variations in the data between developed and non-developed countries. Developed countries generally exhibit higher values for both CO2 emissions and energy generation. In contrast, the values for PM2.5 appear to be relatively similar for developed and non-developed countries.</p>
</section>
<section id="violion-plot" class="level3">
<h3 class="anchored" data-anchor-id="violion-plot">3.1.2 Violion plot</h3>
<p>To visually emphasize the transition towards higher values in developed countries, especially in terms of CO2 emissions and energy generation, we have created the following violin plot. This plot is designed to provide a clearer visual representation of this shift.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Facet grid for violon plot</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt and ad development status</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>longdev_df <span class="ot">&lt;-</span> <span class="fu">melt</span>(alldev100_1990[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)], <span class="at">variable.name =</span> <span class="st">'EnergySource'</span>, <span class="at">value.name =</span> <span class="st">'value'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DevelopmentStatus =</span> <span class="st">'Developed'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>longnondev_df <span class="ot">&lt;-</span> <span class="fu">melt</span>(allnondev100_1990[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>)], <span class="at">variable.name =</span> <span class="st">'EnergySource'</span>, <span class="at">value.name =</span> <span class="st">'value'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DevelopmentStatus =</span> <span class="st">'Non-Developed'</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set column names to be displayed in the violon plot </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CO2_emissions"</span> <span class="ot">=</span> <span class="st">"CO2 Emissions"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">"PM_exposure"</span> <span class="ot">=</span> <span class="st">"PM2.5 Exposure"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">"wind_generation"</span> <span class="ot">=</span> <span class="st">"Wind Generation"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"solar_generation"</span> <span class="ot">=</span> <span class="st">"Solar Generation"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"geo_generation"</span> <span class="ot">=</span> <span class="st">"Geo Generation"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">"hydro_generation"</span> <span class="ot">=</span> <span class="st">"Hydro Generation"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">"nuclear_generation"</span> <span class="ot">=</span> <span class="st">"Nuclear Generation"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns in the melted data frames</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>longdev_df<span class="sc">$</span>EnergySource <span class="ot">&lt;-</span> <span class="fu">factor</span>(longdev_df<span class="sc">$</span>EnergySource, <span class="at">levels =</span> <span class="fu">names</span>(col_names), <span class="at">labels =</span> col_names)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>longnondev_df<span class="sc">$</span>EnergySource <span class="ot">&lt;-</span> <span class="fu">factor</span>(longnondev_df<span class="sc">$</span>EnergySource, <span class="at">levels =</span> <span class="fu">names</span>(col_names), <span class="at">labels =</span> col_names)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the datasets</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>vcombined_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(longdev_df, longnondev_df)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to remove extreme values applying IQR</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>vcombined_df <span class="ot">&lt;-</span> vcombined_df <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EnergySource) <span class="sc">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_bound =</span> <span class="fu">quantile</span>(value, <span class="fl">0.25</span>) <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(value),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_bound =</span> <span class="fu">quantile</span>(value, <span class="fl">0.75</span>) <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(value)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">&gt;</span> lower_bound <span class="sc">&amp;</span> value <span class="sc">&lt;</span> upper_bound) <span class="sc">%&gt;%</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lower_bound, <span class="sc">-</span>upper_bound)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a violin plot with a facet grid</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> vcombined_df <span class="sc">%&gt;%</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EnergySource =</span> <span class="fu">fct_reorder</span>(EnergySource, value)) <span class="sc">%&gt;%</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>EnergySource, <span class="at">y=</span>value, <span class="at">fill=</span>DevelopmentStatus)) <span class="sc">+</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.8</span>), <span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">name=</span><span class="st">"Development Status"</span>) <span class="sc">+</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> EnergySource, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>), </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"plain"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">22</span>),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Count"</span>, <span class="at">y =</span> <span class="st">"TWh generations / CO2 emissions in tons"</span>) <span class="sc">+</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> <span class="co"># Set the y-axis to not go below 0</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of variables by development status"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : Just as for our histogram, we used the dataframe <code>all100_1990</code> as a basis to have per capita values multiply by 100 from 1990. From that database, we separated developed and undeveloped countries into two distinct groups to compare them.</em></p>
<p>The violin plots in the graph illustrate the distribution of energy generation sources and CO2 emissions between developed and non-developed countries. Just as the previous histogram, we can see that developed countries exhibit higher values for solar, nuclear, wind, and geothermal energy generation, indicating more energy generation from develop than developing countries. Additionnaly, non developed country tend to have more values around 0 especially for solar, geo and wind energy. However, hydro generation distributions are similar for both developed and non-developed countries, reflecting its accessibility as an energy source regardless of development status. We can also notice that CO2 emissions per capita are higher in developed countries. However, while developed countries also exhibit greater renewable energy generation per capita, it cannot be conclusively determined from this visualization alone whether an increase in renewable energy generation leads to a change in CO2 emissions per capita.</p>
</section>
<section id="correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrix">3.1.3 Correlation matrix</h3>
<p>The following correlation matrix for all countries provides a clearer visualization of the relationships among renewable energy generation, CO2 emissions, and PM2.5 exposure levels:</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Correlation matrix</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non-numeric columns and rows with NA values</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>alldf_numeric <span class="ot">&lt;-</span> developed_df[, <span class="fu">sapply</span>(all_df, is.numeric)] <span class="co"># selects only columns that are numeric</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>alldf_numeric <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(alldf_numeric[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">9</span>)]) <span class="co"># removes row with NAs and columns 1, 9</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the correlation matrix for all country</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>allcor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(alldf_numeric)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the correlation matrix</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(allcor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"lower"</span>, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"original"</span>, </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>, </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.cex =</span> <span class="fl">0.6</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.pos =</span> <span class="st">"lt"</span>, <span class="co"># Place text labels on the left and top</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>, <span class="co"># Rotation of text labels</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#6D9EC1"</span>, <span class="st">"white"</span>, <span class="st">"#E46726"</span>))(<span class="dv">200</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">cl.pos =</span> <span class="st">"r"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.6</span>, <span class="co"># Make the correlation numbers smaller</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Correlation matrix for all countries"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : Correlation Matrix with data for all countries.</em></p>
<p>The correlation matrix displays the relationship between energy sources, CO2 emissions, and PM exposure. CO2 emissions share a positive correlation with PM exposure, signaling that areas with higher emissions tend to face increased particulate matter exposure. In contrast, energy sources such as wind, solar and nuclear generation have a slighter negative correlation with CO2 emissions, suggesting that their impact on reducing emissions might be present but limited. As for hydro and geothermal generation, they demonstrate almost no correlation with CO2 emissions, suggesting their impact on emissions is minimal or masked by other factors in this analysis.</p>
<p>Overall, while there is an apparent association between CO2 emissions and PM exposure, the link between renewable energy generation and CO2 emissions is less pronounced in this analysis. This could indicate that factors such as the overall energy policy, efficiency measures, and the balance between industrial output and energy consumption may also play significant roles in determining CO2 emissions beyond the scope of renewable energy generation alone.</p>
</section>
</section>
<section id="eda-specifc-to-renewable-energy-observations" class="level2">
<h2 class="anchored" data-anchor-id="eda-specifc-to-renewable-energy-observations">3.2 EDA specifc to renewable energy observations</h2>
<section id="the-growth-of-renewables" class="level3">
<h3 class="anchored" data-anchor-id="the-growth-of-renewables">3.2.1 The Growth of Renewables</h3>
<p>Our dataset commences in the 1960s, capturing a period marked by substantial transformations and growth in the adoption of renewable energy sources. The trends, shown graphically below, underscore a global shift toward sustainable and diversified energy sources, propelled by environmental consciousness, policy incentives, and technological advancements.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Area plot</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate annual total energy production by source for each year</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>raw_df_annual <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"source"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"energy"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, source) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_energy =</span> <span class="fu">sum</span>(energy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an area plot</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(raw_df_annual, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_energy, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>() <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Energy Production (TWh)"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Energy Source"</span>) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"wind_generation"</span> <span class="ot">=</span> <span class="st">"#a6cee3"</span>, <span class="st">"solar_generation"</span> <span class="ot">=</span> <span class="st">"#FDBA74"</span>, <span class="st">"geo_generation"</span> <span class="ot">=</span> <span class="st">"#b2df8a"</span>, <span class="st">"hydro_generation"</span> <span class="ot">=</span> <span class="st">"#1f78b4"</span>, <span class="st">"nuclear_generation"</span> <span class="ot">=</span> <span class="st">"#B39EB5"</span>),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"wind_generation"</span> <span class="ot">=</span> <span class="st">"Wind"</span>, <span class="st">"solar_generation"</span> <span class="ot">=</span> <span class="st">"Solar"</span>, <span class="st">"geo_generation"</span> <span class="ot">=</span> <span class="st">"Geothermal"</span>, <span class="st">"hydro_generation"</span> <span class="ot">=</span> <span class="st">"Hydro"</span>, <span class="st">"nuclear_generation"</span> <span class="ot">=</span> <span class="st">"Nuclear"</span>)) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Annual growth of total energy production by source"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The utilization of dams and reservoirs for hydroelectric energy generation as the primary source of renewable energy generation is clear from the early years of our data.</li>
<li>Although nuclear power began gaining traction in the 1970s, it witnessed a substantial surge in development in the mid-1980s, as numerous countries constructed reactors for high-density electricity production. Despite its potential, concerns about safety and waste management have tempered its growth.</li>
<li>Solar energy, driven by remarkable progress in photovoltaic technology, has exhibited exponential growth since approximately 2010, finding widespread application in residential and commercial settings.</li>
<li>Likewise, wind power, propelled by advancements in turbine technology, has undergone substantial expansion since the early 2000s, particularly through the establishment of onshore and offshore wind farms.</li>
<li>Geothermal energy, constrained by region-specific limitations, has experienced gradual adoption over the past six decades.</li>
</ul>
</section>
<section id="countries-driving-transition" class="level3">
<h3 class="anchored" data-anchor-id="countries-driving-transition">3.2.2 Countries Driving Transition</h3>
<p>The traditional global leaders in renewable energy production of the United States, Canada, and France, have played a pivotal role in advancing cleaner and sustainable energy sources on a global scale. These nations have made significant strides, particularly in harnessing hydroelectric and nuclear energy resources.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">### TOTAL Renewable Energy Bar Chart </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative total energy production by country</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>raw_df_cumulative <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">wind_total =</span> <span class="fu">sum</span>(wind_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_total =</span> <span class="fu">sum</span>(solar_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">geo_total =</span> <span class="fu">sum</span>(geo_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_total =</span> <span class="fu">sum</span>(hydro_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">nuclear_total =</span> <span class="fu">sum</span>(nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_energy =</span> <span class="fu">sum</span>(wind_total, solar_total, geo_total, hydro_total, nuclear_total)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(total_energy) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the levels of the country factor</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>raw_df_cumulative<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">reorder</span>(raw_df_cumulative<span class="sc">$</span>country, raw_df_cumulative<span class="sc">$</span>total_energy)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for stacking</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>raw_df_cumulative_long <span class="ot">&lt;-</span> raw_df_cumulative <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(wind_total, solar_total, geo_total, hydro_total, nuclear_total),</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"source"</span>,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"cumulative_total"</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the stacked bar chart</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(raw_df_cumulative_long, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> cumulative_total, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Countries with historically the largest total renewable energy production"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative Energy Production (TWh)"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Energy Source"</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 countries with the highest historical cumulative total renewable energy generation.</em></p>
<p>More recently, China has emerged as a key player in the renewable energy landscape, embarking on an ambitious journey to assert its dominance in this sector. Through substantial investments in solar and hydro power projects, China seeks to enhance its energy security and diversify its overall energy portfolio. This evolving landscape suggests a commitment among these major players to transition towards more sustainable and environmentally friendly energy solutions.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Line plot for renewable energy per country</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total energy production for each country</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>raw_df_total_energy <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_energy =</span> <span class="fu">sum</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation)) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual total energy production</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>top_10_countries <span class="ot">&lt;-</span> raw_df_total_energy <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_energy =</span> <span class="fu">sum</span>(total_energy)) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_energy)) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### -10 for the 10 lowest</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> raw_df_total_energy <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_energy, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual total renewable energy production over time by top 10 countries"</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Energy Production (TWh)"</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>plotly_plot1 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot1, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-0443198898169651ba6f" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-0443198898169651ba6f">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[25.515000000000001,27.905999999999999,29.189,30.550000000000001,32.692,40.3156915,43.832395249999998,51.397570187499994,58.640800374999998,66.464151799999996,73.154177575000006,83.777337724999995,94.596845462499999,104.07794407499999,118.35601939999999,130.71250826250002,132.63862287499998,143.31047447500001,154.45945494999998,171.08767888749998,184.82312558859223,185.75693242386734,190.13869731472494,203.04078379409384,209.92316233851133,212.80406249999999,223.22361256250002,230.03136073794519,240.49093703322444,248.14832364877748,262.01784048895831,274.91750962822204,289.5244573941518,302.24441301216012,305.35503288095867,318.30563898399998,291.21230699999995,310.2593469647577,330.97446300000001,344.98396254031098,361.04775018418133,377.64221898428849,405.09110751999538,404.49423730183406,428.05893712624152,451.93190251398613,479.32610559111652,472.19786143298847,453.9942063963797,448.12303921455913,446.04190123739494,481.68411819497072,482.76282979944045,510.96377331862993,531.56695830467334,536.97469033072161,522.28552511800808,606.20308560417618],"text":"Brazil","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Brazil","legendgroup":"Brazil","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[118.21599999999999,131.172,134.077,137.11799999999999,151.167,159.17400000000001,166.72800000000001,188.85000000000002,209.90799999999999,225.363,215.03999999999999,230.81199999999998,247.55799999999999,267.58800000000002,280.73700000000002,290.48000000000002,307.98000000000002,298.27100000000002,316.64699999999999,340.66999999999996,365.84399999999999,383.76799999999997,395.77999999999997,392.78800000000001,373.24458654970755,372.09924242424245,395.60085847953212,399.72281244061253,420.37616113811379,440.73384396639659,438.42465277736289,454.31058954791797,438.87152494258595,410.92191581722466,427.09919415796236,438.25122534266012,417.7038627044717,434.74848029478284,420.64102711486817,438.92004481658688,464.09550825093038,461.60204414673052,472.47784891015431,484.64285812865495,473.84514393407756,460.69009576820838,489.63591944710265,497.57576499734182,518.1893692610314,513.76842844231794,523.14261267410961,532.48087412014888,541.41471627857527,533.73504985645934,529.52693183413078,533.64853594896329,524.56465000587878,537.13949250141582],"text":"Canada","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[22.097000000000001,22.4859072,19.383488400000001,22.870395000000009,23.2593022,24.037116600000001,29.0752326,32.951046400000003,36.826860200000013,41.674942000000001,43.610639200000008,44.19400000000001,46.134116599999999,43.226151400000013,48.555947800000013,58.221175600000009,65.513185600000014,74.413857199999995,86.416947600000015,86.814693599999998,92.387557000000015,94.548643600000005,100.02428020000001,109.1680188,118.40898420000001,126.81199280202021,124.7640425090909,130.93339053131311,153.78328581212122,183.03380738383837,207.05016161616163,203.94393939393939,213.3289797979798,215.83955555555553,214.53973737373741,242.29589898989897,298.20619191919189,316.52837373737378,330.61896969696971,407.89477777777773,457.45706060606062,501.56881818181819,562.850292929293,733.47200000000009,734.44769783319998,861.12607000000003,879.5870000000001,1097.8899163999999,1204.8840731000003,1422.4523099999999,1565.0358899999999,1735.9691769999999,1915.1639092105263,2130.3122250000001,2363.2632249999997,2551.1345679999999,2856.2260000000001,3087.9664353711987],"text":"China","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"China","legendgroup":"China","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[47.778092199999996,53.993469200000007,48.058657399999994,54.433612200000006,57.609089600000004,63.762728400000007,59.57754760000001,64.9376623,63.997348199999998,72.517343600000004,79.771821900000006,65.675528200000016,95.638558000000003,100.23022070000002,107.8631498,132.24877309999999,179.01331809999999,181.02119780000001,215.2627148,258.5464096,287.66815434099999,318.30079962799999,337.76860070700002,353.81625283599999,352.409447602,369.86027152600002,391.04448960399998,409.53697760400001,435.06108517999996,440.9385825,452.68575420000002,465.81708049999997,461.93653519999998,452.7595857,469.65249193,484.56422325,498.81516050000005,500.96610344999999,504.12576730000001,512.18144798399999,507.85350075999997,512.52890604999993,505.63800000000003,513.27300000000002,479.39400000000001,506.71699999999998,507.14614,509.07097300000004,521.41616499999998,528.93834800000002,527.86570806582677,500.3632412131613,489.47356526953314,524.65009705019065,510.34764132799455,477.20292791371259,499.40124383139346,407.28362552607729],"text":"France","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"France","legendgroup":"France","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[16.329209200000001,17.798997800000002,17.877311800000001,18.664990800000012,18.650477800000001,24.947698361299999,20.672216426000002,23.74664314,28.388566638999997,33.173381800000001,42.321833581000007,44.657518232000001,60.083744320999998,63.552700377999997,71.891004391999999,76.624396779999998,87.251911051000008,95.962806004000001,98.315255555000007,124.43911920799999,157.685679338,150.657551356,163.51581929399998,178.54527260399999,181.68999569299999,171.34200000000001,164.86199999999999,179.274,174.726,174.214,179.20999999999998,184.61199999999999,194.554,187.82399999999998,199.17699999999999,207.40600000000001,210.30500000000001,210.94200000000001,211.72984839,225.02223617999999,226.46519999999998,239.91039999999998,229.96440000000001,243.14459999999997,231.00280000000001,245.97070000000002,232.40002699999999,242.86739999999998,249.23900000000003,259.04599999999999,279.92231099999998,273.76336709999998,292.00840110000001,298.94080200000002,316.24023599999998,315.46339700000004,303.16700000000003,288.69999999999999],"text":"Germany","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Germany","legendgroup":"Germany","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[19.166937799999999,20.015462599999999,22.397519200000001,25.849070600000001,29.4243652,31.744550200000003,34.356415600000012,33.326695400000006,36.460049999999995,35.001647999999996,41.811943400000011,44.154225400000001,47.128481600000008,58.437726200000014,56.515287200000003,57.889720599999997,61.548983800000002,52.016338000000005,51.119199800000004,57.721783400000007,56.3208336,57.589201399999993,54.283490200000003,60.691620200000003,67.391430600000007,72.859826766639387,79.540630721321321,76.672320691891898,77.306251149549567,85.728983885285288,84.596773946055166,79.09941305470926,82.258547672727275,97.38143018383839,98.115464834889465,96.033936135899538,95.076738436036038,92.13547858880699,92.771010180726194,130.44997495631995,125.19131822959324,145.18059231506851,159.58967749999999,154.14294999999998,151.14220750000001,165.6906075,205.8445475,198.38368500000001,221.20965999999999,236.72193250000004,241.51515846879437,246.10482963786887,272.31980696269812,302.67040909909656,348.32264548782052,360.28314635930002,377.41116410002002,427.06706075857318],"text":"India","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"India","legendgroup":"India","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[76.095000000000013,79.933999999999997,69.179000000000002,74.494,76.432000000000002,80.223704000000012,92.445611000000014,94.828591000000017,76.738997999999981,102.686547,108.909507,118.036553,105.160774,130.18764400000003,152.23573200000001,171.97444000000002,176.55052700000002,193.906767,209.594233,218.000023,255.15147899999999,259.98907800000001,278.18446599999999,280.174486,294.60217499999999,292.80740100000003,314.76137900000003,308.94174700000002,351.86274659595961,336.21247959595962,380.01687159595957,388.97827019191919,424.13182644185002,431.37580095707074,417.76812763636366,420.15371771917808,418.8555032191781,412.90530000000001,342.21209399999998,398.29764012328769,395.82577153140483,418.75620506223834,380.76884781978731,353.7405031771184,371.91530889647277,410.59174876024372,276.41743065094158,129.32069752935831,135.15312358339989,133.89839665872614,158.5376750275868,169.44155563896916,195.82336239173941,228.90421593652667,245.92778440914392,238.1694433714527,277.21864293729504,278.70914662535142],"text":"Japan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Japan","legendgroup":"Japan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[0,259.04313100000002,269.55246420000003,287.23006420000002,295.7374092,296.06444480000005,285.23562379999998,288.14279999999997,292.28300000000002,293.53499999999997,273.80700000000002,275.84620000000001,263.392,265.98899999999998,262.274,282.42399999999998,294.87199999999996,310.95119999999997,303.98249999999996,306.38639999999998,320.84079999999994,322.51509999999996,330.2319,337.59359999999998,328.358,338.28270000000003,337.43950000000001,336.56029999999998,341.50051150684931,354.15600000000006,354.96240599999999,364.428517,382.28882550000003,389.506528,396.58488599999998,405.200219,432.16748899999999,442.64089427595627,428.80625427595623],"text":"Russian Federation","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Russian Federation","legendgroup":"Russian Federation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[46.441000000000003,45.533999999999999,49.335999999999999,48.762,41.891000000000012,41.674999999999997,52.262,55.43399999999999,62.381999999999998,59.676000000000002,69.927000000000007,71.179000000000002,73.768000000000001,81.810000000000002,82.466000000000008,86.076999999999998,98.353000000000009,95.113,105.99799999999999,120.68499999999999,131.357,132.87,141.20400000000001,141.35300000000001,139.547,142.643,141.88299999999998,139.94900000000001,138.26600000000002,134.55799999999999,140.49099999999999,128.27699999999999,141.96100000000001,151.41499999999999,147.935,140.45600000000002,155.43099999999998,139.25400000000002,126.14600000000002,146.31200000000001,153.52532000000002,137.942251,144.409559,145.510277,131.670107,140.590349,145.198564,162.35441800000001,149.14489800000001,150.61663200000001,158.84545299999999,152.34415999999999,160.67331100000001,159.617391,164.97264000000001,161.22223600000001,168.45651799999999,169.88744655892702],"text":"Sweden","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Sweden","legendgroup":"Sweden","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[216.15547479634381,219.80934449229576,249.35250387396124,256.88855962036513,286.91646575665419,292.68031871683644,328.9484603319014,354.32700316118559,386.07551172932381,447.66337947886768,507.55341264750689,513.54882774706368,513.48104777420826,601.95789574821879,580.27518021943911,572.99041163976074,580.91210488945239,639.59040553227783,677.62173490048485,708.07184007454725,727.47678940528124,771.52458593804613,777.32178897589915,825.49724693748169,883.18044634237106,960.15061097820308,996.14214349497695,970.91005899636116,992.09882413020114,1003.8271712356783,1087.039921350193,1126.4240921158853,1087.3778544144029,1100.4474269326145,1154.7178641482981,1139.0839596397691,1093.7410222197673,1162.1374934934588,1157.1433853337708,1179.5146376371408,1180.9087007186754,1214.9596267276966,1201.67509076444,1230.801178991132,1262.300926231565,1280.3982127101799,1349.7939790561995,1312.1696549463963,1363.3338272934634,1391.6492410419987,1401.3952615204676,1479.2907397554493,1561.8511576289209,1590.7001611589581,1621.142889601276,1661.9416990005316,1691.6634217437534,1790.2396772248806],"text":"US","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"US","legendgroup":"US","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":37.525944375259456,"l":46.293067662930682},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual total renewable energy production over time by top 10 countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.1500000000001,2024.8499999999999],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-154.39832176855995,3242.3647571397587],"tickmode":"array","ticktext":["0","1000","2000","3000"],"tickvals":[0,1000,2000,3000],"categoryorder":"array","categoryarray":["0","1000","2000","3000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Energy Production (TWh)","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f4758e3f8":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f4758e3f8","visdat":{"111f4758e3f8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="per-capita-leaders" class="level3">
<h3 class="anchored" data-anchor-id="per-capita-leaders">3.2.3 Per Capita Leaders</h3>
<p>The countries with the largest per capita renewable energy production are predominantly wealthier Nordic nations that boast expansive and diverse natural landscapes conducive to renewable energy generation. Hydroelectric power from cascading rivers, and favorable geographic conditions for geothermal energy. Their commitment to sustainable development, coupled with robust economic structures, has positioned them at the forefront of the global transition towards renewable energy.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Per Capita Renewable Energy Bar Chart </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average total energy production by country</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>all_df_average <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">wind_avg =</span> <span class="fu">sum</span>(wind_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_avg =</span> <span class="fu">sum</span>(solar_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">geo_avg =</span> <span class="fu">sum</span>(geo_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_avg =</span> <span class="fu">sum</span>(hydro_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">nuclear_avg =</span> <span class="fu">sum</span>(nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_energy_avg =</span> <span class="fu">sum</span>(wind_avg, solar_avg, geo_avg, hydro_avg, nuclear_avg)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(total_energy_avg) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="do">### 10 for 10 best or -10 for ten lowest</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the levels of the country factor</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>all_df_average<span class="sc">$</span>country <span class="ot">&lt;-</span> <span class="fu">reorder</span>(all_df_average<span class="sc">$</span>country, all_df_average<span class="sc">$</span>total_energy_avg)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for stacking</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>all_df_average_long <span class="ot">&lt;-</span> all_df_average <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(wind_avg, solar_avg, geo_avg, hydro_avg, nuclear_avg),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"source"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"average_total"</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the stacked bar chart</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df_average_long, <span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> average_total, <span class="at">fill =</span> source)) <span class="sc">+</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Countries with historically the largest renewable energy production per capita"</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Energy Production (TWh)"</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Energy Source"</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 countries with the highest historical cumulative renewable energy generation per capita.</em></p>
<p>In particular, Iceland has leveraged its abundant geothermal resources, resulting from its location on the Mid-Atlantic Ridge, by harnessing geothermal and hydro energy for both electricity generation and heating, making it a global leader in per capita renewable energy production.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Line plot for renewable energy per country per capita</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total energy production for each country</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>all_df_total_energy <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_energy =</span> <span class="fu">sum</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual per capita energy production</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>top_10_countries <span class="ot">&lt;-</span> all_df_total_energy <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_energy =</span> <span class="fu">sum</span>(total_energy)) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_energy)) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### slice_head for the 20 highest and slice_tail for the 20 lowest</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> all_df_total_energy <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_energy, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual per capita renewable energy production over time by top 10 countries"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total Energy Production (TWh)"</span>,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>plotly_plot2 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot2, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-99a96c8cb316159e0941" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-99a96c8cb316159e0941">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[2.2119716034724226e-06,2.3669549004338391e-06,2.3990788664982695e-06,2.452327944954576e-06,2.2467244228137004e-06,2.8511389851409238e-06,2.2425358796941316e-06,2.2915084049324774e-06,2.5321524917563206e-06,2.9888256908308655e-06,3.1396628245538969e-06,2.7183308494783905e-06,3.2927304606107211e-06,3.2980420652168883e-06,3.7217139053636539e-06,3.855905469986951e-06,4.0756350818039004e-06,4.7922912120877752e-06,4.7492042526826009e-06,4.2526859732867924e-06,4.2127261363183576e-06,4.6140679369684434e-06,4.8152585631030416e-06,4.6520294935130756e-06,4.8974687347372596e-06,4.4994947240343885e-06,4.7488042543957793e-06,4.8958434277251168e-06,5.2987131926685548e-06,5.4214032400719158e-06,5.2597304836232887e-06,5.1917433870451559e-06,4.3475032688206274e-06,4.8659053402816399e-06,4.8762428498483551e-06,6.0899799513800924e-06,5.9560440008107263e-06,5.8738209128451754e-06,5.5071843527358958e-06,5.8486498567617636e-06,5.8047499913909856e-06,5.6633330444420382e-06,6.1539300174235652e-06,6.2167183475984659e-06,5.8917702777477257e-06,5.6063460219570235e-06],"text":"Austria","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Austria","legendgroup":"Austria","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[6.0075210895416202e-06,6.5428970470869908e-06,6.5685381148344112e-06,6.6100077130736594e-06,7.1888434468327951e-06,7.4645469893078223e-06,7.5916472574122476e-06,8.4996878496950926e-06,9.3326552188384224e-06,9.8808885613620389e-06,9.2916840853336438e-06,9.8428098004043354e-06,1.0434107652149597e-05,1.116662075599827e-05,1.1599962382565345e-05,1.184874961794839e-05,1.2408583993941962e-05,1.4660783412145538e-05,1.3683600955321948e-05,1.3437484671964094e-05,1.4109745421637658e-05,1.4089002606320694e-05,1.4655032934491417e-05,1.5197371314110874e-05,1.4962118611646806e-05,1.5343034271072168e-05,1.4675058116953388e-05,1.3626912895416805e-05,1.4048721299420108e-05,1.4281922748543381e-05,1.3465239105699496e-05,1.3863118147590853e-05,1.3292904023307913e-05,1.3741735879135443e-05,1.4258750766674952e-05,1.4333484558500024e-05,1.4770403007142197e-05,1.4497901116215605e-05,1.4652661141050738e-05,1.4746287426352773e-05,1.4814919139626715e-05,1.4399941731049615e-05,1.4082702396547423e-05,1.404073473799555e-05,1.3722540056007193e-05,1.3797607106779149e-05],"text":"Canada","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[2.0495365094916516e-06,2.2661220132704253e-06,2.5249542591366194e-06,2.2671477727158423e-06,1.8914059683688895e-06,2.0676525520861779e-06,2.3158111275429885e-06,2.2371908052250371e-06,2.2673841238071049e-06,2.7082037940410491e-06,2.5913714085483229e-06,2.0064520418333133e-06,3.1281346280163795e-06,2.7438118261625912e-06,3.6865869369911442e-06,3.5967632683300855e-06,5.8787322882593077e-06,6.6270386966953598e-06,6.4435550379182251e-06,7.0654652596215611e-06,7.5208367406367298e-06,7.7984245115819305e-06,7.7700747683731827e-06,7.4065024832297729e-06,7.5885729444632616e-06,7.2663579970467778e-06,7.9857053777018142e-06,8.9766779767839244e-06,8.5505061103782545e-06,8.8593024354310276e-06,8.5430799258597904e-06,8.1001605969159693e-06,8.0177001251099659e-06,9.2475681748802453e-06,8.7901213969896106e-06,9.5209571680380263e-06,9.0523847153469452e-06,9.1276223507336437e-06,9.8131982463462655e-06,9.756506056171971e-06,9.7951370444212961e-06,9.9597449018905728e-06,1.0097508043855356e-05,1.0652022056795652e-05,1.1089235604222111e-05,1.1717550995680935e-05],"text":"Finland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Finland","legendgroup":"Finland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[9.6946875698266553e-07,1.0838353325722416e-06,9.5479488899076834e-07,1.0711689154539169e-06,1.1235825049373758e-06,1.2327466050845606e-06,1.141655536120935e-06,1.2336677014852876e-06,1.2062758384624171e-06,1.357614980740519e-06,1.4850736915383804e-06,1.2169671484329243e-06,1.7638334839364427e-06,1.8395525820806539e-06,1.9699745596520412e-06,2.4022265313550595e-06,3.2329771152590154e-06,6.156254264937247e-06,6.1006080952552914e-06,6.3719902963407466e-06,6.6779486043966602e-06,6.9590038108278204e-06,7.3606717305940634e-06,7.4322691965297416e-06,7.6025854272744637e-06,7.7952494415966191e-06,7.702800843035638e-06,7.5218242201433094e-06,7.762284010490474e-06,7.9539267074103229e-06,8.1283427037826671e-06,8.1041187894105614e-06,8.0974992406472718e-06,8.166639278531488e-06,7.7610273422699403e-06,7.7528724728245637e-06,7.8999709388866792e-06,7.9765021952942603e-06,7.9320723469097262e-06,7.4989877902768287e-06,7.3145255234618883e-06,7.81213523969039e-06,7.573271706456979e-06,7.0622333879140477e-06,7.3712761101254905e-06,5.9951375393435095e-06],"text":"France","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"France","legendgroup":"France","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[3.3320158513880271e-06,3.1901620903001388e-06,3.3433794043803465e-06,3.4091360279520278e-06,4.2386204387099197e-06,6.9702843893992117e-06,7.528617453832624e-06,8.2446625895943577e-06,1.038635625032378e-05,1.0519778447927337e-05,1.0202574559934645e-05,1.0758432733450196e-05,1.143299113161012e-05,1.1735350299950312e-05,1.2690677121403381e-05,1.3578939063198551e-05,1.3900600203679191e-05,1.76567950668695e-05,1.7681125717811164e-05,1.7410350592168728e-05,1.7148085509140864e-05,1.7368111178784712e-05,1.7879495686794961e-05,1.7922118930460378e-05,1.85643291907817e-05,1.8985290157521313e-05,2.0559947368032815e-05,2.287284322397253e-05,2.5876011695105294e-05,2.7286680535552355e-05,2.8155645546166592e-05,2.921888689009923e-05,2.9313955172990905e-05,2.9493470733527499e-05,5.3942177365256698e-05,5.4708947333466371e-05,5.5946059981962169e-05,5.5346793326531985e-05,5.6813162078503091e-05,5.5288995784628505e-05,5.6017611499708795e-05,5.6211546803280776e-05,5.4043741091015999e-05,5.2185990803982969e-05,5.2645997530333951e-05,5.2646170359037367e-05],"text":"Iceland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Iceland","legendgroup":"Iceland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[4.3246004413331307e-06,4.5459221196606749e-06,4.5353902573326971e-06,4.7553879407590704e-06,4.6751587564916328e-06,4.9608353079304084e-06,5.4854489309498774e-06,5.6894547332897136e-06,5.5177355890993823e-06,5.7108663185593397e-06,6.0879631621852164e-06,5.6434132683533503e-06,5.3516463647080507e-06,5.6583233440000124e-06,6.5361911411266646e-06,6.8540991088107663e-06,6.9181035854351942e-06,7.6292682668433482e-06,7.6191178458971069e-06,7.8497944878059601e-06,7.4436479652943893e-06,6.8416568603201139e-06,7.477736424294961e-06,7.9869428923258501e-06,8.3193579251479293e-06,7.808871194469198e-06,6.9600898690009835e-06,7.5096496216226984e-06,6.9137034471304743e-06,7.3349569331043744e-06,6.532639082032017e-06,7.1914670115759675e-06,6.7158251311329434e-06,7.5831997223413383e-06,7.7576172705171494e-06,7.2973285850444051e-06,7.3469527246601251e-06,7.7296547592436225e-06,7.7863035785871441e-06,7.9078628557810903e-06,7.5455670695279261e-06,7.6157403318063276e-06,7.4236948639777431e-06,7.0229020696465325e-06,7.0940638742146064e-06,7.5418112596826669e-06],"text":"New Zealand","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"New Zealand","legendgroup":"New Zealand","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[1.3282237062630533e-05,1.2987968064050953e-05,1.4083881814931753e-05,1.5774982536291238e-05,1.49104388665769e-05,1.4915256686231847e-05,1.6204039980128304e-05,1.7141350479175715e-05,1.8397914261735309e-05,1.9220085625573051e-05,1.929721985779499e-05,2.0350200389851156e-05,1.7813096293658127e-05,1.9884834222828113e-05,2.1779651257441038e-05,2.046519255339459e-05,2.2644084862753437e-05,2.5866328636641794e-05,2.8017926135483187e-05,2.8612229760745853e-05,2.5891585862273835e-05,2.7271830143749966e-05,2.7709473419587382e-05,2.5808620690847905e-05,2.7947661764220091e-05,2.377676580842008e-05,2.4976862345655332e-05,2.6172840397665422e-05,2.7286502448613409e-05,3.1643585891412698e-05,2.6751652893569004e-05,2.8580378078423435e-05,2.3228382938778999e-05,2.3824116761870335e-05,2.4612827391720073e-05,2.8615086400058338e-05,2.5676078716865406e-05,2.6852534594505369e-05,2.6998267550423454e-05,2.7735079383607165e-05,2.7576244729928253e-05,2.6941915873669689e-05,2.4527886293974302e-05,2.8108757824880681e-05,2.8744648060765636e-05,2.6199698590589633e-05],"text":"Norway","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Norway","legendgroup":"Norway","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[6.0048982053318057e-06,5.8318626880283893e-06,6.2705176240106835e-06,6.162830832555954e-06,5.2573571122349315e-06,5.1816525113576725e-06,6.4534260997385397e-06,6.8249141253093322e-06,7.6671101108217086e-06,7.3132756246817535e-06,8.5355554153178116e-06,8.6568382564167687e-06,8.9399069749404351e-06,9.8856892413467587e-06,9.943236281900505e-06,1.035758124240196e-05,1.1820559406083984e-05,1.6754955764181051e-05,1.6430895032641138e-05,1.6666170103758281e-05,1.6464758699720044e-05,1.6145352822030566e-05,1.5858809727889729e-05,1.5324212239394267e-05,1.5916163009623156e-05,1.4509334805866939e-05,1.6047931836787939e-05,1.7107156794269196e-05,1.6700960072360478e-05,1.5831185121823908e-05,1.7472088453635131e-05,1.5602762500394961e-05,1.4081577954749763e-05,1.6268582384382731e-05,1.5366207111639879e-05,1.7055156988264143e-05,1.5535313553766992e-05,1.5533717336127583e-05,1.6210066121818689e-05,1.5352499751841287e-05,1.5975157635474839e-05,1.5686882949095713e-05,1.6049659851304912e-05,1.5571849052711165e-05,1.617315425558317e-05,1.619990486824776e-05],"text":"Sweden","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Sweden","legendgroup":"Sweden","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[4.1146413745340195e-06,4.6499828827364374e-06,4.9818563917096489e-06,4.8643258400115763e-06,4.6900776303710967e-06,5.0055400875959843e-06,4.898241043267946e-06,4.483985129427519e-06,5.2156012028512143e-06,5.5062549072327029e-06,6.3100034202963665e-06,5.3611077121093463e-06,6.8464719811933246e-06,6.3761853487044509e-06,6.6371078258092767e-06,7.5904156528586219e-06,8.0092045827606045e-06,8.9395274169595139e-06,7.9707345904673395e-06,7.9976584731897736e-06,8.1341212907876963e-06,8.2143897724616916e-06,8.5705306689530444e-06,9.1254089898376887e-06,8.5891718975326633e-06,7.6836115329132306e-06,8.456324025794943e-06,8.4143364335959491e-06,9.1729280255030522e-06,8.9009205688125035e-06,9.5216430807862211e-06,8.6681084050665793e-06,8.5864439569929931e-06,8.3246772992549197e-06,7.6995149630059537e-06,8.2712962872012649e-06,8.2629321544309243e-06,8.3544850001377039e-06,7.7694598545747628e-06,7.0575115077080731e-06,6.8949041622011749e-06,7.3876862073298728e-06,7.8248137663307352e-06,7.5439022029264847e-06,6.9039054378627549e-06,6.7137222253616571e-06],"text":"Switzerland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Switzerland","legendgroup":"Switzerland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"y":[1.1124659670532303e-06,1.118281158385713e-06,1.2548437128807582e-06,1.2799246640377725e-06,1.4156340667991643e-06,1.427346813085639e-06,1.5840647032033042e-06,1.6881074587471205e-06,1.821892943335695e-06,2.0933130990248847e-06,2.3500780775722281e-06,2.3553504150575073e-06,2.3314719362792616e-06,2.7043956050417536e-06,2.5783705326228661e-06,2.5216873655617151e-06,2.531582477968206e-06,3.3762806675588927e-06,3.5782514569071712e-06,3.8464028193644142e-06,3.9376164356017921e-06,3.7850178118791225e-06,3.8169538361189487e-06,3.8150056293778587e-06,4.0823497297943993e-06,4.1813258354524798e-06,3.9880797280627416e-06,3.9892386078600076e-06,4.1381804191094399e-06,4.0369798216664972e-06,3.8381058814626564e-06,4.0404579354544189e-06,3.9886650922219714e-06,4.0283240969128256e-06,4.3320460209384454e-06,4.1805130272265008e-06,4.3135292536559961e-06,4.3709453399363722e-06,4.3692699912891405e-06,4.578830296555789e-06,4.8038906709817088e-06,4.8669346668348214e-06,4.937541868442554e-06,5.0132246961020517e-06,5.0948875230808737e-06,5.3714566884502096e-06],"text":"US","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"US","legendgroup":"US","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":38.854296388542977,"l":53.466168534661698},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual per capita renewable energy production over time by top 10 countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.1500000000001,2024.8499999999999],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.8381234704848481e-06,5.9606080437978704e-05],"tickmode":"array","ticktext":["0e+00","2e-05","4e-05"],"tickvals":[0,2.0000000000000002e-05,4.0000000000000003e-05],"categoryorder":"array","categoryarray":["0e+00","2e-05","4e-05"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total Energy Production (TWh)","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f48a72d07":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f48a72d07","visdat":{"111f48a72d07":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="eda-specifc-to-co2-emissions" class="level2">
<h2 class="anchored" data-anchor-id="eda-specifc-to-co2-emissions">3.3 EDA Specifc to CO2 emissions</h2>
<section id="cumulative-co2-emissions-ranking" class="level3">
<h3 class="anchored" data-anchor-id="cumulative-co2-emissions-ranking">3.3.1 Cumulative CO2 emissions ranking</h3>
<p>For the CO2 emissions analysis, we’ll concentrate on the top 10 countries with the highest cumulative CO2 emissions from both developed and developing countries, since they shape the overall emissions trend and are accountable for the major part of CO2 emissions. This focus will provide us with a more defined perspective on the prevailing trends and enable an analysis of disparities between developed and developing nations.</p>
<p>The following bar plot present the developed countries with the highest CO2 emissions per capita, highlighting Qatar’s significant lead, followed by countries like the United Arab Emirates and Luxembourg, with the remaining nations showing comparatively lower emissions. Assessing emissions per capita is useful because it enables meaningful comparisons to be made between countries regardless of their population size.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### BAR CHART PER CAPITA FOR DEVELOPED COUNTRY</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cumulative CO2 emissions per capita for each country</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>dev_df_cumulative_co2 <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">co2_cumulative =</span> <span class="fu">sum</span>(CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(co2_cumulative)) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, co2_cumulative)  <span class="co"># Top 10 countries with the highest total CO2 emissions</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart for cumulative CO2 emissions per capita</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dev_df_cumulative_co2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, co2_cumulative), <span class="at">y =</span> co2_cumulative, <span class="at">fill =</span> co2_cumulative)) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Cumulative CO2</span><span class="sc">\n</span><span class="st">Emissions per capita"</span>) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Developed countries with the highest cumulative CO2 emissions per capita"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative CO2 Emissions per capita"</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 developed countries with the highest historical cumulative CO2 emissions per capita.</em></p>
<p>As for the CO2 emissions per capita of developing countries, the bar plot highlights that Kuwait stands out with the highest figures, followed by Trinidad &amp; Tobago and Turkmenistan. This visual representation confirms that while developing nations are generally associated with lower emissions, there are exceptions where emissions are quite substantial.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">##### BAR CHART PER CAPITA FOR NON-DEVELOPED COUNTRY</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cumulative CO2 emissions per capita for each country</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>nondev_df_cumulative_co2 <span class="ot">&lt;-</span> nondev_df <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">co2_cumulative =</span> <span class="fu">sum</span>(CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(co2_cumulative)) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, co2_cumulative)  <span class="co"># Top 10 countries with the highest total CO2 emissions</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart for cumulative CO2 emissions per capita</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(nondev_df_cumulative_co2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, co2_cumulative), <span class="at">y =</span> co2_cumulative, <span class="at">fill =</span> co2_cumulative)) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Cumulative CO2</span><span class="sc">\n</span><span class="st">Emissions per capita"</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Developing countries with the highest cumulative CO2 emissions per capita"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative CO2 Emissions per capita"</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 developing countries with the highest historical cumulative CO2 emissions per capita.</em></p>
<p>Now shifting our analysis to total emissions, this plot illustrates which developed countries are the largest total producers of CO2. The graph showcases the US and China as the predominant emitters, with their total output far exceeding that of other nations on the list. The substantial difference in emissions between these two countries and the rest highlights the significant role they play in global CO2 production.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">### BAR CHART TOTAL FOR DEVELOPED COUNTRIES</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total CO2 emissions for each country by multiplying per capita emissions with population</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dev_df_total_co2 <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_CO2_emissions =</span> CO2_emissions <span class="sc">*</span> Population) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">co2_total =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(co2_total)) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, co2_total) <span class="co"># top_n with 10 to get the top 10</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart for total CO2 emissions with gradient fill</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dev_df_total_co2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, co2_total), <span class="at">y =</span> co2_total, <span class="at">fill =</span> co2_total)) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Total cumulative </span><span class="sc">\n</span><span class="st">CO2 Emissions"</span>) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Developed countries with the highest cumulative total CO2 Emissions"</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total CO2 Emissions (tons)"</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(    </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 developed countries with the highest historical cumulative total CO2 emissions.</em></p>
<p>Regarding the total cumulative CO2 emissions of developing nations, the following bar chart underlines the dominant emissions from India and Russia, suggesting the intensity of their economic activities and energy use patterns. The visible gap in emissions across these countries highlight the varied stages of industrial growth and energy infrastructure among these countries.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### BAR CHART TOTAL FOR NON-DEVELOPED COUNTRIES</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total CO2 emissions for each country by multiplying per capita emissions with population</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>nondev_df_total_co2 <span class="ot">&lt;-</span> nondev_df <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_CO2_emissions =</span> CO2_emissions <span class="sc">*</span> Population) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">co2_total =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(co2_total)) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, co2_total) <span class="co"># top_n with 10 to get the top 10</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart for total CO2 emissions with gradient fill</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(nondev_df_total_co2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, co2_total), <span class="at">y =</span> co2_total, <span class="at">fill =</span> co2_total)) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Total cumulative </span><span class="sc">\n</span><span class="st">CO2 Emissions"</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Developing countries with the highest cumulative total CO2 emissions"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total CO2 Emissions (tons)"</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(    </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 developing countries with the highest historical cumulative total CO2 emissions.</em></p>
</section>
<section id="are-we-reducing-co2-emissions" class="level3">
<h3 class="anchored" data-anchor-id="are-we-reducing-co2-emissions">3.3.2 Are We Reducing CO2 Emissions?</h3>
<p>Its all well and good expanding our renewable energy potential, but what is the outlook on the global carbon emissions? A discernible divergence is apparent between developed and undeveloped nations. Developed countries are witnessing a downward trend in per capita CO2 emissions, potentially indicative of their concerted efforts towards sustainable and eco-friendly practices. Conversely, non-developed nations are experiencing an upward trajectory in per capita CO2 emissions. This surge could be attributed to industrialization, increased consumption, and or limited access to clean energy technologies.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">### CO2 Emissions Per Capita Change Line Plot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the yearly mean for developed nations</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>developed_mean <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_CO2 =</span> <span class="fu">mean</span>(CO2_emissions))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the yearly mean for undeveloped nations</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>nondev_mean <span class="ot">&lt;-</span> nondev_df <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_CO2 =</span> <span class="fu">mean</span>(CO2_emissions))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the mean data frames</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>mean_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(developed_mean, <span class="at">category =</span> <span class="st">"Developed"</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(nondev_mean, <span class="at">category =</span> <span class="st">"Undeveloped"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for Developed and Undeveloped Nations with Yearly Mean</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(developed_df, nondev_df), <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> CO2_emissions, <span class="at">color =</span> <span class="fu">factor</span>(<span class="st">"developed"</span>))) <span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> mean_df, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mean_CO2, <span class="at">color =</span> category), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CO2 emissions per capita : developed vs undeveloped"</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Per Capita CO2 Emissions (Tons)"</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Category"</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Developed"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Undeveloped"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : The 1991 surge in CO2 emissions in undeveloped countries, shown in the chart, corresponds to the Kuwaiti oil fires (https://visibleearth.nasa.gov/images/78594/kuwait-oil-fires), not a data error.</em></p>
<p>Delving deeper into the individual country trajectories within the top 10 cumulative CO2 emitters per capita, we observe a trend that aligns with the earlier discussion. Developed nations, in general, demonstrate a pattern of either constancy or decline in emissions per capita. This is particularly noticeable for countries such as the United Arab Emirates and Luxembourg, which exhibit a marked decrease. Similarly, Qatar shows a pronounced reduction in emissions per capita since the year 2000. This trend could be explained by the maturation of industrialization in developed countries, where growth in heavy industries has plateaued and advancements in technology have led to more efficient processes. The advancements in technology and a transition to less carbon-intensive operations might be one of the reasons of this consistent and sometimes declining pattern in CO2 emissions per capita for developed countries.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT PER CAPITA FOR DEVELOPED COUNTRY</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the year 2022 from the dataset as we don't have that year for CO2 emissions</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>dev_df_filtered <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(year <span class="sc">==</span> <span class="dv">2022</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total CO2 emissions for each country</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>dev_df_total_CO2 <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual total CO2 emissions</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>top_10_countries_CO2 <span class="ot">&lt;-</span> dev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_CO2_emissions)) <span class="sc">%&gt;%</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### slice_head for the 10 highest and slice_tail for the 10 lowest</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>filtered_data_CO2 <span class="ot">&lt;-</span> dev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_CO2)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for CO2 emissions</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>plot_CO2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_CO2, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_CO2_emissions, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual CO2 emissions per capita change of top 10 developed countries"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"CO2 Emissions per capita"</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>plotly_CO2_devcapita <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_CO2, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-a9dd783e05445e67d8d1" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-a9dd783e05445e67d8d1">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[10.638961999999999,10.370281,10.935978,11.182664000000001,11.584588,11.709353999999999,11.746307,11.829464,12.641423,12.556311000000001,12.653267,12.400204,13.2178135,14.058458999999999,14.108995,14.995692,15.414099999999999,15.786133,16.520443,16.315939,16.184761000000002,16.293507000000002,16.383763999999999,16.494705,16.941783999999998,17.125450000000001,17.396968999999999,17.959467,18.269805999999999,18.384481000000001,18.554117000000002,18.563549999999999,18.746100999999999,19.213035999999999,18.062716999999999,17.869067999999999,17.215779999999999,16.785682999999999,16.867716000000001,16.997408,16.850452000000001,16.665199999999999,16.419682000000002,15.579326,15.091471],"text":"Australia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Australia","legendgroup":"Australia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[11.191008999999999,11.102418,11.2830715,12.393719000000001,12.874312,13.032044000000001,12.555921,13.467393,14.251578,13.842366,12.477480999999999,13.268231999999999,12.895415,13.821168999999999,14.243389000000001,13.718175,12.553710000000001,10.056759,10.746732,12.078101999999999,12.352205,12.228683999999999,12.089392999999999,12.393784,12.474543000000001,12.789887,12.209258,12.780277999999999,12.196930999999999,12.345596,12.228224000000001,12.250462000000001,12.328288000000001,12.316072999999999,9.5858519999999992,9.2787900000000008,9.2465119999999992,8.6686379999999996,8.9846170000000001,8.8011890000000008,8.7071330000000007,8.7236560000000001,8.6383749999999999,7.8161415999999999,8.2438079999999996],"text":"Belgium","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Belgium","legendgroup":"Belgium","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[12.794933,12.918037,13.800293999999999,14.627745000000001,14.601127,15.91714,16.094498000000002,17.135622000000001,16.943949,17.079151,17.150003000000002,17.019034999999999,17.195239999999998,17.340654000000001,18.236699999999999,18.066893,17.312763,16.993023000000001,16.990096999999999,16.567774,16.060949999999998,16.359687999999998,16.196068,16.518518,16.776931999999999,17.149193,17.462914999999999,17.570170000000001,17.896967,18.469010000000001,18.023472000000002,18.007908,18.384416999999999,18.162386000000001,16.520855000000001,16.379142999999999,16.330660000000002,16.095068000000001,16.072324999999999,15.521198999999999,15.635478000000001,15.778724,15.582993500000001,14.116709999999999,14.3004675],"text":"Canada","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[12.594359000000001,12.487135,12.433398,12.986556,13.768746999999999,15.763947999999999,16.500439,16.591867000000001,16.576086,16.665179999999999,17.322286999999999,17.883620000000001,18.314599999999999,18.386303000000002,17.825769999999999,17.982115,17.760725000000001,17.528578,16.723831000000001,15.940949,14.449589,14.131631,13.579827,12.854307,12.764832,13.112753,12.728246,12.220309,11.373626,12.42399,12.417070000000001,12.106351999999999,12.4393215,12.498537000000001,10.973865,10.587004,10.148929000000001,9.9103429999999992,9.9769699999999997,10.131072,10.231177000000001,10.094166,9.5866140000000009,8.7222779999999993,9.2418089999999999],"text":"Czech Republic","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Czech Republic","legendgroup":"Czech Republic","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[12.626699,12.417617999999999,12.13148,12.683064,13.485030999999999,13.104639000000001,13.211287499999999,13.243054000000001,13.801617999999999,13.517167000000001,12.767827,13.920135,13.456804999999999,13.822353,14.347402000000001,14.142085,13.497203000000001,13.112342,12.783045,13.254084000000001,12.704247000000001,12.038421,11.862709000000001,11.615575,11.570214,11.792006499999999,11.430681999999999,11.319463000000001,10.978242,11.027998999999999,11.239027,11.04386,11.071457000000001,10.910218,9.9346329999999998,9.9783849999999994,10.176316999999999,9.6783140000000003,9.6932535000000009,9.7209509999999995,9.5082900000000006,9.1005850000000006,8.5046990000000005,7.6729719999999997,8.0897400000000008],"text":"Germany","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Germany","legendgroup":"Germany","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[36.971375000000002,34.851802999999997,33.824330000000003,36.370620000000002,38.967619999999997,40.475006,38.581237999999999,38.988323000000001,40.593910000000001,41.047718000000003,33.544598000000001,33.32911,30.574384999999999,32.904060000000001,33.510323,30.443203,26.025718999999999,24.367577000000001,26.120215999999999,31.01004,32.202354,31.185120000000001,31.143453999999998,28.709126000000001,22.450572999999999,22.269044999999998,20.443843999999999,18.121646999999999,18.930565000000001,19.993763000000001,20.866737000000001,22.388960000000001,23.173029,25.839106000000001,21.425722,20.481639999999999,19.013020999999998,17.674219999999998,16.41591,15.580966999999999,15.531364999999999,15.736727,15.729075,12.843432999999999,13.067672999999999],"text":"Luxembourg","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Luxembourg","legendgroup":"Luxembourg","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[96.939890000000005,85.792000000000002,80.976299999999995,76.048630000000003,68.561959999999999,64.069820000000007,68.695279999999997,72.634550000000004,76.078590000000005,58.437443000000002,56.124859999999998,49.168723999999997,43.646030000000003,43.176679999999998,55.08231,47.148192999999999,43.542355000000001,28.866887999999999,33.478413000000003,25.835598000000001,38.073749999999997,56.822400000000002,63.129930000000002,60.525759999999998,60.756793999999999,59.833255999999999,66.817245,54.598145000000002,50.146774000000001,52.654040000000002,60.711844999999997,57.070810000000002,55.175044999999997,54.902434999999997,44.14631,49.233469999999997,41.262188000000002,41.341140000000003,37.823303000000003,33.733629999999998,36.942753000000003,34.420223,36.032620000000001,33.640438000000003,35.587307000000003],"text":"Qatar","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Qatar","legendgroup":"Qatar","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[0.84682029999999997,1.2385519,4.7361693000000002,5.1884537000000002,6.0345297000000002,7.4107285000000003,9.3418454999999998,10.451962999999999,13.409046,13.189249999999999,10.542634,12.195311,13.485719,12.488327,14.253738999999999,16.638342000000002,16.417020000000001,13.745808,13.249580999999999,13.02718,17.325603000000001,18.295715000000001,19.087381000000001,17.865171,13.892901999999999,13.306084,10.823722,10.122812,10.756266,13.75404,13.428822,14.396499,14.103892999999999,16.676027000000001,16.505583000000001,18.390554000000002,17.297338,19.076452,20.728325000000002,19.237926000000002,18.823626999999998,17.881912,18.323464999999999,18.367947000000001,18.70299],"text":"Saudi Arabia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Saudi Arabia","legendgroup":"Saudi Arabia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[0.1264844,0.14051696999999999,4.7854640000000002,5.8152466,80.970534999999998,51.107402999999998,61.438716999999997,59.725582000000003,69.312749999999994,63.625824000000001,57.130108,64.503174000000001,54.820953000000003,55.57788,40.22889,36.312911999999997,33.418747000000003,28.565639999999998,30.240364,27.21022,28.218336000000001,27.292363999999999,29.490345000000001,31.173777000000001,28.764277,28.286950000000001,26.619617000000002,27.620266000000001,25.033723999999999,34.129930000000002,29.121314999999999,23.034103000000002,27.696362000000001,27.997019999999999,22.505728000000001,23.239815,23.51022,22.828695,24.265930000000001,23.608854000000001,23.6159,22.999389999999998,22.633891999999999,21.436235,21.792141000000001],"text":"United Arab Emirates","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"United Arab Emirates","legendgroup":"United Arab Emirates","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[17.920338000000001,18.617542,19.121759999999998,19.622215000000001,20.394010000000002,21.662866999999999,21.514513000000001,22.281479999999998,23.08108,22.0809,21.19624,22.261742000000002,22.696183999999999,22.679130000000001,22.718443000000001,21.549343,20.767942000000001,20.844942,20.951412000000001,20.648254000000001,20.134295000000002,20.281036,20.381665999999999,20.457944999999999,20.431329999999999,20.880137999999999,20.895596000000001,20.799135,20.812017000000001,21.304466000000001,20.709630000000001,20.643988,20.665068000000002,20.813086999999999,17.671368000000001,16.881198999999999,17.161404000000001,17.168596000000001,16.563306999999998,16.050101999999999,15.800776000000001,16.187923000000001,15.730885000000001,14.037217,14.858668],"text":"US","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"US","legendgroup":"US","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":38.854296388542977,"l":41.776670817766721},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual CO2 emissions per capita change of top 10 developed countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.59999999999999998,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.2,2023.8],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.7141858800000014,101.78056028],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"CO2 Emissions per capita","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f3cf19f89":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f3cf19f89","visdat":{"111f3cf19f89":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><em>Note : For CO2 emissions, we have observations until 2021.</em></p>
<p>In contrast to developed countries, the trend in CO2 emissions per capita among non-developed countries typically shows an increasing pattern, as illustrated by the following plot. Kuwait is an exception, with a notable decrease leading up to 1980. Following this period, Kuwait’s emissions per capita align with the general trend of other non-developed countries, exhibiting a slight increase. The trajectories of the remaining countries underscore a consistent slight climb in emissions over the years. The persistent upward trend in emissions among these nations is indicative of their developmental trajectories, which often involve scaling up industrial activities, energy production, and urbanization. These processes, central to economic growth, tend to increase the demand for energy, frequently met through carbon-intensive sources that contribute to higher per capita CO2 emissions.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT PER CAPITA FOR NON-DEVELOPED COUNTRY</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the year 2022 from the dataset as we don't have that year for CO2 emissions</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>nondev_df_filtered <span class="ot">&lt;-</span> nondev_df <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(year <span class="sc">==</span> <span class="dv">2022</span>), <span class="sc">!</span>(country <span class="sc">==</span> <span class="st">"Kuwait"</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">1991</span>)) </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># purposely remove 1991 for kuwait because of the oil fire anomaly</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total CO2 emissions for each country</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>nondev_df_total_CO2 <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual total CO2 emissions</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>top_10_countries_CO2 <span class="ot">&lt;-</span> nondev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_CO2_emissions)) <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### slice_head for the 10 highest and slice_tail for the 10 lowest</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>filtered_data_CO2 <span class="ot">&lt;-</span> nondev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_CO2)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for CO2 emissions</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plot_CO2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_CO2, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_CO2_emissions, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual CO2 emissions per capita change of top 10 developing countries"</span>,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"CO2 Emissions per capita"</span>,</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>plotly_CO2_nondevcapita <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_CO2, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-ae8db4f4ad34e5ac1232" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-ae8db4f4ad34e5ac1232">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[5.6117270000000001,5.8631130000000002,6.5840774,7.0468697999999996,7.7890699999999997,7.1273745999999996,7.4276679999999997,7.5951459999999997,7.8502700000000001,8.0738959999999995,8.2295940000000005,8.1960139999999999,8.4826040000000003,9.065042,8.7947500000000005,8.6019369999999995,8.9199269999999995,9.8364729999999998,9.8225739999999995,8.7478484999999999,7.0533549999999998,6.6177535000000001,6.7846913000000004,6.5982099999999999,6.8357964000000004,6.9633269999999996,6.7142809999999997,6.4572215000000002,5.6820883999999996,5.6144790000000002,6.095955,5.7876649999999996,6.3821700000000003,6.3040523999999998,7.0494313000000002,6.4552170000000002,5.743188,6.1401830000000004,6.6026607000000004,6.277177,6.6230726000000004,6.128069,5.9915700000000003,5.2967690000000003,6.1808094999999996],"text":"Bulgaria","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Bulgaria","legendgroup":"Bulgaria","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[16.655901,15.836016000000001,16.528654,15.858128000000001,14.387712499999999,12.836729,11.006807999999999,10.7751465,10.08164,9.7447510000000008,9.617146,8.1095710000000008,9.6791309999999999,9.3117210000000004,10.429081999999999,11.534492999999999,12.067078,14.054852500000001,14.262047000000001,14.496516,16.918968,16.891382,16.861940000000001,17.515402000000002,17.899391000000001,15.866766999999999,14.668894,14.413247999999999],"text":"Kazakhstan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Kazakhstan","legendgroup":"Kazakhstan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[68.873763999999994,62.112785000000002,40.918776999999999,33.98657,36.080179999999999,31.168082999999999,31.577969,30.21677,24.957989999999999,18.741603999999999,15.340214,15.790735,13.791626000000001,15.778983999999999,12.481749000000001,16.477996999999998,15.981654000000001,15.416930000000001,16.186140000000002,22.572144999999999,18.294262,29.709675000000001,33.651417000000002,32.980117999999997,29.30377,31.036915,28.336818999999998,28.668216999999999,27.590617999999999,28.862819999999999,28.319792,28.372001999999998,29.305486999999999,27.438756999999999,29.978207000000001,22.959776000000002,20.104140000000001,23.651517999999999,25.171659999999999,23.258196000000002,22.478843999999999,23.498792999999999,22.882670000000001,24.972116],"text":"Kuwait","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Kuwait","legendgroup":"Kuwait","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[0.043191830000000001,0.048247030000000003,0.21793816999999999,0.25293346999999999,0.35877436000000001,0.3496303,3.037331,2.9495930000000001,2.8965857000000002,3.0926428000000001,9.2111520000000002,10.097142,9.8142790000000009,8.534243,8.0099070000000001,5.9381779999999997,5.5898523000000004,6.47797,5.8264880000000003,6.2190450000000004,6.1180186000000001,5.9905569999999999,6.3829912999999996,7.0554566000000003,7.2348860000000004,6.7348410000000003,6.7901379999999998,7.1503290000000002,8.8889130000000005,9.1865079999999999,8.4672400000000003,10.498506000000001,13.171367,11.176190999999999,17.182583000000001,17.737805999999999,17.096340000000001,16.436056000000001,16.073395000000001,14.931376,15.108304,15.769014,15.68125,15.958551999999999,17.916525],"text":"Oman","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Oman","legendgroup":"Oman","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[4.1134389999999996,4.3748263999999999,4.7563662999999998,5.1282519999999998,5.6579249999999996,6.0223746,6.238766,6.4887180000000004,7.0178037,7.2150660000000002,7.6536289999999996,8.1340280000000007,8.2143630000000005,8.860061,8.8970149999999997,8.8676639999999995,8.8917590000000004,9.3411159999999995,9.3733149999999998,7.595993,6.2127767,5.7677350000000001,5.3815860000000004,5.3260073999999999,5.5732416999999996,5.7514640000000004,5.2922944999999997,4.710877,4.0091248000000004,4.2275910000000003,4.5028343,4.5423007000000002,4.7876120000000002,4.7962899999999999,4.537744,4.4812402999999996,3.9333878000000002,3.9234908000000002,3.9182136000000001,3.8898997,4.0633299999999997,4.1065500000000004,3.9453893,3.8132834,4.1041270000000001],"text":"Romania","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Romania","legendgroup":"Romania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[16.638233,16.321435999999999,17.126805999999998,16.203733,13.216354000000001,12.531723,11.065991,10.897812,10.700507999999999,10.015000000000001,9.9174919999999993,10.134327000000001,10.066303,10.358041,10.340811,10.59212,10.680394,11.713346,11.798259,11.341706,11.3086,11.265164,11.196788,11.372465999999999,11.674742,11.612026999999999,11.154038999999999,12.098649999999999],"text":"Russian Federation","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Russian Federation","legendgroup":"Russian Federation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[6.6784140000000001,6.4798565000000004,6.5534369999999997,6.5534540000000003,6.5951639999999996,6.688847,7.3118930000000004,7.2390020000000002,7.1096944999999998,7.0400834000000003,7.1767187000000003,7.2848509999999997,7.3432255,7.2244429999999999,7.6198572999999996,7.7450890000000001,8.5032569999999996,9.1633980000000008,8.8110320000000009,7.8472749999999998,7.9691763,7.215516,7.5330266999999997,7.8250336999999996,8.220288,8.1414310000000008,8.5020749999999996,8.2224339999999998,8.0813000000000006,8.0758170000000007,7.8630585999999996,7.475733,8.4008850000000006,9.2475395000000002,8.8814890000000002,8.6358809999999995,8.5130409999999994,8.6217769999999998,7.9858437000000002,8.0991569999999999,7.7572520000000003,7.5905123000000003,8.0383510000000005,7.4118633000000003,7.3398269999999997],"text":"South Africa","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"South Africa","legendgroup":"South Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[5.5910434999999996,4.2982316000000003,4.8490586000000002,4.1715616999999998,3.9862983000000001,9.0912500000000005,8.095307,8.1294789999999999,9.1468450000000008,9.6530539999999991,9.1205750000000005,14.901914,14.938817999999999,13.963417,15.020097,15.001455,15.089117999999999,12.721059,12.820309,13.407681,13.295515,14.860113,13.455546,13.081448999999999,12.5859375,15.811916999999999,15.596969,14.933400000000001,16.927889,18.158843999999998,19.848977999999999,21.242062000000001,23.826841000000002,23.932006999999999,32.872818000000002,32.282276000000003,31.805834000000001,32.324345000000001,31.201415999999998,27.150461,27.267313000000001,26.801152999999999,26.821891999999998,23.552616,23.677477],"text":"Trinidad & Tobago","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Trinidad & Tobago","legendgroup":"Trinidad & Tobago","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[8.3978110000000008,8.5985359999999993,8.7316299999999991,8.7255319999999994,8.8352880000000003,9.026097,9.3245459999999998,9.5488579999999992,9.6911109999999994,9.7998460000000005,10.037490999999999,10.155289,10.236516999999999,10.328856999999999,10.15911,10.300896,9.8728099999999994,10.549310999999999,10.393140000000001,8.4155979999999992,8.5401199999999999,8.1485310000000002,6.8250089999999997,8.0916440000000005,8.0285150000000005,7.1155724999999999,7.0024579999999998,7.2267609999999998,8.3547840000000004,8.1998440000000006,6.9391400000000001,5.9214349999999998,7.8937840000000001,9.6366204999999994,11.599520999999999,12.665514999999999,12.699191000000001,12.674222,12.780063,12.518164000000001,12.291216,12.077686999999999,12.139735999999999,11.524936,13.088737500000001],"text":"Turkmenistan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Turkmenistan","legendgroup":"Turkmenistan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[6.2684449999999998,5.6913166000000004,6.3597380000000001,6.1439332999999996,6.2602034,6.5597805999999999,5.3393050000000004,5.1828909999999997,5.3467900000000004,5.8656053999999997,4.8382329999999998,4.2218003,4.5577439999999996,4.7722559999999996,5.1693740000000004,5.959104,5.8696159999999997,6.1567544999999999,5.6326530000000004,6.1680739999999998,5.6882710000000003,5.1002140000000002,5.8551745000000004,5.9854994000000001,6.0105149999999998,5.4198919999999999,5.7941339999999997,7.0968859999999996,7.2000226999999999,6.2171099999999999,6.9121221999999998,7.60914,7.4260060000000001,5.7676629999999998,6.0470176000000002,5.9626821999999997,6.6501409999999996,5.8278340000000002,5.4325112999999998,4.9569954999999997,4.5932335999999996,3.4424011999999999,3.0758011000000001,2.6839678,2.8279076000000001],"text":"Venezuela","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Venezuela","legendgroup":"Venezuela","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":38.854296388542977,"l":35.931921959319226},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual CO2 emissions per capita change of top 10 developing countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.59999999999999998,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.2,2023.8],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.3983367785,72.315292608499988],"tickmode":"array","ticktext":["0","20","40","60"],"tickvals":[0,20,40.000000000000007,60],"categoryorder":"array","categoryarray":["0","20","40","60"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"CO2 Emissions per capita","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f396efb31":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f396efb31","visdat":{"111f396efb31":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>However the contrasting trajectories from the per capita emissions, don’t tell the whole story. Below we can see that in taking the total emissions, both developed and undeveloped countries for much of the last 60 years have followed similar increasing trends.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">### CO2 Emissions Total Change Line Plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting CO2 emissions per capita in total values</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>developed_df1 <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> Population <span class="sc">*</span> CO2_emissions)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>nondev_df1 <span class="ot">&lt;-</span> nondev_df <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> Population <span class="sc">*</span> CO2_emissions)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total for the product in developed nations</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>developed_total <span class="ot">&lt;-</span> developed_df1 <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_product =</span> <span class="fu">sum</span>(product))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total for the product in undeveloped nations</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>nondev_total <span class="ot">&lt;-</span> nondev_df1 <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_product =</span> <span class="fu">sum</span>(product))</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the total data frames</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>total_product_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(developed_total, <span class="at">category =</span> <span class="st">"Developed"</span>),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(nondev_total, <span class="at">category =</span> <span class="st">"Undeveloped"</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for Developed and Undeveloped Nations with Yearly Total (Product)</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>l2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(developed_df, nondev_df), <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> product, <span class="at">color =</span> <span class="fu">factor</span>(<span class="st">"developed"</span>))) <span class="sc">+</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> total_product_df, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_product, <span class="at">color =</span> category), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total CO2 Emissions : developed vs undeveloped"</span>,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total CO2 Emissions"</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Category"</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Developed"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Undeveloped"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Taking a closer look once again into the country-level details for a more precise understanding, the first graph reveals that the uptrend in total CO2 emissions among developed countries has been predominantly driven by the United States and particularly China since 1980. This increase in emissions from the United States and China reflects their expansive industrial activities, driven by significant economic growth and a large consumer base compare to other developed countries. Therefore, the emissions from China and the US are substantially higher than those of other developed countries, making it difficult to discern the individual impact and trends of other nations within the overall upward trajectory of developed countries’ emissions.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">### TOTAL LINE PLOT FOR DEVELOPED WITH CHINA AND US</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the year 2022 from the dataset as we don't have that year for CO2 emissions</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>dev_df_filtered <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(year <span class="sc">==</span> <span class="dv">2022</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total CO2 emissions for each country</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>dev_df_total_CO2 <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(CO2_emissions<span class="sc">*</span>Population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual total CO2 emissions</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>top_10_countries_CO2 <span class="ot">&lt;-</span> dev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_CO2_emissions)) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### slice_head for the 10 highest and slice_tail for the 10 lowest</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>filtered_data_CO2 <span class="ot">&lt;-</span> dev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_CO2)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for CO2 emissions</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>plot_CO2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_CO2, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_CO2_emissions, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual total CO2 emissions change of top 10 developed countries"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total CO2 Emissions"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>plotly_CO2_devtotal1 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_CO2, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-aacf859881c3d62110d3" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-aacf859881c3d62110d3">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[251778691.574,258980805.77599999,281691601.12799996,303437942.28000003,307032498.55599999,339417093.36000001,353467880.09993601,380727183.38898605,381099522.40737301,389540746.55431896,396907235.67982507,399093103.09527999,407971564.58731997,415537611.95476204,441356297.4648,442921932.512631,429701306.07514501,455272772.98118103,463435155.03775698,458780516.18681198,450307600.74899995,464145027.20563197,464580388.30795199,479047973.77743399,491602879.08985198,507791343.25407404,522245027.91841996,529831515.98941004,544090812.29956198,566735054.22730005,559104358.61174405,564729417.50473201,581757006.31167603,580118505.20283008,567315058.68544006,568589206.27174592,572927793.56964004,570367926.07058001,573828740.8211,560462533.51491296,571402233.48280799,584839730.47281599,585939722.68200505,536536140.34385997,546656792.28781497],"text":"Canada","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[494300076.99075001,543876637.84200001,456321378.81650001,491784418.62,603584244.79624999,803807993.5115,906858803.92750001,967735825.329,1008621861.6,1029222767.705,1184857405.5855,1228148678.3299999,1342073983.359,1494381481.7819998,1526773677.3485,1492765365.3080001,1471491666.102,2394893495.8349996,2429417510.3249998,2444967923.5545001,2561913617.98,2687320176.8400002,2879102150.6800003,3060325978.4050002,3321275942.7915001,3472576546.5899997,3488258370.7124996,3347245949.1034999,3545206226.1549997,3640271950.1270003,3721127856,4110770038.3200002,4825672824.4799995,5220766755.0225,9443876087.5275002,9690754267.9400005,9863262244.8799992,9902403751.5200005,9768814080.3400002,9666767819.3600006,9911292850.8404999,10249324855.92,10634338571.022999,10849876780.559999,11363481346.4],"text":"China","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"China","legendgroup":"China","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[371903821.80686557,389250033.021272,414150364.76450402,428108798.06232005,453897271.34336203,471390213.92356801,505178832.83011198,526259760.45945603,551572508.82414997,533180235.61949998,493837739.96482003,536215228.11426997,519417907.38636005,541838892.44281495,545360390.46525002,523850972.23321199,470889145.565956,396337091.088449,411037134.89664,404803106.28228903,432491331.53986502,420849919.25446248,402040850.40599203,395906121.69783598,400545132.88198501,416232935.48084003,408456565.94380718,428678724.49598002,427385737.10262001,422473166.502168,428022864.494268,424572847.96934444,430000020.17177498,431732214.42664599,369119557.96464992,371573718.92648,373725355.02530098,341117654.49326879,345810309.30017602,348733129.21137601,352050992.191392,336980489.77044356,331067585.47365659,293455709.299119,321222116.09733123],"text":"France","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"France","legendgroup":"France","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[959170711.69280505,951193400.67919791,933533593.65727997,980328731.29809594,1050614476.970142,1024380313.2316711,1034613470.604075,1042075419.012408,1089453710.325588,1067415979.4223111,1004490326.947158,1090460919.48825,1051781375.8342699,1079412702.4524601,1120910150.2427001,1107163696.32096,1058287437.5841211,1024658969.787698,1006681194.396735,1052812038.7404361,1016516298.2163121,970592853.67975795,962734317.76736701,945953239.07009995,945032529.17291403,965940219.59840143,937713380.24382198,928730188.05628502,901316335.91280603,906628428.01249194,925533030.52297497,910991390.39069998,913773580.6144321,900270385.14468002,797502495.186239,802519825.83585501,820675241.13678491,783774063.505,791809027.97888851,800507376.26421893,785926745.54658008,754491116.08247006,706680630.82843804,638091034.67861199,673034640.03972006],"text":"Germany","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Germany","legendgroup":"Germany","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[191957633.88984001,216607105.28299999,236843166.75209999,251891307.47354999,272390307.05686998,299131293.21740001,313585719.326594,330583434.91617,355765142.29419959,360609736.70540762,343200553.3007744,367970576.69554001,356364792.78720802,373121836.87092602,386953092.21725941,387149247.87144101,375092793.72794747,385678975.81849599,404458317.59182358,439260809.934012,438816035.2644363,439036257.17799598,431319194.97011596,425494244.85575998,449503317.821769,443727432.18958861,449474171.67107844,461686405.80804002,466189429.37147903,470286521.29313201,470395603.67460001,477592447.44105005,494994590.50877696,500043353.48370898,419686855.6257894,399334400.1817835,369197629.58448601,352091428.34968001,364147274.32825279,361214364.90814078,355866799.42106104,352177714.37632,339239737.339921,301964995.49781305,327962332.28502715],"text":"Italy","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Italy","legendgroup":"Italy","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[380578077.46560001,412502000.45740002,481360887.71160007,552030165.54999995,641399620.88670003,753292271.62110007,788396301.1825,844040694.13520002,906158940.94400001,906586661.4740001,862031229.02820003,900359433.0575,926004143.32799995,894610575.25599992,945925238.51999986,938304089.80800009,921161685.90260005,983696294.9920001,1020010517.211,1156178844.3200002,1168740649.6600001,1179317569.5,1172951703.9720001,1228089813.1440001,1240285324.704,1252753506.9000001,1245426142.3050001,1206124094.4000001,1242580743.5410001,1264984817.277,1250807625.7875001,1280801986.2450001,1289869805.0440001,1283978247.0449998,1263312754.4085002,1303887027.2265,1313158487.5150001,1262422197.8139999,1222547933.7260001,1204666882.868,1191263112.3959999,1148439220.1659999,1113412801.2540002,1050680658.978,1076555848.42382],"text":"Japan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Japan","legendgroup":"Japan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[248727887.91764998,253842523.49300003,260829083.53221002,278193908.8872,295968136.46339995,305841459.15960002,313576734.61299998,330268221.67635,336469406.39200002,347269964.40549701,376056223.07646501,399591082.25850004,419496450.79155004,432042680.99759996,442046733.24809098,464016690.49919999,409538655.097857,444375727.91580695,422425569.176112,377274180.21705598,374606276.69637901,365810838.67378205,366803332.72195196,362092875.56450403,364716285.73533398,379770120.40270501,369951492.19686002,341871971.55484498,332175736.65888304,315690962.41761303,310482925.97028399,303301128.01909602,316173303.99686003,320957696.29201198,329510134.778795,321974972.06525999,317911313.90041196,305733364.14228505,308847876.99699599,319649886.42654204,332844223.28849,332264935.89300001,314118101.64192498,299342461.69702601,323771275.46662396],"text":"Poland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Poland","legendgroup":"Poland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[24571924.301784802,29577632.952760197,34642284.167709,36731026.602349199,41978812.676699601,53122659.329758301,57820417.302065603,59411092.357295804,71802805.862595305,74209150.740354002,80188487.318460003,91552302.530804187,104032547.306604,112025972.6630495,132157057.80559319,134359761.2904675,139558535.45177761,206256239.653364,217772351.89086601,243409109.54381248,268303217.91377601,293493588.84317881,324749330.26836395,351566220.83417797,381126275.582937,419808987.04448903,444904295.01195002,378348652.71218002,411386347.44037503,442044955.51037902,458587004.9217,479325197.34387201,488811533.59043998,495046797.05722505,633164810.13823199,635099524.64096606,638769121.40099704,631714405.41564608,634432849.10560501,636767999.12325597,652634744.69349003,668977626.39940405,645615674.11244595,597536854.10364401,615061587.70829999],"text":"South Korea","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"South Korea","legendgroup":"South Korea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[623470829.55879998,619071432.93699992,592782489.51719999,606954916.79100001,628623288.52049994,652730870.71799994,660628348.55265105,648358556.99422503,659904637.162413,617141902.01170599,602806922.44400001,597980667.10527992,603809944.98070192,604237567.61440802,644304267.70196903,578910872.56480801,559938036.41538894,570050265.34967101,581582376.19890141,602335857.37208402,610108004.356547,594580816.35099399,580327937.31586194,574810072.34644008,567025433.97881997,587653483.14820004,563353089.129076,569018645.89337301,562102323.89885998,569444320.86399603,578241067.49976099,560412853.27122903,571597451.58043551,573353778.13081503,469508848.84310997,486647761.5761475,476318698.81123441,437647234.16423202,421760309.53040671,399164824.16591853,387332255.30324852,379886096.78763598,365068265.67675179,326369093.48549443,345460219.31685001],"text":"United Kingdom","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"United Kingdom","legendgroup":"United Kingdom","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[3481975434.414,3659464055.52,3799723173.1199999,3938296283.79,4133396764.7700005,4442014204.0839996,4467725284.0930004,4676793526.0799999,4891088581.7200003,4722088788.6000004,4577815541.5199995,4853838916.9700003,4998584867.9759998,5048034151.0500002,5112899189.3649998,4896549463.1750002,4765536578.9720001,5096567474.0579996,5171206558.4280005,5154279108.2420006,5093594083.3950005,5202369668.5039997,5297582245.0539999,5383017236.0699997,5440413689.7399998,5624983896.3719997,5697330518.5720005,5737524586.29,5807385223.6800003,6011319491.6275263,5901601619.5366507,5937731032.7896843,5995100162.7844448,6094182141.3349257,5506106355.4720087,5298631273.8767376,5424032438.6855879,5466246254.5240841,5312498424.4931574,5185334621.0690098,5137181917.1713285,5290831598.870677,5164920732.6984053,4653499031.9421043,4933546626.4100723],"text":"US","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"US","legendgroup":"US","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":38.854296388542977,"l":53.466168534661698},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual total CO2 emissions change of top 10 developed countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.2,2023.8],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-542373546.80312598,11930426817.50491],"tickmode":"array","ticktext":["0e+00","3e+09","6e+09","9e+09"],"tickvals":[0,3000000000,6000000000,9000000000],"categoryorder":"array","categoryarray":["0e+00","3e+09","6e+09","9e+09"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total CO2 Emissions","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f15a1d18c":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f15a1d18c","visdat":{"111f15a1d18c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>By setting aside the data from the US and China, this graph allows us to identify more specific trends among the remaining developed countries. Initially, there’s an observable increase in CO2 emissions across all these nations until the 1980s. Following the 1980s, a split in trends becomes apparent. Indeed we can observe that Germany, France, Italy, and Poland either stabilize or see a decline in their emissions. On the other hand, other developed countries persist with an upward trajectory in CO2 emissions. This trend is interrupted in 2020, with a steep decline across the board, which can be attributed to the economic disruptions caused by the COVID-19 pandemic, leading to reduced industrial operations and travel. However, as the world began to recover economically post-2020, there’s a significant resurgence in CO2 emissions among all developed countries, suggesting a rebound in industrial activities and transportation.</p>
<p>This individual country-level analysis is important as it highlights that while some nations are managing to reduce their total CO2 emissions, their efforts are offset on a global scale by others that maintain a high increase in CO2 emissions.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">### TOTAL LINE PLOT FOR DEVELOPED WITHOUT CHINA AND US</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the year 2022 from the dataset as we don't have that year for CO2 emissions and china and US to have better visualization</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>dev_df_filtered <span class="ot">&lt;-</span> developed_df <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(year <span class="sc">==</span> <span class="dv">2022</span>), <span class="sc">!</span>(country <span class="sc">==</span> <span class="st">"China"</span>), <span class="sc">!</span>(country <span class="sc">==</span> <span class="st">"US"</span>)) </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total CO2 emissions for each country</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>dev_df_total_CO2 <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(CO2_emissions<span class="sc">*</span>Population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual total CO2 emissions</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>top_10_countries_CO2 <span class="ot">&lt;-</span> dev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_CO2_emissions)) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### slice_head for the 10 highest and slice_tail for the 10 lowest</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>filtered_data_CO2 <span class="ot">&lt;-</span> dev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_CO2)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for CO2 emissions</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>plot_CO2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_CO2, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_CO2_emissions, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual total CO2 emissions change of top 10 developed countries"</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total CO2 Emissions"</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>plotly_CO2_devtotal2 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_CO2, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-783a0b7d51185548e5f5" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-783a0b7d51185548e5f5">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[251778691.574,258980805.77599999,281691601.12799996,303437942.28000003,307032498.55599999,339417093.36000001,353467880.09993601,380727183.38898605,381099522.40737301,389540746.55431896,396907235.67982507,399093103.09527999,407971564.58731997,415537611.95476204,441356297.4648,442921932.512631,429701306.07514501,455272772.98118103,463435155.03775698,458780516.18681198,450307600.74899995,464145027.20563197,464580388.30795199,479047973.77743399,491602879.08985198,507791343.25407404,522245027.91841996,529831515.98941004,544090812.29956198,566735054.22730005,559104358.61174405,564729417.50473201,581757006.31167603,580118505.20283008,567315058.68544006,568589206.27174592,572927793.56964004,570367926.07058001,573828740.8211,560462533.51491296,571402233.48280799,584839730.47281599,585939722.68200505,536536140.34385997,546656792.28781497],"text":"Canada","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[371903821.80686557,389250033.021272,414150364.76450402,428108798.06232005,453897271.34336203,471390213.92356801,505178832.83011198,526259760.45945603,551572508.82414997,533180235.61949998,493837739.96482003,536215228.11426997,519417907.38636005,541838892.44281495,545360390.46525002,523850972.23321199,470889145.565956,396337091.088449,411037134.89664,404803106.28228903,432491331.53986502,420849919.25446248,402040850.40599203,395906121.69783598,400545132.88198501,416232935.48084003,408456565.94380718,428678724.49598002,427385737.10262001,422473166.502168,428022864.494268,424572847.96934444,430000020.17177498,431732214.42664599,369119557.96464992,371573718.92648,373725355.02530098,341117654.49326879,345810309.30017602,348733129.21137601,352050992.191392,336980489.77044356,331067585.47365659,293455709.299119,321222116.09733123],"text":"France","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"France","legendgroup":"France","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[959170711.69280505,951193400.67919791,933533593.65727997,980328731.29809594,1050614476.970142,1024380313.2316711,1034613470.604075,1042075419.012408,1089453710.325588,1067415979.4223111,1004490326.947158,1090460919.48825,1051781375.8342699,1079412702.4524601,1120910150.2427001,1107163696.32096,1058287437.5841211,1024658969.787698,1006681194.396735,1052812038.7404361,1016516298.2163121,970592853.67975795,962734317.76736701,945953239.07009995,945032529.17291403,965940219.59840143,937713380.24382198,928730188.05628502,901316335.91280603,906628428.01249194,925533030.52297497,910991390.39069998,913773580.6144321,900270385.14468002,797502495.186239,802519825.83585501,820675241.13678491,783774063.505,791809027.97888851,800507376.26421893,785926745.54658008,754491116.08247006,706680630.82843804,638091034.67861199,673034640.03972006],"text":"Germany","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Germany","legendgroup":"Germany","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[191957633.88984001,216607105.28299999,236843166.75209999,251891307.47354999,272390307.05686998,299131293.21740001,313585719.326594,330583434.91617,355765142.29419959,360609736.70540762,343200553.3007744,367970576.69554001,356364792.78720802,373121836.87092602,386953092.21725941,387149247.87144101,375092793.72794747,385678975.81849599,404458317.59182358,439260809.934012,438816035.2644363,439036257.17799598,431319194.97011596,425494244.85575998,449503317.821769,443727432.18958861,449474171.67107844,461686405.80804002,466189429.37147903,470286521.29313201,470395603.67460001,477592447.44105005,494994590.50877696,500043353.48370898,419686855.6257894,399334400.1817835,369197629.58448601,352091428.34968001,364147274.32825279,361214364.90814078,355866799.42106104,352177714.37632,339239737.339921,301964995.49781305,327962332.28502715],"text":"Italy","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Italy","legendgroup":"Italy","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[380578077.46560001,412502000.45740002,481360887.71160007,552030165.54999995,641399620.88670003,753292271.62110007,788396301.1825,844040694.13520002,906158940.94400001,906586661.4740001,862031229.02820003,900359433.0575,926004143.32799995,894610575.25599992,945925238.51999986,938304089.80800009,921161685.90260005,983696294.9920001,1020010517.211,1156178844.3200002,1168740649.6600001,1179317569.5,1172951703.9720001,1228089813.1440001,1240285324.704,1252753506.9000001,1245426142.3050001,1206124094.4000001,1242580743.5410001,1264984817.277,1250807625.7875001,1280801986.2450001,1289869805.0440001,1283978247.0449998,1263312754.4085002,1303887027.2265,1313158487.5150001,1262422197.8139999,1222547933.7260001,1204666882.868,1191263112.3959999,1148439220.1659999,1113412801.2540002,1050680658.978,1076555848.42382],"text":"Japan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Japan","legendgroup":"Japan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[75167894.831933394,80844557.868195102,90005525.279916391,93887225.550419003,102176181.06711841,113950689.333318,126186793.9001475,132271273.42240559,144058437.63438478,154727331.651072,164139037.768545,183739580.09928599,192394234.8964985,222116227.62843502,240258765.490448,267743854.74015558,283707454.04981101,305665573.72320753,323480291.33640152,317042384.51181561,330133129.52371198,332780168.99171478,338067216.89172262,351528190.47759598,331596622.95051599,345766079.98561502,368644806.39859599,388356898.43570399,390516465.35901999,396066317.33679801,410697953.41258878,411967704.37460762,437757529.25689328,438856727.786488,484164847.53788531,501568848.87018299,495485178.39746296,484113717.37041503,479519776.84568161,479789746.84774619,465620942.20464259,475268922.6954155,472191482.72866046,391706217.62126279,407205061.19799662],"text":"Mexico","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Mexico","legendgroup":"Mexico","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[248727887.91764998,253842523.49300003,260829083.53221002,278193908.8872,295968136.46339995,305841459.15960002,313576734.61299998,330268221.67635,336469406.39200002,347269964.40549701,376056223.07646501,399591082.25850004,419496450.79155004,432042680.99759996,442046733.24809098,464016690.49919999,409538655.097857,444375727.91580695,422425569.176112,377274180.21705598,374606276.69637901,365810838.67378205,366803332.72195196,362092875.56450403,364716285.73533398,379770120.40270501,369951492.19686002,341871971.55484498,332175736.65888304,315690962.41761303,310482925.97028399,303301128.01909602,316173303.99686003,320957696.29201198,329510134.778795,321974972.06525999,317911313.90041196,305733364.14228505,308847876.99699599,319649886.42654204,332844223.28849,332264935.89300001,314118101.64192498,299342461.69702601,323771275.46662396],"text":"Poland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Poland","legendgroup":"Poland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[4216252.2217165995,6407322.5155003006,25485450.143701803,29079114.214853402,35270878.675337099,45251323.6701435,59756590.752338998,70281716.722379997,95053482.104867995,98701831.510499999,83260915.890895993,101459572.801916,118070423.21746099,115024535.086428,138004729.50547799,169240389.70482001,175304403.55122,202251901.35672,203423824.74788699,208496928.45833999,288545374.22842801,316174654.41525,340642200.60864103,328139028.56728798,262421039.193014,258274816.14352,215807449.779194,207240078.49495998,225985491.52956,296363663.95560002,296588009.24563801,325697971.42408502,326517068.94737101,394584949.07681602,497658925.22593504,566825250.90482199,544563408.99032402,612841779.61892796,678849493.04460001,642859729.45602,643638574.49349391,626191172.71029603,656481413.6493299,661192953.52932906,672379896.88404],"text":"Saudi Arabia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Saudi Arabia","legendgroup":"Saudi Arabia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[24571924.301784802,29577632.952760197,34642284.167709,36731026.602349199,41978812.676699601,53122659.329758301,57820417.302065603,59411092.357295804,71802805.862595305,74209150.740354002,80188487.318460003,91552302.530804187,104032547.306604,112025972.6630495,132157057.80559319,134359761.2904675,139558535.45177761,206256239.653364,217772351.89086601,243409109.54381248,268303217.91377601,293493588.84317881,324749330.26836395,351566220.83417797,381126275.582937,419808987.04448903,444904295.01195002,378348652.71218002,411386347.44037503,442044955.51037902,458587004.9217,479325197.34387201,488811533.59043998,495046797.05722505,633164810.13823199,635099524.64096606,638769121.40099704,631714405.41564608,634432849.10560501,636767999.12325597,652634744.69349003,668977626.39940405,645615674.11244595,597536854.10364401,615061587.70829999],"text":"South Korea","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"South Korea","legendgroup":"South Korea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[623470829.55879998,619071432.93699992,592782489.51719999,606954916.79100001,628623288.52049994,652730870.71799994,660628348.55265105,648358556.99422503,659904637.162413,617141902.01170599,602806922.44400001,597980667.10527992,603809944.98070192,604237567.61440802,644304267.70196903,578910872.56480801,559938036.41538894,570050265.34967101,581582376.19890141,602335857.37208402,610108004.356547,594580816.35099399,580327937.31586194,574810072.34644008,567025433.97881997,587653483.14820004,563353089.129076,569018645.89337301,562102323.89885998,569444320.86399603,578241067.49976099,560412853.27122903,571597451.58043551,573353778.13081503,469508848.84310997,486647761.5761475,476318698.81123441,437647234.16423202,421760309.53040671,399164824.16591853,387332255.30324852,379886096.78763598,365068265.67675179,326369093.48549443,345460219.31685001],"text":"United Kingdom","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"United Kingdom","legendgroup":"United Kingdom","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":38.854296388542977,"l":53.466168534661698},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual total CO2 emissions change of top 10 developed countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.2,2023.8],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-61230859.542947575,1378605599.2796643],"tickmode":"array","ticktext":["0e+00","5e+08","1e+09"],"tickvals":[0,499999999.99999994,999999999.99999988],"categoryorder":"array","categoryarray":["0e+00","5e+08","1e+09"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total CO2 Emissions","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f49db60":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f49db60","visdat":{"111f49db60":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Similar to developed nations, the following graph indicates that developing countries are experiencing an increasing trend in CO2 emissions. The rise is particularly notable in India, which, as one of the most populous nations with rapid economic growth, contributes significantly to this trend. In contrast, Russia, Ukraine, and Kazakhstan display a decrease in emissions, likely a result of the economic and industrial challenges they faced following the dissolution of the USSR.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### TOTAL LINEPLOT FOR NON-DEVELOPED </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude the year 2022 from the dataset as we don't have that year for CO2 emissions</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>nondev_df_filtered <span class="ot">&lt;-</span> nondev_df <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(year <span class="sc">==</span> <span class="dv">2022</span>), <span class="sc">!</span>(country <span class="sc">==</span> <span class="st">"Kuwait"</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">1991</span>)) </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># purposely remove 1991 kuwait because of the oil fire anomaly  </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total CO2 emissions for each country</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>nondev_df_total_CO2 <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(CO2_emissions<span class="sc">*</span>Population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data to include only the top 10 countries with the highest annual total CO2 emissions</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>top_10_countries_CO2 <span class="ot">&lt;-</span> nondev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_CO2_emissions =</span> <span class="fu">sum</span>(total_CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_CO2_emissions)) <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="do">#### slice_head for the 10 highest and slice_tail for the 10 lowest</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>filtered_data_CO2 <span class="ot">&lt;-</span> nondev_df_total_CO2 <span class="sc">%&gt;%</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_CO2)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for CO2 emissions</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>plot_CO2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_CO2, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_CO2_emissions, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual total CO2 emissions change of top 10 developing countries"</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total CO2 Emissions"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>plotly_CO2_nondevtotal <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_CO2, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-7b333530100a5245e3d9" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-7b333530100a5245e3d9">{"x":{"data":[{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[56204016.684196547,64065330.217555501,65912534.049586795,77068258.1092242,83899908.461016595,93247156.646533757,102074603.0893632,113714113.828483,131702073.54993041,142616233.93491721,149878465.832403,154094371.26005441,161797828.43680802,176474279.0617266,187111918.7060127,185471121.84461001,170613966.57354599,207069967.74676138,211444865.9203746,218657993.17631277,229394005.10778749,233600995.41220802,244306021.75983751,254001975.27408478,268678020.09780478,289311001.34351939,306949003.99975699,317358985.67215443,327256019.65063101,340183039.41512001,346165975.2355805,347765036.24362499,344645006.76286203,361433965.5771867,462580012.77714658,498308989.79654896,532417976.72325605,557900989.04883504,529353026.05068696,492747996.03869802,497412685.25337601,477102164.86480641,475104601.84144598,442306006.52316797,488881115.23012197],"text":"Brazil","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Brazil","legendgroup":"Brazil","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[153702102.40441632,159373569.07494873,159555996.17605761,174069511.21351817,177413536.33497861,181722811.87323144,191963855.76751405,203036171.51587859,209095232.88147458,215853380.96819088,234209326.89582732,244749572.70280272,258961973.27985513,263149760.76932722,276284955.08955741,291711385.37591046,314966450.25382268,491692621.29404271,540651542.95480132,577996558.53809369,615365485.88222003,655447527.73786771,677299805.4638263,716268618.86858118,761449243.45802331,825200866.48833239,858935087.86805856,876952042.36405444,950950873.55256557,978103817.61330378,991731728.54716766,1022175233.3539226,1058725240.2361833,1124517766.1144876,1778472552.9797959,1962594332.7634349,2037415562.4516473,2187343162.0531015,2270765970.011148,2383816018.3633957,2434867801.9035358,2600446558.7068386,2626459382.5466552,2445011999.4272738,2709683698.4425592],"text":"India","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"India","legendgroup":"India","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[24668226.185251601,23374952.02781745,24540045.455585729,27562607.965055648,33362209.288733162,35791382.988176823,38955263.670677707,43306288.653439,49098098.302926123,51226505.656686001,53932536.270278402,61788246.97577925,82416407.900646403,93938115.989983484,95137002.599490389,94872860.271503195,100297047.72249602,132721212.1788348,131673522.2566448,144796115.01251519,174865000.17551762,199418664.23961923,215108758.47174838,218319079.78160149,222394935.13877642,251744202.7006149,277414209.5527007,212475344.3884818,240183690.56648001,276563093.4820677,303341398.68249989,310818314.16760564,340441501.87351924,344393726.77431899,504800168.68105757,515954192.63610005,489055105.01549941,487889932.07044709,539149221.75605094,552651515.15261161,567254817.95327997,603657060.70344603,659435681.94392514,609786044.60764897,619277515.34914851],"text":"Indonesia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Indonesia","legendgroup":"Indonesia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[53718384.001455598,64103347.152100004,67880932.500709891,82329558.26908201,83038721.624338001,91787465.319611996,101627820.0374172,106015173.60262999,129475285.01243521,143775371.02966401,139213972.317256,156459085.05563602,163731921.27203822,162103923.97374779,162982475.04356697,120493908.17391199,112995809.437907,175142725.04933199,190197797.7300992,209943748.72364959,221833893.3247388,226934895.958056,235606888.392876,263820323.38944998,271581981.05515271,276289822.77446496,267045709.32336578,305503471.07826298,379501405.17291301,369149622.43257141,394751989.11260301,397628472.57467616,413664580.59524202,442118769.08500618,577336312.91931295,588364840.63704002,597952311.88216329,632673268.94543517,631581104.07210493,633826878.02170706,685401235.26852,700937538.13676596,702958106.35651207,729977943.52280104,748878688.023072],"text":"Iran","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Iran","legendgroup":"Iran","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[273666280.41158998,257327341.99200001,270210435.59200001,260893338.85700801,236520972.62018749,210274247.30188799,177713346.374928,170422335.40459949,157054076.45228001,149429958.45815501,144946162.33943999,121062708.86755401,144060565.80900601,138356670.04453501,154965187.125736,171967975.29236698,181162848.940752,232709031.92270502,239489576.80823001,246956137.64031601,292499940.68988001,296322237.49789202,300042287.76670003,315938897.82595205,327137360.440732,293752135.80519098,275124876.45340401,273865952.289024],"text":"Kazakhstan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Kazakhstan","legendgroup":"Kazakhstan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[2443440983.6809998,2411018847.3559999,2534243327.6240416,2404540254.8083282,1963133394.0737381,1860444270.2827709,1642280618.520792,1616971432.0780439,1585388645.6455319,1481372340.4150002,1464523818.953728,1491922679.2157521,1475688502.205307,1512030385.5917621,1502587022.549067,1532135519.69016,1538695697.402504,1674550579.8781679,1689530993.603739,1627614146.23347,1626399086.2362001,1623274872.4366801,1616171218.620836,1643284251.3883739,1686741728.5373781,1676849401.7010469,1606997411.2584209,1735542704.0639],"text":"Russian Federation","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Russian Federation","legendgroup":"Russian Federation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[128140025.030316,128234876.2478615,133760085.84684899,137953745.56516001,143142850.821096,149618176.48318201,168403432.22781301,171553539.570014,173352218.5722785,176544284.0631344,185001196.2867268,192905039.93529999,199734543.99746901,201875825.62613499,218667151.61610219,228197809.26086101,257075235.951177,342654757.79249406,340711012.12188804,312930258.12175,326026644.87307167,301325395.87458003,320345274.94924802,338573417.2809934,361578278.47219199,363609359.17389303,385016874.47459996,377016408.69204402,374686896.56530005,378055369.38832206,371370008.84324038,356304753.03976202,404116575.28248,449024184.53730452,465774814.11092502,458954180.72907299,458628301.82625598,471865984.03212696,446221027.44642478,456972855.42301798,439380131.79766804,435237204.7450105,466924136.64630502,435831844.70057911,435928876.839885],"text":"South Africa","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"South Africa","legendgroup":"South Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[7440197.7542217001,9465437.1793934386,12150142.3943034,17075663.286530398,14540026.22042634,15352543.179220801,19202177.706465181,21759530.3655072,24344558.589790396,24103836.96806604,24236139.372499742,28554743.593038559,31869156.467450399,34741208.835740499,36362611.833811738,39717521.261375003,37523258.421967201,65491323.536287494,76824924.970793992,86705284.472559005,95082084.782293499,104928740.63393199,121566792.7987968,133957737.713778,156027252.51896578,174616766.48551521,182157175.183882,161763009.1727556,170280153.90443969,173250618.27427679,186332417.35948202,197138819.68572998,205746659.94287881,220425185.25,258978640.98986942,276876849.81173098,290364538.21815461,285979941.36911547,289419746.63704395,288511650.30791998,293074166.34986401,282105381.22515202,290239210.118779,277368440.27570081,278495712.16813499],"text":"Thailand","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Thailand","legendgroup":"Thailand","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[27352952.681700401,31505762.734987497,33479111.440151997,36265485.063482501,38752699.153548002,42579232.669383004,47638157.546178296,53721839.079803497,59310000.529621601,60928635.815802,65419329.821010001,73359399.164704204,81120723.743186399,76713866.297164798,75037846.543968409,75212270.27673851,79185992.812482893,124727502.91782999,137569945.34731081,151664535.33026221,158140742.69158199,164061410.79940918,171133722.05468002,167560903.13445002,181481821.17001599,199582766.01492041,212037425.43157858,212069956.92929199,207857755.92743948,229858208.9294686,213483474.33947161,221148215.44161057,236683309.80642658,244688713.20245251,341862323.43778205,355882629.3340826,347152657.5316025,363866368.60660189,384330481.492194,405304460.66803402,430220382.50227398,422568922.33046395,401719740.51855356,413433079.64920002,446204148.60067201],"text":"Turkey","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Turkey","legendgroup":"Turkey","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[729412833.74300003,687351084.15799999,709956184.7378,636547948.59450006,593215024.18239999,514148686.42559999,422800633.12600005,393312199.57471997,354475311.89840001,343126743.64262003,331209737.81700003,300317777.676,287054098.50650001,305115875.76959997,297066356.449902,308335571.75581205,311515763.18239981,309241253.26047599,305228868.19980603,298448832.8686896,258218532.42221653,224677271.71265599,234901530.68611598,223955683.30676499,232589814.88145882,222936184.95313799,207989245.27213562,203069977.96559152],"text":"Ukraine","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Ukraine","legendgroup":"Ukraine","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.168534661685349,"r":7.3059360730593621,"b":38.854296388542977,"l":53.466168534661698},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual total CO2 emissions change of top 10 developing countries","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402243},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1962.2,2023.8],"tickmode":"array","ticktext":["1980","2000","2020"],"tickvals":[1980,2000,2020],"categoryorder":"array","categoryarray":["1980","2000","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-127671977.28019518,2844795873.4769759],"tickmode":"array","ticktext":["0e+00","1e+09","2e+09"],"tickvals":[0,1000000000,2000000000],"categoryorder":"array","categoryarray":["0e+00","1e+09","2e+09"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Total CO2 Emissions","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f6eda5ffa":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f6eda5ffa","visdat":{"111f6eda5ffa":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><em>Note : Data for Russia, Ukraine, and Kazakhstan is available from 1984 onwards, as they were previously constituents of the USSR.</em></p>
<p>These analysis suggests that despite a decreasing trend in CO2 emissions per capita in some developed countries, global total CO2 emissions continue to rise. This increase is largely driven by the significant economic and population growth in countries like the US, China and India but also by other developing countries. Although individual nations such as Germany, France, Italy, and Poland have shown reductions or stabilization in total CO2 emissions, these positive changes are overshadowed by increases elsewhere. This overall trajectory indicates that, without substantial and coordinated global efforts to curb emissions across both developed and developing countries, the trend of rising total emissions is likely to persist.</p>
</section>
</section>
<section id="eda-specifc-to-pm2.5-exposure" class="level2">
<h2 class="anchored" data-anchor-id="eda-specifc-to-pm2.5-exposure">3.4 EDA Specifc to PM2.5 exposure</h2>
<section id="cumulative-particule-matter-2.5-exposure-ranking" class="level3">
<h3 class="anchored" data-anchor-id="cumulative-particule-matter-2.5-exposure-ranking">3.4.1 Cumulative particule matter 2.5 exposure ranking</h3>
<p>In line with the methodology applied to CO2 emissions, our focus now shifts to the PM2.5 exposure across the globe. By examining the top 10 developed and developing countries with the highest cumulative PM exposure, we aim to pinpoint where the need for air quality improvement is most pressing and to observe where the most significant changes over time can be discerned.</p>
<p>The following bar plot illustrates the top 10 developed countries with the highest cumulative PM exposure, clearly showing Qatar leading substantially, with Saudi Arabia, United Arab Emirates and China also exhibiting high levels. The graph also highlights the significant disparities in PM exposure within these nations, with countries like Slovenia, Slovakia, and Israel displaying considerably lower levels in comparison. This underscores the fact that even within developed nations, there can be considerable disparities in air quality.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">### BAR CHART FOR DEVELOPED COUNTRIES FOR PM</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cumulative PM exposure for each country</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>dev_df_cumulative_pm <span class="ot">&lt;-</span> rawdev_df <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pm_total =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pm_total)) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, pm_total) <span class="co"># Use top_n with 10 to get the top 10</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for plotting</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>dev_df_cumulative_pm_long <span class="ot">&lt;-</span> dev_df_cumulative_pm <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> pm_total,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"source"</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"cumulative_total"</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart for PM exposure</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>pm1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dev_df_cumulative_pm_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, cumulative_total), <span class="at">y =</span> cumulative_total, <span class="at">fill =</span> cumulative_total)) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Total PM</span><span class="sc">\n</span><span class="st">Exposure"</span>) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Developed countries with the highest cumulative PM2.5 exposure"</span>,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative PM Exposure"</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"PM Source"</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(    </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 developed countries with the highest historical cumulative PM2.5 exposure.</em></p>
<p>As for developing nations, India stands out with notably high levels, reflecting the substantial air quality challenges that accompany rapid industrialization and urbanization in populous nations. Close behind, Egypt, Kuwait, Pakistan and Bangladesh also register significant PM exposure, underscoring the environmental pressures of economic and infrastructural development. In contrast to the varied PM exposure levels observed in developed countries, this plot reveals a more consistent pattern of high PM exposure across the board for developing nations, highlighting the challenge of air pollution for these countries.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">### BAR CHART FOR NON-DEVELOPED COUNTRIES FOR PM</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the cumulative PM exposure for each country</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>nondev_df_cumulative_pm <span class="ot">&lt;-</span> rawnondev_df <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pm_total =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pm_total)) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, pm_total) <span class="co"># Use top_n with 10 to get the top 10</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to long format for plotting</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>nondev_df_cumulative_pm_long <span class="ot">&lt;-</span> nondev_df_cumulative_pm <span class="sc">%&gt;%</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> pm_total,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"source"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"cumulative_total"</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart for PM exposure</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>pm2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(nondev_df_cumulative_pm_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, cumulative_total), <span class="at">y =</span> cumulative_total, <span class="at">fill =</span> cumulative_total)) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"Total PM</span><span class="sc">\n</span><span class="st">Exposure"</span>) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Non-developed countries with the highest cumulative PM2.5 exposure"</span>,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cumulative PM Exposure"</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"PM Source"</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(    </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : This plot presents the top 10 developing countries with the highest historical cumulative PM2.5 exposure.</em></p>
</section>
<section id="better-news-on-pm-2.5" class="level3">
<h3 class="anchored" data-anchor-id="better-news-on-pm-2.5">3.4.2 Better News on PM 2.5?</h3>
<p>The following graph presents a comparative trend of average PM2.5 exposure between developed and undeveloped nations from 1990 to 2019. As we can see, developed countries experienced a slight decline from 1990 to 2010 and a substantial fall after 2010, indicating a significant reduction in PM2.5 exposure over time. This suggests effective measures have been implemented to improve air quality, potentially including stricter regulations, cleaner technologies, and increased public awareness in these countries.</p>
<p>In contrast, the red line represents undeveloped countries, showing a less pronounced decline over the past 30 years. The flatter trend suggests that while there may have been some improvements, especially around 2010, the reduction in PM2.5 exposure is not substantial enough to reach the exposure level of developed nations. This could be due to a variety of factors including slower implementation of air quality regulations, ongoing industrialization, and limited resources for environmental management.</p>
<p>The contrast between the two lines, not only in terms of changes but also in absolute values, highlights the disparities in air quality management and public health outcomes between developed and undeveloped nations. It underscores the need for increased efforts to reduce air pollution in undeveloped countries to improve health and environmental conditions. The data suggests that while there is a global trend towards better air quality, the progress is uneven and more attention may be needed in undeveloped regions to achieve similar outcomes as seen in developed countries.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT FOR PM DEV VS UNDEV</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only the years with PM exposure data for developed countries</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>developed_df_filtered <span class="ot">&lt;-</span> rawdev_df <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> PM_exposure)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Do the same for non-developed countries</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>nondev_df_filtered <span class="ot">&lt;-</span> rawnondev_df <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product =</span> PM_exposure)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total PM2.5 exposure product for developed nations</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>developed_total <span class="ot">&lt;-</span> developed_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_product =</span> <span class="fu">sum</span>(product, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="st">"Developed"</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the annual total PM2.5 exposure product for undeveloped nations</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>nondev_total <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_product =</span> <span class="fu">sum</span>(product, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">category =</span> <span class="st">"Undeveloped"</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the total data frames</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>total_product_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(developed_total, nondev_total)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for Developed and Undeveloped Nations with Yearly Total PM2.5 Exposure (Product)</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>plot_devpm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(total_product_df, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> total_product, <span class="at">color =</span> category, <span class="at">group =</span> category)) <span class="sc">+</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total PM2.5 Exposure : developed vs undeveloped"</span>,</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total PM2.5 Exposure"</span>,</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Category"</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Developed"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Undeveloped"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>Note : Data for PM2.5 exposure are available for the years 1990, 1995, 2000, 2005, and annually from 2010 to 2019.</em></p>
<p>Once again, let’s take a closer look to identify trend in PM2.5 exposure between developed and developing nations at the country level. This line graph illustrates the trajectory of PM exposure for the top 10 developed countries with the highest cumulative exposure which reveals a complex and varied landscape. Since 1990, the trends do not follow a uniform pattern; for instance, Saudi Arabia, Qatar, United Arab Emirates and China haven’t experienced any significant decrease in PM2.5 exposure over time.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT FOR DEVELOPED COUNTRIES FOR HIGH PM</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only the years with PM exposure data</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>dev_df_filtered <span class="ot">&lt;-</span> rawdev_df <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((year <span class="sc">%in%</span> years_with_data))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative PM exposure for each country to select the 10 lowest</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>top_10_countries_pm <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_pm_exposure =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cumulative_pm_exposure)) <span class="sc">%&gt;%</span> <span class="co"># To have descending order</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># To have the highest exposure</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 10 countries with the lowest cumulative PM exposure</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>filtered_data_pm <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_pm)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for PM exposure</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>plot_pm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_pm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PM_exposure, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual change of highest PM2.5 exposure for top 10 developed countries"</span>,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Annual PM Exposure"</span>,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>plotly_devpm1 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_pm, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-899b97433a326cc135dd" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-899b97433a326cc135dd">{"x":{"data":[{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[48.884192640000002,49.094561380000002,50.764701760000001,51.552046369999999,53.286676509999999,58.405557520000002,58.905135770000001,63.286570949999998,60.26956062,56.20412426,51.586572009999998,49.927784430000003,49.275683819999998,47.672634389999999],"text":"China","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"China","legendgroup":"China","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[22.479898670000001,24.929266930000001,23.327438480000001,23.268030509999999,24.988584540000002,24.709513009999998,22.355721580000001,23.004312540000001,21.768788390000001,22.513707480000001,18.859156080000002,20.201362270000001,20.05327737,19.759896879999999],"text":"Israel","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Israel","legendgroup":"Israel","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[32.681349580000003,31.759158580000001,30.40916722,23.144466959999999,21.619122780000001,24.717433969999998,22.813523920000002,23.60777306,22.03917349,22.114128619999999,21.270242679999999,20.4160723,20.393357609999999,20.124012029999999],"text":"Mexico","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Mexico","legendgroup":"Mexico","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[33.346873369999997,32.255443820000004,27.851550249999999,26.838203270000001,27.29182037,27.071809219999999,24.60328947,23.693890270000001,23.919402810000001,22.76911952,21.817867790000001,22.779038,22.747055320000001,22.642005099999999],"text":"Poland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Poland","legendgroup":"Poland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[79.304201489999997,75.543430790000002,77.779763000000003,82.72531438,79.065846440000001,81.222572589999999,85.966867690000001,81.289868100000007,72.739800410000001,84.998226799999998,76.142286139999996,78.386989619999994,77.113331160000001,76.049293030000001],"text":"Qatar","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Qatar","legendgroup":"Qatar","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[50.829824700000003,50.792074110000001,57.836136609999997,60.185683349999998,62.922794340000003,64.952371130000003,67.677318769999999,65.062637620000004,56.510702979999998,66.820873770000006,59.600736009999999,63.897134880000003,61.900851920000001,61.508241069999997],"text":"Saudi Arabia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Saudi Arabia","legendgroup":"Saudi Arabia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[27.241953609999999,26.731910360000001,22.72320586,22.194347279999999,21.473739590000001,22.603325229999999,20.330631189999998,19.637114950000001,19.312572400000001,19.115558360000001,17.869428899999999,18.245410199999998,18.495425340000001,18.365214640000001],"text":"Slovakia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Slovakia","legendgroup":"Slovakia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[26.550559549999999,25.704095209999998,22.230191690000002,21.12988842,19.197374419999999,20.942023599999999,18.599057940000002,18.425851399999999,18.056740560000001,17.920894820000001,16.529504589999998,16.707890429999999,17.083665740000001,16.969404430000001],"text":"Slovenia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Slovenia","legendgroup":"Slovenia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[24.951273539999999,24.268817009999999,24.222154969999998,23.590970739999999,22.854078319999999,25.45681317,25.798169420000001,27.53881372,28.1810993,26.976573070000001,27.805606839999999,26.88210754,27.43635201,27.440339259999998],"text":"South Korea","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"South Korea","legendgroup":"South Korea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[43.67823825,43.533697029999999,43.648343939999997,43.183990770000001,43.528074799999999,45.903536090000003,47.640940190000002,44.346513199999997,41.095632870000003,45.906348909999998,43.220890560000001,43.823690159999998,43.814185389999999,43.667025520000003],"text":"United Arab Emirates","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"United Arab Emirates","legendgroup":"United Arab Emirates","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401836,"r":7.3059360730593621,"b":37.525944375259456,"l":34.603569946035705},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual change of highest PM2.5 exposure for top 10 developed countries","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1988.55,2020.45],"tickmode":"array","ticktext":["1990","2000","2010","2020"],"tickvals":[1990,2000,2010,2020],"categoryorder":"array","categoryarray":["1990","2000","2010","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[13.057636434999999,89.438735844999997],"tickmode":"array","ticktext":["30","50","70"],"tickvals":[30,50,70],"categoryorder":"array","categoryarray":["30","50","70"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Annual PM Exposure","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f3ea496dd":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f3ea496dd","visdat":{"111f3ea496dd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>On closer examination, excluding Saudi Arabia, Qatar, the United Arab Emirates, and China, we can discern a more substantial decline in exposure levels for developed nations with high exposure except for South Korea and Singapore. This suggests that, while these countries have made notable progress, others have experienced minimal improvement or encountered difficulties in reducing PM2.5 pollution.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT FOR DEVELOPED COUNTRIES FOR HIGH PM WITHOUT TOO HIGH VALUES</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only the years with PM exposure data and countries with too high values for better visualisation</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>dev_df_filtered <span class="ot">&lt;-</span> rawdev_df <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((year <span class="sc">%in%</span> years_with_data) <span class="sc">&amp;</span> <span class="sc">!</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"China"</span>, <span class="st">"Qatar"</span>, <span class="st">"Saudi Arabia"</span>, <span class="st">"United Arab Emirates"</span>)))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative PM exposure for each country to select the 10 lowest</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>top_10_countries_pm <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_pm_exposure =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cumulative_pm_exposure)) <span class="sc">%&gt;%</span> <span class="co"># To have descending order</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># To have the highest exposure</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 10 countries with the lowest cumulative PM exposure</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>filtered_data_pm <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_pm)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for PM exposure</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>plot_pm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_pm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PM_exposure, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual change of highest PM2.5 exposure for top 10 developed countries"</span>,</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Annual PM Exposure"</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>plotly_devpm2 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_pm, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-9bf5b6b14dd6bd4d7dda" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-9bf5b6b14dd6bd4d7dda">{"x":{"data":[{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[26.116742389999999,24.938150190000002,21.412695729999999,20.873957390000001,20.487781389999999,20.787361700000002,19.04740747,18.71154684,18.16896079,17.637886989999998,16.712895459999999,16.731762289999999,16.962782010000002,16.751400929999999],"text":"Czech Republic","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Czech Republic","legendgroup":"Czech Republic","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[25.581818630000001,25.087592539999999,21.339507099999999,20.28580736,20.010988999999999,20.740740089999999,18.422064450000001,17.488960339999998,17.52501676,17.548290040000001,15.73414047,16.576510160000002,16.630896109999998,16.494349329999999],"text":"Hungary","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Hungary","legendgroup":"Hungary","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[22.479898670000001,24.929266930000001,23.327438480000001,23.268030509999999,24.988584540000002,24.709513009999998,22.355721580000001,23.004312540000001,21.768788390000001,22.513707480000001,18.859156080000002,20.201362270000001,20.05327737,19.759896879999999],"text":"Israel","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Israel","legendgroup":"Israel","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[26.880527829999998,25.24915008,24.240420539999999,21.573518079999999,20.294901029999998,21.427034599999999,18.84991698,18.137435809999999,17.107252379999998,18.041190539999999,15.756527780000001,16.09761447,16.265241280000001,16.088281330000001],"text":"Italy","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Italy","legendgroup":"Italy","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[32.681349580000003,31.759158580000001,30.40916722,23.144466959999999,21.619122780000001,24.717433969999998,22.813523920000002,23.60777306,22.03917349,22.114128619999999,21.270242679999999,20.4160723,20.393357609999999,20.124012029999999],"text":"Mexico","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Mexico","legendgroup":"Mexico","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[33.346873369999997,32.255443820000004,27.851550249999999,26.838203270000001,27.29182037,27.071809219999999,24.60328947,23.693890270000001,23.919402810000001,22.76911952,21.817867790000001,22.779038,22.747055320000001,22.642005099999999],"text":"Poland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Poland","legendgroup":"Poland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[22.144206749999999,18.11365004,18.368676820000001,16.013960449999999,15.07604341,16.42814491,17.531822909999999,18.599985019999998,17.732473079999998,18.295011949999999,17.63850257,18.558015650000002,18.493352980000001,18.765882479999998],"text":"Singapore","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Singapore","legendgroup":"Singapore","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[27.241953609999999,26.731910360000001,22.72320586,22.194347279999999,21.473739590000001,22.603325229999999,20.330631189999998,19.637114950000001,19.312572400000001,19.115558360000001,17.869428899999999,18.245410199999998,18.495425340000001,18.365214640000001],"text":"Slovakia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Slovakia","legendgroup":"Slovakia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[26.550559549999999,25.704095209999998,22.230191690000002,21.12988842,19.197374419999999,20.942023599999999,18.599057940000002,18.425851399999999,18.056740560000001,17.920894820000001,16.529504589999998,16.707890429999999,17.083665740000001,16.969404430000001],"text":"Slovenia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Slovenia","legendgroup":"Slovenia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[24.951273539999999,24.268817009999999,24.222154969999998,23.590970739999999,22.854078319999999,25.45681317,25.798169420000001,27.53881372,28.1810993,26.976573070000001,27.805606839999999,26.88210754,27.43635201,27.440339259999998],"text":"South Korea","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"South Korea","legendgroup":"South Korea","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401836,"r":7.3059360730593621,"b":37.525944375259456,"l":34.603569946035705},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual change of highest PM2.5 exposure for top 10 developed countries","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1988.55,2020.45],"tickmode":"array","ticktext":["1990","2000","2010","2020"],"tickvals":[1990,2000,2010,2020],"categoryorder":"array","categoryarray":["1990","2000","2010","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[14.162501912,34.260414867999998],"tickmode":"array","ticktext":["15","20","25","30"],"tickvals":[15,20,25,30],"categoryorder":"array","categoryarray":["15","20","25","30"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Annual PM Exposure","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f2d195c30":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f2d195c30","visdat":{"111f2d195c30":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><em>Note : In this plot, we remove the observation of China, Qatar, Saudi Arabia and United Arab Emirates as it was difficult too highlight a trend for the countries with lower values.</em></p>
<p>What about developed countries with lower PM2.5 exposure level ? The following plot suggests that every nation with relatively low PM2.5 exposure levels has experienced significant reductions over time. The consistent decline across these countries reinforces the idea that effective PM reduction strategies are in place and can yield positive results for developed nations with lower exposure.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT FOR DEVELOPED COUNTRIES FOR LOW PM</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only the years with PM exposure data</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>dev_df_filtered <span class="ot">&lt;-</span> rawdev_df <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative PM exposure for each country to select the 10 lowest</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>top_10_countries_pm <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_pm_exposure =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cumulative_pm_exposure)) <span class="sc">%&gt;%</span> <span class="co"># To have descending order</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># To have the highest exposure</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 10 countries with the lowest cumulative PM exposure</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>filtered_data_pm <span class="ot">&lt;-</span> dev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_pm)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for PM exposure</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>plot_pm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_pm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PM_exposure, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual change of lowest PM2.5 exposure for top 10 developed countries"</span>,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Annual PM Exposure"</span>,</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>plotly_devpm3 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_pm, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-6d3f02c2e741a54b4665" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-6d3f02c2e741a54b4665">{"x":{"data":[{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[7.5936526329999996,7.4756069749999998,7.3566274539999998,6.904730947,6.7852356130000002,6.7074947969999998,6.9954912870000001,6.9643022959999996,6.8800506810000002,6.8484767230000001,6.8153661919999999,6.6736389559999996,6.7380864389999999,6.7454978590000003],"text":"Australia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Australia","legendgroup":"Australia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[10.092392220000001,9.7688464760000002,9.2003719509999993,9.0202558279999998,7.8840193709999999,7.3400769290000003,7.6004954839999996,7.2750266190000001,7.4920051760000002,7.2798020120000002,6.2058234089999997,7.2818747119999996,7.0787762599999997,7.1001560049999997],"text":"Canada","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Canada","legendgroup":"Canada","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[9.9083088969999995,9.3340295219999998,8.4327836600000001,8.3649609100000006,8.6483865529999999,7.7498319139999996,7.4843870150000003,7.5418121810000001,8.0970208580000005,6.5633803239999997,6.5177197189999996,5.6839144289999997,5.9857994779999997,5.8935623809999997],"text":"Estonia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Estonia","legendgroup":"Estonia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[8.8015652230000008,8.1382448979999999,7.5050048780000003,7.114175404,7.205869088,7.018955644,6.3630622219999999,5.983816655,6.3731124379999997,5.6287784399999996,5.5894322230000002,5.2577883889999999,5.5967886650000001,5.5653301969999998],"text":"Finland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Finland","legendgroup":"Finland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[7.222283054,6.8616358740000001,6.8622787689999996,6.6495534919999999,6.5956383230000002,6.8091866579999998,6.1919146569999999,6.0918010550000004,5.9396032930000002,5.8335872159999997,5.4365888780000002,5.7092650819999999,5.690458273,5.698616135],"text":"Iceland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Iceland","legendgroup":"Iceland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[12.723965270000001,11.89778993,11.027921299999999,10.460003800000001,9.9029315219999994,10.069391939999999,9.1572066280000008,8.7862239540000004,8.5222307110000006,8.3816818649999991,7.8382634659999999,7.6645466090000003,7.9168503750000001,7.8540942180000002],"text":"Ireland","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Ireland","legendgroup":"Ireland","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[6.9474340579999998,6.8864990329999998,6.7669914100000002,6.3483007870000003,6.3026565200000002,6.112340412,6.2345477029999996,6.2630999449999996,6.052504463,6.0079260290000001,6.0816100720000001,5.9838607389999998,6.0344713749999999,6.0483054960000002],"text":"New Zealand","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"New Zealand","legendgroup":"New Zealand","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[11.76053243,10.684193929999999,10.090806730000001,8.1687369870000008,8.0997639649999993,9.0507372789999998,7.555663741,7.2789753299999997,7.4541359170000003,7.0093254399999996,6.5945239149999999,6.6525071609999999,6.6957992949999996,6.6423833739999996],"text":"Norway","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Norway","legendgroup":"Norway","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[9.7803134899999993,8.8492055240000003,8.4338877169999993,7.3067087400000004,7.4006447919999996,7.4695324940000001,6.170044152,6.1714925620000001,6.4540659140000001,5.8701470430000002,5.4467111499999996,5.6930116340000003,5.6884076219999997,5.6475728549999999],"text":"Sweden","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Sweden","legendgroup":"Sweden","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[13.41568004,12.89770264,11.94563014,10.91341302,9.2218518249999999,9.2629925400000008,8.8699881460000007,8.6416289699999993,8.4330023779999994,8.1637527910000003,7.3789394120000003,7.7446845099999999,7.7751152570000004,7.6636925160000002],"text":"US","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"US","legendgroup":"US","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401836,"r":7.3059360730593621,"b":37.525944375259456,"l":34.603569946035705},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual change of lowest PM2.5 exposure for top 10 developed countries","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1988.55,2020.45],"tickmode":"array","ticktext":["1990","2000","2010","2020"],"tickvals":[1990,2000,2010,2020],"categoryorder":"array","categoryarray":["1990","2000","2010","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.8498938064499999,13.82357462255],"tickmode":"array","ticktext":["6","8","10","12"],"tickvals":[6,8,10,12],"categoryorder":"array","categoryarray":["6","8","10","12"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Annual PM Exposure","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f4fe1db7":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f4fe1db7","visdat":{"111f4fe1db7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>In the context of developing nations, we observe the same phenomenon as in developed countries when analyzing PM2.5 exposure, but it appears more pronounced. Indeed, all the top 10 developing countries with the highest exposure do not show any significant decrease over time. The following plot reveals a pattern of minor increases or stabilization rather than a clear decline. This pattern contrasts with the overall reduction trend in PM exposure that has been observed globally for developing nations, although slight.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT FOR NON-DEVELOPED COUNTRIES FOR HIGH PM</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only the years with PM exposure data</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>nondev_df_filtered <span class="ot">&lt;-</span> rawnondev_df <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative PM exposure for each country to select the 10 lowest</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>top_10_countries_pm <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_pm_exposure =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cumulative_pm_exposure)) <span class="sc">%&gt;%</span> <span class="co"># To have descending order</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># To have the highest exposure</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 10 countries with the lowest cumulative PM exposure</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>filtered_data_pm <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_pm)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for PM exposure</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>plot_pm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_pm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PM_exposure, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual change of highest PM2.5 exposure for top 10 developing countries"</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Annual PM Exposure"</span>,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>plotly_nondevpm1 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_pm, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-c50e7c7aed1526fdc607" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-c50e7c7aed1526fdc607">{"x":{"data":[{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[52.909938310000001,51.643626159999997,53.746958169999999,55.061944390000001,56.416498539999999,60.535873899999999,68.942711360000004,66.427381130000001,73.270822960000004,68.970337189999995,67.767359799999994,62.753183159999999,63.275462570000002,63.425528499999999],"text":"Bangladesh","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Bangladesh","legendgroup":"Bangladesh","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[66.635104229999996,74.623891670000006,69.848847090000007,69.657271600000001,78.51079086,69.783152689999994,69.704223240000005,74.755195810000004,72.024853829999998,73.130988279999997,66.747038380000006,66.959185160000004,68.472896079999998,67.88817813],"text":"Egypt","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Egypt","legendgroup":"Egypt","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[71.499756099999999,65.620430970000001,70.475130179999994,70.806076989999994,76.678342220000005,79.997190509999996,86.381684079999999,89.452262020000006,95.242643970000003,88.445124289999995,92.231946649999998,81.811648039999994,83.04086375,83.199316339999996],"text":"India","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"India","legendgroup":"India","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[37.768668550000001,38.069617460000003,39.706493760000001,38.356062280000003,41.378536220000001,42.559019640000002,41.483788390000001,41.238884429999999,39.85297971,40.891167719999999,39.841312180000003,38.964571499999998,38.607623009999998,38.015083150000002],"text":"Iran","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Iran","legendgroup":"Iran","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[52.980780920000001,48.261500470000001,50.925443340000001,50.853650620000003,57.245931370000001,53.983731980000002,53.547759730000003,51.546300590000001,47.585352919999998,53.096425719999999,50.089786660000001,50.029419189999999,49.148299559999998,48.468252159999999],"text":"Iraq","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Iraq","legendgroup":"Iraq","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[59.702140800000002,53.860641039999997,63.060215640000003,65.286299200000002,66.249371600000003,67.977157509999998,69.264866699999999,66.794672399999996,57.029474919999998,66.144610170000007,61.008908849999997,63.398508079999999,61.494764500000002,60.966480130000001],"text":"Kuwait","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Kuwait","legendgroup":"Kuwait","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[45.601357319999998,44.044145790000002,41.704191010000002,37.153076769999998,35.844343299999998,41.056908569999997,36.795340469999999,33.904864109999998,34.792783980000003,32.559752860000003,30.495339770000001,31.435659210000001,30.885282019999998,30.269318559999999],"text":"North Macedonia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"North Macedonia","legendgroup":"North Macedonia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[43.642397989999999,39.655577700000002,43.159368870000002,42.790039559999997,41.071754779999999,44.830630530000001,46.571055229999999,44.059228150000003,40.655380719999997,44.063959599999997,42.27135251,44.033252359999999,44.31794214,44.57247023],"text":"Oman","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Oman","legendgroup":"Oman","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[60.737048000000001,53.45696804,57.718894970000001,55.208816429999999,59.608700319999997,59.987284680000002,65.410813390000001,66.846345479999997,70.944745380000001,66.929754399999993,68.717640900000006,61.75482212,62.39700577,62.574249870000003],"text":"Pakistan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Pakistan","legendgroup":"Pakistan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[36.050447679999998,38.348894540000003,37.002361839999999,31.30170584,32.291406960000003,41.438520279999999,39.021300320000002,39.484591799999997,37.503359199999998,35.485867829999997,35.116779800000003,35.068713070000001,34.784866049999998,34.786095570000001],"text":"Uzbekistan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Uzbekistan","legendgroup":"Uzbekistan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401836,"r":7.3059360730593621,"b":37.525944375259456,"l":34.603569946035705},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual change of highest PM2.5 exposure for top 10 developing countries","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1988.55,2020.45],"tickmode":"array","ticktext":["1990","2000","2010","2020"],"tickvals":[1990,2000,2010,2020],"categoryorder":"array","categoryarray":["1990","2000","2010","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[27.020652289499999,98.491310240499999],"tickmode":"array","ticktext":["40","60","80"],"tickvals":[40,60,80],"categoryorder":"array","categoryarray":["40","60","80"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Annual PM Exposure","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f7ef8d826":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f7ef8d826","visdat":{"111f7ef8d826":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>So, which developing countries are responsible for the reduction trend in PM2.5 exposure ? To address this question, we must analyze developing nations with lower exposure levels. The graph for developing countries with the lowest levels of PM exposure demonstrates a substantial decrease. This indicates that, much like developed countries, but more markedly, developing nations starting with lower levels of PM2.5 have been more successful in implementing effective air quality management strategies than developing nations with higher exposure, leading to more significant improvements over time.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">### LINE PLOT FOR NON-DEVELOPED COUNTRIES FOR LOW PM</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for only the years with PM exposure data</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>nondev_df_filtered <span class="ot">&lt;-</span> rawnondev_df <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative PM exposure for each country to select the 10 lowest</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>top_10_countries_pm <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">cumulative_pm_exposure =</span> <span class="fu">sum</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cumulative_pm_exposure)) <span class="sc">%&gt;%</span> <span class="co"># To have descending order</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># To have the highest exposure</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 10 countries with the lowest cumulative PM exposure</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>filtered_data_pm <span class="ot">&lt;-</span> nondev_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_10_countries_pm)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an interactive line plot with hover labels for PM exposure</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>plot_pm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data_pm, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> PM_exposure, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">text =</span> country)) <span class="sc">+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Annual change of lowest PM2.5 exposure for top 10 developing countries"</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Annual PM Exposure"</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the ggplot to a plotly object for interactivity</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>plotly_nondevpm2 <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(plot_pm, <span class="at">width =</span> <span class="dv">700</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-62633098db686b0227ee" style="width:100%;height:464px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-62633098db686b0227ee">{"x":{"data":[{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[15.62276872,15.5412485,14.16360006,13.292024230000001,13.7363052,14.18995612,13.358838779999999,14.70187086,13.77937715,14.58721171,14.111299710000001,13.610765389999999,13.63250289,13.511189180000001],"text":"Argentina","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Argentina","legendgroup":"Argentina","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[25.207968099999999,23.082169709999999,21.812904899999999,21.00241299,22.098419620000001,19.55318145,18.881228180000001,19.780077120000001,20.21540632,18.50294397,16.712078829999999,16.40896425,16.501892479999999,16.423512850000002],"text":"Belarus","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"Belarus","legendgroup":"Belarus","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[14.63356471,14.479435069999999,14.59147229,14.56811401,14.082500599999999,14.694800799999999,13.78803347,13.155816959999999,13.00059985,11.691494609999999,11.422845089999999,11.665272979999999,11.626997060000001,11.653991209999999],"text":"Brazil","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"Brazil","legendgroup":"Brazil","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[21.678068920000001,18.90217376,18.799181789999999,19.629007319999999,21.29437515,19.506224199999998,20.884737430000001,19.99272951,20.832374290000001,20.91779236,20.71374205,19.213568309999999,20.055591530000001,19.97447395],"text":"Ecuador","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"Ecuador","legendgroup":"Ecuador","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[21.243647339999999,20.380516060000001,18.034496969999999,17.53591329,18.978253859999999,22.318656409999999,24.009083260000001,22.853308120000001,21.456556209999999,20.513554360000001,20.868814230000002,20.103448090000001,20.25210336,20.294854470000001],"text":"Kazakhstan","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"Kazakhstan","legendgroup":"Kazakhstan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[27.95581395,22.78895296,20.582904190000001,20.102164909999999,18.241051970000001,17.315538279999998,18.181107730000001,18.527766100000001,17.220799660000001,18.123862020000001,16.758190339999999,16.437424100000001,16.460842880000001,16.590996310000001],"text":"Malaysia","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"Malaysia","legendgroup":"Malaysia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[22.067528939999999,21.273135320000002,19.837991720000002,18.687459830000002,18.489955559999999,19.50868234,17.84168596,16.489544540000001,16.558727860000001,16.094924049999999,15.19734324,15.71390854,15.699412049999999,15.671089520000001],"text":"Romania","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"Romania","legendgroup":"Romania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[18.790174369999999,17.094387690000001,15.379373169999999,14.34288935,15.27774638,13.63707838,13.65876761,13.909761319999999,13.935283480000001,12.87477297,12.17632027,11.522595989999999,11.62978513,11.59553193],"text":"Russian Federation","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"Russian Federation","legendgroup":"Russian Federation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[21.32660649,21.364667189999999,21.565755769999999,19.359465199999999,20.123993479999999,19.824046689999999,20.210837919999999,20.386116699999999,20.634552559999999,22.364114140000002,21.744801070000001,21.387958600000001,21.87542393,21.970725470000001],"text":"Trinidad & Tobago","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"Trinidad & Tobago","legendgroup":"Trinidad & Tobago","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1990,1995,2000,2005,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"y":[22.836117949999998,21.381915129999999,19.38182436,18.99706651,18.778056209999999,18.1284545,17.5138754,17.663273669999999,17.267573250000002,16.650750460000001,14.920370500000001,14.511178259999999,14.6057706,14.531444759999999],"text":"Ukraine","type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"Ukraine","legendgroup":"Ukraine","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.840182648401836,"r":7.3059360730593621,"b":37.525944375259456,"l":34.603569946035705},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Annual change of lowest PM2.5 exposure for top 10 developing countries","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1988.55,2020.45],"tickmode":"array","ticktext":["1990","2000","2010","2020"],"tickvals":[1990,2000,2010,2020],"categoryorder":"array","categoryarray":["1990","2000","2010","2020"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[10.596196646999999,28.782462392999999],"tickmode":"array","ticktext":["15","20","25"],"tickvals":[15,20,25],"categoryorder":"array","categoryarray":["15","20","25"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Annual PM Exposure","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Country","font":{"color":"rgba(0,0,0,1)","family":"","size":11.955168119551683}}},"hovermode":"closest","width":700,"height":500,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"111f17cc716c":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"111f17cc716c","visdat":{"111f17cc716c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Concluding our analysis of PM exposure levels, we must acknowledge the complexity in drawing health-related conclusions from our dataset. The figures represent an annual average across entire countries, which may obscure localized PM concentrations that are typically higher in urban areas. Therefore, it’s impractical to declare specific national levels as universally dangerous without considering regional variations and city-level data.</p>
<p>Contrasting PM exposure with CO2 emissions reveals a somewhat optimistic picture. Unlike the consistent rise in CO2 emissions, PM exposure levels are declining in both developed and developing countries, indicating progressive strides in air quality management. Despite this positive trend, it’s clear that developing countries still have significant room for improvement to achieve the air quality standards seen in more developed nations.</p>
</section>
</section>
<section id="the-2019-overview-renewable-energies-emissions-and-pm2.5-exposure" class="level2">
<h2 class="anchored" data-anchor-id="the-2019-overview-renewable-energies-emissions-and-pm2.5-exposure">3.6 The 2019 Overview: Renewable Energies, Emissions, and PM2.5 Exposure</h2>
<p>After analyzing the trends for renewable energy generation, CO2 emissions, and PM2.5 exposure, the following interactive map provides a snapshot of the global situation in 2019. This visual tool allows us to explore the interplay between renewable energy generation and the environmental indicators of CO2 emissions and PM2.5 exposure levels.</p>
<p>The interactive map reveals that countries in the Middle East are characterized by high levels of both CO2 emissions and PM2.5 exposure. However, the relationship between CO2 emissions and PM2.5 exposure is not uniform across the board. For instance, countries like China, Egypt, and India, despite their relatively lower CO2 emissions in 2019, still faced significant levels of PM2.5 exposure. This suggests that other factors, possibly including industrial processes, vehicular emissions, and regional environmental policies, play critical roles in determining air quality. Conversely, countries such as Australia, Canada, and the United States registered significant CO2 emissions but comparatively low levels of PM2.5 exposure. These observations may reflect effective air quality management strategies, the geographical dispersion of pollution sources, or a higher adoption of advanced technologies for emissions control in these regions.</p>
<p>In concluding the analysis of renewable energy generation on the interactive map, it is evident that while countries like China and the United States exhibit substantial energy production across all five renewable sources, there exists a marked variation among other countries. For instance, nations such as France and Russia are prominent in nuclear energy generation but lag in harnessing other renewable forms. Similarly, Germany, India, and Brazil prominently utilize geothermal resources, yet their exploitation of alternative renewable sources remains limited. This pattern suggests that beyond the United States and China, countries often do not fully capitalize on every renewable energy opportunity, likely due to the interplay of multiple influencing factors such as infrastructure capabilities, climatic conditions, political will, and economic policies.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">### INTERACTIVE MAP</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>filtered_data_raw <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2019</span>) </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We choose 2019 as its the latest observations we have for pm2.5</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Update menus component</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>updatemenus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">active =</span> <span class="dv">0</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.2</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.99</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">buttons =</span> <span class="fu">list</span>(</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Solar"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Wind"</span>,</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Hydro"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Nuclear"</span>,</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="st">"Geo"</span>,</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)))</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="do">### Create the interactive map </span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="fu">plot_geo</span>(filtered_data_raw, <span class="at">locationmode =</span> <span class="st">'country names'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>solar_generation,</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country,</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>solar_generation,</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="st">'Reds'</span>,</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Solar'</span>,</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Solar Generation (TWh)"</span>, <span class="at">len =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">orientation =</span> <span class="st">"h"</span>)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>wind_generation,</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country,</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>wind_generation,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Wind'</span>,</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Wind Generation (TWh)"</span>, <span class="at">len =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">orientation =</span> <span class="st">"h"</span>),</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">visible =</span> <span class="cn">FALSE</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>hydro_generation,</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country,</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>hydro_generation,</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Hydro'</span>,</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Hydro Generation (TWh)"</span>, <span class="at">len =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">orientation =</span> <span class="st">"h"</span>),</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">visible =</span> <span class="cn">FALSE</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>nuclear_generation,</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country,</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>nuclear_generation,</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Nuclear'</span>,</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Nuclear Generation (TWh)"</span>, <span class="at">len =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">orientation =</span> <span class="st">"h"</span>),</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">visible =</span> <span class="cn">FALSE</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="sc">~</span>geo_generation,</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country,</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>geo_generation,</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Geo'</span>,</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Geo Generation (TWh)"</span>, <span class="at">len =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">orientation =</span> <span class="st">"h"</span>),</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">visible =</span> <span class="cn">FALSE</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">'scattergeo'</span>,  <span class="co"># Specify the trace type</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">'markers'</span>,     <span class="co"># Use markers</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country, <span class="co"># Specify countries as locations</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="sc">~</span>CO2_emissions,      <span class="co"># Size of the markers based on CO2 emissions</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">'black'</span>,                 <span class="co"># Marker color</span></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">sizemode =</span> <span class="st">'area'</span>,               <span class="co"># The size of the marker represents an area</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">sizeref =</span> <span class="fl">0.08</span>,                   <span class="co"># Adjust this value to scale marker sizes</span></span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"rgb(40,40,40)"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Total CO2 Emissions'</span></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">'scattergeo'</span>,  <span class="co"># Specify the trace type</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode =</span> <span class="st">'markers'</span>,     <span class="co"># Use markers</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="sc">~</span>country, <span class="co"># Specify countries as locations</span></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(</span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="sc">~</span>PM_exposure,      <span class="co"># Size of the markers based on CO2 emissions</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">'grey'</span>,                 <span class="co"># Marker color</span></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>      <span class="at">sizemode =</span> <span class="st">'area'</span>,               <span class="co"># The size of the marker represents an area</span></span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">sizeref =</span> <span class="fl">0.2</span>,                   <span class="co"># Adjust this value to scale marker sizes</span></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"rgb(40,40,40)"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'PM Exposure'</span></span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total renewable energy generation (2019)"</span>,</span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">updatemenus =</span> updatemenus,</span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">geo =</span> <span class="fu">list</span>(</span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">showland =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">landcolor =</span> <span class="fu">toRGB</span>(<span class="st">"gray95"</span>),</span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">countrycolor =</span> <span class="fu">toRGB</span>(<span class="st">"gray80"</span>)</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="st">"&lt;b&gt;Click to hide circle&lt;/b&gt;"</span>,  </span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fl">1.04</span>,  </span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fl">0.19</span>,     </span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">xref =</span> <span class="st">"paper"</span>,</span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">xanchor =</span> <span class="st">'left'</span>,  </span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">yanchor =</span> <span class="st">'top'</span>,   </span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="st">'left'</span>,</span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">showarrow =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">font =</span> <span class="fu">list</span>(</span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">12</span>,  </span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"black"</span>  </span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">list</span>(</span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">t =</span> <span class="dv">100</span>  <span class="co"># Reduce the top margin to bring the title closer to the map</span></span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a3e8db2c0da1d04b9391" style="width:95%;height:1112.4px;"></div>
<script type="application/json" data-for="htmlwidget-a3e8db2c0da1d04b9391">{"x":{"visdat":{"111f2eb0300a":["function () ","plotlyVisDat"]},"cur_data":"111f2eb0300a","attrs":{"111f2eb0300a":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"locations":{},"color":{},"colors":"Reds","name":"Solar","colorbar":{"title":"Solar Generation (TWh)","len":1,"y":0.10000000000000001,"orientation":"h"},"inherit":true},"111f2eb0300a.1":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"locations":{},"color":{},"name":"Wind","colorbar":{"title":"Wind Generation (TWh)","len":1,"y":0.10000000000000001,"orientation":"h"},"visible":false,"inherit":true},"111f2eb0300a.2":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"locations":{},"color":{},"name":"Hydro","colorbar":{"title":"Hydro Generation (TWh)","len":1,"y":0.10000000000000001,"orientation":"h"},"visible":false,"inherit":true},"111f2eb0300a.3":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"locations":{},"color":{},"name":"Nuclear","colorbar":{"title":"Nuclear Generation (TWh)","len":1,"y":0.10000000000000001,"orientation":"h"},"visible":false,"inherit":true},"111f2eb0300a.4":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"locations":{},"color":{},"name":"Geo","colorbar":{"title":"Geo Generation (TWh)","len":1,"y":0.10000000000000001,"orientation":"h"},"visible":false,"inherit":true},"111f2eb0300a.5":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scattergeo","mode":"markers","locations":{},"marker":{"size":{},"color":"black","sizemode":"area","sizeref":0.080000000000000002,"line":{"color":"rgb(40,40,40)","width":0.5}},"name":"Total CO2 Emissions","inherit":true},"111f2eb0300a.6":{"locationmode":"country names","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scattergeo","mode":"markers","locations":{},"marker":{"size":{},"color":"grey","sizemode":"area","sizeref":0.20000000000000001,"line":{"color":"rgb(40,40,40)","width":0.5}},"name":"PM Exposure","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":100,"r":10},"mapType":"geo","title":"Total renewable energy generation (2019)","showlegend":true,"updatemenus":[{"active":0,"x":0.20000000000000001,"y":0.98999999999999999,"buttons":[{"label":"Solar","method":"update","args":[{"visible":[true,false,false,false,false,true,true]}]},{"label":"Wind","method":"update","args":[{"visible":[false,true,false,false,false,true,true]}]},{"label":"Hydro","method":"update","args":[{"visible":[false,false,true,false,false,true,true]}]},{"label":"Nuclear","method":"update","args":[{"visible":[false,false,false,true,false,true,true]}]},{"label":"Geo","method":"update","args":[{"visible":[false,false,false,false,true,true,true]}]}]}],"geo":{"domain":{"x":[0,1],"y":[0,1]},"showland":true,"landcolor":"rgba(242,242,242,1)","countrycolor":"rgba(204,204,204,1)"},"annotations":[{"text":"<b>Click to hide circle<\/b>","x":1.04,"y":0.19,"xref":"paper","yref":"paper","xanchor":"left","yanchor":"top","align":"left","showarrow":false,"font":{"size":12,"color":"black"}}],"scene":{"zaxis":{"title":"solar_generation"}},"hovermode":"closest","legend":{"yanchor":"top","y":0.16666666666666663}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"Solar Generation (TWh)","ticklen":2,"len":1,"y":0.10000000000000001,"orientation":"h","lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":true,"locationmode":"country names","z":[0.61499999999999999,0.79969791300000015,18.296986696525771,1.7020930000000001,0.044200000000000003,0.32763199999999998,0.17899999999999999,4.2525000000000004,6.6545790828080689,1.417286,4.0797979797979798,6.3002263986237486,224,0.13206000000000001,0.083099999999999993,0.21826699999999999,2.2870433710000051,0.9632694444444444,0.037999999999999999,1.4890000000000001,0.073499999999999996,0.14718200000000001,11.812405999999999,45.220999999999997,4.4285100000000002,1.4970000000000001,0,46.267699999999998,0.11828,0.51047300000000007,0.37654500000000002,0.039508000000000001,3.1145,23.6889,67.746255454545448,0.39122089999999998,0.058538000000000007,0.003137,0.0911,0.130385,1.4042399999999999,9.9643200000000007,1.5814619999999999,5.3994059999999999,0.12790351886342219,0.023227000000000001,0.10502,0.016555,0.70023479020086254,0.83289999999999997,1.2460819999999999,0.710673,1.3420000000000001,0.0083640000000000016,1.778,0.98504999999999998,0.20673662837728121,0.19461898999999999,0.58899999999999997,0.303039,4.9029999999999996,14.19291128839876,15.10828678,0.50039999999999996,0.66300000000000003,2.1779999999999999,5.1459999999999999,0.005555,9.2497999999999987,0.00696,2.9327999999999999,3.6558000000000002,12.418049999999999,107.97373737373741,0.0068269999999999997,0.00033750000000000002,5.2517899999999997],"locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"name":"Solar","type":"choropleth","marker":{"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":1272.538,"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":false,"color":[0.61499999999999999,0.79969791300000015,18.296986696525771,1.7020930000000001,0.044200000000000003,0.32763199999999998,0.17899999999999999,4.2525000000000004,6.6545790828080689,1.417286,4.0797979797979798,6.3002263986237486,224,0.13206000000000001,0.083099999999999993,0.21826699999999999,2.2870433710000051,0.9632694444444444,0.037999999999999999,1.4890000000000001,0.073499999999999996,0.14718200000000001,11.812405999999999,45.220999999999997,4.4285100000000002,1.4970000000000001,0,46.267699999999998,0.11828,0.51047300000000007,0.37654500000000002,0.039508000000000001,3.1145,23.6889,67.746255454545448,0.39122089999999998,0.058538000000000007,0.003137,0.0911,0.130385,1.4042399999999999,9.9643200000000007,1.5814619999999999,5.3994059999999999,0.12790351886342219,0.023227000000000001,0.10502,0.016555,0.70023479020086254,0.83289999999999997,1.2460819999999999,0.710673,1.3420000000000001,0.0083640000000000016,1.778,0.98504999999999998,0.20673662837728121,0.19461898999999999,0.58899999999999997,0.303039,4.9029999999999996,14.19291128839876,15.10828678,0.50039999999999996,0.66300000000000003,2.1779999999999999,5.1459999999999999,0.005555,9.2497999999999987,0.00696,2.9327999999999999,3.6558000000000002,12.418049999999999,107.97373737373741,0.0068269999999999997,0.00033750000000000002,5.2517899999999997]}},"geo":"geo","frame":null},{"colorbar":{"title":"Wind Generation (TWh)","ticklen":2,"len":1,"y":0.10000000000000001,"orientation":"h","lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":true,"locationmode":"country names","z":[0.01,4.995966423999997,19.471688079239222,7.4500764891127709,0.10539999999999999,0.0050809999999999996,0.16600000000000001,9.7554000000000354,55.985621679834018,1.316988,32.875572727272733,4.8952212936371531,405.30000000000001,0.063320000000000001,1.4673,0.238565,0.70003396200000001,16.14983333333333,0.085526937250000087,4.9796868686868683,0.68700000000000006,6.0247460000000004,34.615358000000001,125.89400000000001,7.2663469999999997,0.72899999999999998,0.0065691910000000003,63.314230000000002,0.48399999999999999,0.72199999999999998,0,10.019485,0.04825535999999829,20.202000000000002,6.7486650189999988,0.70713340000000002,0.0036419999999999998,0.153999,1.4994000000000001,0.28128300000000001,0,16.72691,4.6991900000000024,11.457694,2.2556674507847778,0.10180599999999999,5.5250000000000004,0.0086999999999999994,3.1482447310831949,1.655,1.04166,15.106759,13.667,0,6.7730000000000006,0.31480999999999998,0.0056940000000000003,0,0.0060000000000000001,0.0061500000000000001,6.6320000000000006,2.6792475171568011,53.089070229999997,0.34820000000000001,19.846584,0.14599999999999999,3.6699999999999999,2.6999999999999999e-05,21.730699999999999,0,2.0202,0,63.834890000000001,298.87119595959598,0.0155,0.0596,0.72199999999999998],"locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"name":"Wind","visible":false,"type":"choropleth","marker":{"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":1272.538,"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":false,"color":[0.01,4.995966423999997,19.471688079239222,7.4500764891127709,0.10539999999999999,0.0050809999999999996,0.16600000000000001,9.7554000000000354,55.985621679834018,1.316988,32.875572727272733,4.8952212936371531,405.30000000000001,0.063320000000000001,1.4673,0.238565,0.70003396200000001,16.14983333333333,0.085526937250000087,4.9796868686868683,0.68700000000000006,6.0247460000000004,34.615358000000001,125.89400000000001,7.2663469999999997,0.72899999999999998,0.0065691910000000003,63.314230000000002,0.48399999999999999,0.72199999999999998,0,10.019485,0.04825535999999829,20.202000000000002,6.7486650189999988,0.70713340000000002,0.0036419999999999998,0.153999,1.4994000000000001,0.28128300000000001,0,16.72691,4.6991900000000024,11.457694,2.2556674507847778,0.10180599999999999,5.5250000000000004,0.0086999999999999994,3.1482447310831949,1.655,1.04166,15.106759,13.667,0,6.7730000000000006,0.31480999999999998,0.0056940000000000003,0,0.0060000000000000001,0.0061500000000000001,6.6320000000000006,2.6792475171568011,53.089070229999997,0.34820000000000001,19.846584,0.14599999999999999,3.6699999999999999,2.6999999999999999e-05,21.730699999999999,0,2.0202,0,63.834890000000001,298.87119595959598,0.0155,0.0596,0.72199999999999998]}},"geo":"geo","frame":null},{"colorbar":{"title":"Hydro Generation (TWh)","ticklen":2,"len":1,"y":0.10000000000000001,"orientation":"h","lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":true,"locationmode":"country names","z":[0.152,27.50450353480894,14.020775808939661,40.825970500582969,1.5648,0.82309118900000011,0.35099999999999998,0.30199999999999999,397.87705662886498,2.9294989999999999,381.77032323232328,21.440327173052381,1272.538,54.436999999999998,5.8261000000000012,0,2.0086515970000001,0.016955000000000001,24.640999999999998,14.079499999999999,0.019,12.420475,56.051037000000001,19.731000000000002,3.9995980000000002,0.219,13.461465931999999,162.06624968700001,21.161000000000001,33.865000000000002,4.9632640000000006,0.88658400000000015,0.022044640000000001,46.356499999999997,73.64050985099999,9.9936587999999986,0,2.1075539999999999,0.34539999999999998,0.10691500000000009,26.196000000000002,23.608055574442002,1.2627809999999999,0.074181999999999998,25.598652267728792,1.1636740000000001,125.28955999999999,0,36.136221968070977,31.4621,8.0254919999999998,1.954,8.8179999999999996,0,15.580921,194.37613999999999,0,0,4.3559999999999999,4.4793950000000002,0.74099999999999966,2.788678802024001,22.486077300000002,4.8118999999999996,65.29721099999999,37.633968994140623,6.309958,0,88.822799999999987,0.0031540000000000001,6.5083000000000011,0,5.9329000000000001,285.46766363636368,6.4620830914634739,62.789400000000001,66.542000000000002],"locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"name":"Hydro","visible":false,"type":"choropleth","marker":{"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":1272.538,"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":false,"color":[0.152,27.50450353480894,14.020775808939661,40.825970500582969,1.5648,0.82309118900000011,0.35099999999999998,0.30199999999999999,397.87705662886498,2.9294989999999999,381.77032323232328,21.440327173052381,1272.538,54.436999999999998,5.8261000000000012,0,2.0086515970000001,0.016955000000000001,24.640999999999998,14.079499999999999,0.019,12.420475,56.051037000000001,19.731000000000002,3.9995980000000002,0.219,13.461465931999999,162.06624968700001,21.161000000000001,33.865000000000002,4.9632640000000006,0.88658400000000015,0.022044640000000001,46.356499999999997,73.64050985099999,9.9936587999999986,0,2.1075539999999999,0.34539999999999998,0.10691500000000009,26.196000000000002,23.608055574442002,1.2627809999999999,0.074181999999999998,25.598652267728792,1.1636740000000001,125.28955999999999,0,36.136221968070977,31.4621,8.0254919999999998,1.954,8.8179999999999996,0,15.580921,194.37613999999999,0,0,4.3559999999999999,4.4793950000000002,0.74099999999999966,2.788678802024001,22.486077300000002,4.8118999999999996,65.29721099999999,37.633968994140623,6.309958,0,88.822799999999987,0.0031540000000000001,6.5083000000000011,0,5.9329000000000001,285.46766363636368,6.4620830914634739,62.789400000000001,66.542000000000002]}},"geo":"geo","frame":null},{"colorbar":{"title":"Nuclear Generation (TWh)","ticklen":2,"len":1,"y":0.10000000000000001,"orientation":"h","lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":true,"locationmode":"country names","z":[0,8.4420000000000002,0,0,0,0,0,43.523600000000151,16.128824302217261,16.555288000000001,100.4939536842105,0,348.69999999999999,0,0,0,30.246208840000001,0,0,0,0,23.870000000000001,399.01158700000002,75.071235999999999,0,16.288,0,45.16288999999999,0,6.41063387978142,0,0,0,0,65.636142100000001,0,0,0,0,0,0,11.18983001,0,3.909748,0,0,0,0,9.1826642702034231,0,0,0,0,0,11.279999999999999,208.98567,0,0,15.282,5.8212570000000001,13.252000000000001,145.90966948799999,58.277189389999997,0,66.129845000000003,25.280000000000001,0,0,0,0,83.002700000000004,0,56.184000000000012,852.00974947368422,0,0,0],"locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"name":"Nuclear","visible":false,"type":"choropleth","marker":{"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":1272.538,"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":false,"color":[0,8.4420000000000002,0,0,0,0,0,43.523600000000151,16.128824302217261,16.555288000000001,100.4939536842105,0,348.69999999999999,0,0,0,30.246208840000001,0,0,0,0,23.870000000000001,399.01158700000002,75.071235999999999,0,16.288,0,45.16288999999999,0,6.41063387978142,0,0,0,0,65.636142100000001,0,0,0,0,0,0,11.18983001,0,3.909748,0,0,0,0,9.1826642702034231,0,0,0,0,0,11.279999999999999,208.98567,0,0,15.282,5.8212570000000001,13.252000000000001,145.90966948799999,58.277189389999997,0,66.129845000000003,25.280000000000001,0,0,0,0,83.002700000000004,0,56.184000000000012,852.00974947368422,0,0,0]}},"geo":"geo","frame":null},{"colorbar":{"title":"Geo Generation (TWh)","ticklen":2,"len":1,"y":0.10000000000000001,"orientation":"h","lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":true,"locationmode":"country names","z":[0,1.4756513335109449,3.4677261879623038,4.6682662506241286,0.097950000000000009,0.003728,0.11,5.1736000000000111,54.920876610949037,1.820811,10.307284210526319,7.9312649366435073,112.72522499999999,2.4441278699814371,0.97029999999999994,0.057920000000000013,5.0306548253999992,5.9431459999999996,0.45472344827000011,0,1.363,13.292058000000001,8.8572533279945311,50.323,0.40202700000000002,2.2450000000000001,6.0181382960000001,31.511575800820498,26.281500000000001,0.010685999999999999,0,0.85478500000000013,0.12,25.637499999999999,32.156211984598492,0.0049671000000000003,0,0.92742000000000013,0.5331999999999999,0.27812900000000002,1.1359999999999999,7.2146982529999999,0,5.8143450000000003,8.9818382293409904,0.055103000000000013,0.25300499999999998,0,0.61805323093276643,0.45461111111111469,11.731147,7.6829840000000003,3.5779999999999998,0.117575,0.50414400000000004,0.53854899999999994,0,0.76027693116676165,1.6930000000000001,0.25621199999999988,0.431334,10.56956437868142,5.6370648099999991,0.11749999999999999,13.036,1.8620000000000001,12.58642496700001,0,13.575900000000001,0,0.40689999999999998,0,37.395679999999992,76.820543157894733,0,0,0.12620999999999999],"locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"name":"Geo","visible":false,"type":"choropleth","marker":{"line":{"colorbar":{"title":"","ticklen":2},"cmin":0,"cmax":1272.538,"colorscale":[["0","rgba(255,245,240,1)"],["0.0416666666666667","rgba(255,238,230,1)"],["0.0833333333333333","rgba(255,231,220,1)"],["0.125","rgba(254,224,210,1)"],["0.166666666666667","rgba(254,212,193,1)"],["0.208333333333333","rgba(253,199,177,1)"],["0.25","rgba(252,187,161,1)"],["0.291666666666667","rgba(253,174,145,1)"],["0.333333333333333","rgba(253,160,129,1)"],["0.375","rgba(252,146,114,1)"],["0.416666666666667","rgba(252,133,101,1)"],["0.458333333333333","rgba(252,120,87,1)"],["0.5","rgba(251,106,74,1)"],["0.541666666666667","rgba(247,92,64,1)"],["0.583333333333333","rgba(243,77,54,1)"],["0.625","rgba(239,59,44,1)"],["0.666666666666667","rgba(227,49,39,1)"],["0.708333333333333","rgba(215,37,34,1)"],["0.75","rgba(203,24,29,1)"],["0.791666666666667","rgba(190,21,26,1)"],["0.833333333333333","rgba(178,18,24,1)"],["0.875","rgba(165,15,21,1)"],["0.916666666666667","rgba(144,9,19,1)"],["0.958333333333333","rgba(123,3,16,1)"],["1","rgba(103,0,13,1)"]],"showscale":false,"color":[0,1.4756513335109449,3.4677261879623038,4.6682662506241286,0.097950000000000009,0.003728,0.11,5.1736000000000111,54.920876610949037,1.820811,10.307284210526319,7.9312649366435073,112.72522499999999,2.4441278699814371,0.97029999999999994,0.057920000000000013,5.0306548253999992,5.9431459999999996,0.45472344827000011,0,1.363,13.292058000000001,8.8572533279945311,50.323,0.40202700000000002,2.2450000000000001,6.0181382960000001,31.511575800820498,26.281500000000001,0.010685999999999999,0,0.85478500000000013,0.12,25.637499999999999,32.156211984598492,0.0049671000000000003,0,0.92742000000000013,0.5331999999999999,0.27812900000000002,1.1359999999999999,7.2146982529999999,0,5.8143450000000003,8.9818382293409904,0.055103000000000013,0.25300499999999998,0,0.61805323093276643,0.45461111111111469,11.731147,7.6829840000000003,3.5779999999999998,0.117575,0.50414400000000004,0.53854899999999994,0,0.76027693116676165,1.6930000000000001,0.25621199999999988,0.431334,10.56956437868142,5.6370648099999991,0.11749999999999999,13.036,1.8620000000000001,12.58642496700001,0,13.575900000000001,0,0.40689999999999998,0,37.395679999999992,76.820543157894733,0,0,0.12620999999999999]}},"geo":"geo","frame":null},{"locationmode":"country names","type":"scattergeo","mode":"markers","locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"marker":{"color":"black","size":[4.2033315,3.9894862,16.419682000000002,7.6505236999999999,3.6879482000000001,0.55376700000000001,6.4130324999999999,8.6383749999999999,2.243357,5.9915700000000003,15.582993500000001,4.8300643000000001,7.5541653999999996,1.9215612,4.3240995,5.9756974999999999,9.5866140000000009,5.3409405000000003,2.3215560000000002,2.4251409000000002,9.3291839999999997,7.6757298,4.9128565999999996,8.5046990000000005,6.2186560000000002,5.0384419999999999,9.829243,1.8989491000000001,2.4461333999999999,8.1206560000000003,4.5027084000000004,7.6236730000000001,6.8129340000000003,5.6796410000000002,8.7924380000000006,15.866766999999999,23.498792999999999,3.9908507000000002,4.8869429999999996,15.729075,8.2049599999999998,3.7749554999999999,1.8897853,8.813599,7.4855384999999997,3.7815452000000001,7.9995737,15.68125,0.92282770000000003,1.7572007000000001,1.3157338000000001,8.2737829999999999,4.6277156000000002,36.032620000000001,3.9453893,11.612026999999999,18.323464999999999,5.0996385000000002,6.1929974999999997,6.6487335999999999,8.0383510000000005,12.472092999999999,5.3430470000000003,1.0263492000000001,3.9913132,4.2834430000000001,4.070233,26.821891999999998,4.8120703999999996,12.139735999999999,5.0226459999999999,22.633891999999999,5.4621234000000003,15.730885000000001,3.6024541999999999,3.0758011000000001,3.560416],"sizemode":"area","sizeref":0.080000000000000002,"line":{"color":"rgb(40,40,40)","width":0.5}},"name":"Total CO2 Emissions","line":{"color":"rgba(140,86,75,1)"},"geo":"geo","frame":null},{"locationmode":"country names","type":"scattergeo","mode":"markers","locations":["Algeria","Argentina","Australia","Austria","Azerbaijan","Bangladesh","Belarus","Belgium","Brazil","Bulgaria","Canada","Chile","China","Colombia","Croatia","Cyprus","Czech Republic","Denmark","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Japan","Kazakhstan","Kuwait","Latvia","Lithuania","Luxembourg","Malaysia","Mexico","Morocco","Netherlands","New Zealand","North Macedonia","Norway","Oman","Pakistan","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russian Federation","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Thailand","Trinidad & Tobago","Turkey","Turkmenistan","Ukraine","United Arab Emirates","United Kingdom","US","Uzbekistan","Venezuela","Vietnam"],"marker":{"color":"grey","size":[32.833085390000001,13.511189180000001,6.7454978590000003,12.16821803,25.4950546,63.425528499999999,16.423512850000002,12.6724532,11.653991209999999,19.365945830000001,7.1001560049999997,22.765857189999998,47.672634389999999,22.010727469999999,18.46495986,15.573802929999999,16.751400929999999,9.7859597550000004,19.97447395,67.88817813,5.8935623809999997,5.5653301969999998,11.405750380000001,11.805807160000001,14.2538714,16.494349329999999,5.698616135,83.199316339999996,19.37146134,38.015083150000002,48.468252159999999,7.8540942180000002,19.759896879999999,16.088281330000001,13.46980666,20.294854470000001,60.966480130000001,12.011658349999999,10.373504110000001,10.06890585,16.590996310000001,20.124012029999999,35.052840879999998,12.039286199999999,6.0483054960000002,30.269318559999999,6.6423833739999996,44.57247023,62.574249870000003,30.82669477,18.82613108,22.642005099999999,8.2548022440000004,76.049293030000001,15.671089520000001,11.59553193,61.508241069999997,18.765882479999998,18.365214640000001,16.969404430000001,28.67475434,27.440339259999998,9.7287884770000002,19.964395809999999,5.6475728549999999,9.9027097009999991,27.402713559999999,21.970725470000001,26.03180162,26.197662510000001,14.531444759999999,43.667025520000003,10.092844019999999,7.6636925160000002,34.786095570000001,21.746988779999999,20.3898157],"sizemode":"area","sizeref":0.20000000000000001,"line":{"color":"rgb(40,40,40)","width":0.5}},"name":"PM Exposure","line":{"color":"rgba(227,119,194,1)"},"geo":"geo","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><em>Note : This interactive map displays data for the year 2019, which represents the most recent year for which we have observations of PM2.5 exposure.</em></p>
</section>
<section id="relationship-between-renewable-energy-generation-co2-emissions-and-pm2.5-exposure" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-renewable-energy-generation-co2-emissions-and-pm2.5-exposure">3.5 Relationship Between Renewable Energy Generation, CO2 emissions and PM2.5 exposure</h2>
<p>The exploration thus far has provided a comprehensive overview of the status and trends in renewable energy generation, CO2 emissions, and PM2.5 exposure. However, the exploratory data analysis conducted does not allow us to conclude that changes in CO2 emissions and PM2.5 exposure are solely due to the rise in renewable energy use.. This observation underscores the complexity of these phenomena and the multifaceted interplay of various factors influencing them. Thereofre, to uncover potential underlying relationships or causations, a more in-depth analysis of these correlations is required.</p>
<section id="renewable-energies-impact-on-co2-emissions" class="level3">
<h3 class="anchored" data-anchor-id="renewable-energies-impact-on-co2-emissions">3.5.1 Renewable Energies’ impact on CO2 emissions</h3>
<p>Upon closer examination, the advantages of renewable energy, regrettably, don’t always align with visual impressions. The depicted graph underscores the intricate relationship between average total renewable energy generation and CO2 emissions. This positive relationships sheds light on the imperative need for decisive measures from the world’s major CO2 emitters, emphasizing that reducing emissions demands concerted efforts beyond merely introducing new renewable energy projects. This comparison suggests that merely increasing renewable energy generation is insufficient to offset the escalation of CO2 emissions resulting from economic growth, industrialization, transportation, and related factors.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">### TOTAL AVG RENEWABLE VS C02</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average renewable energy production across the years</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>avg_renewables <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_wind =</span> <span class="fu">mean</span>(wind_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_solar =</span> <span class="fu">mean</span>(solar_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_geo =</span> <span class="fu">mean</span>(geo_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hydro =</span> <span class="fu">mean</span>(hydro_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_nuclear =</span> <span class="fu">mean</span>(nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_renewables =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"avg"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average CO2 emissions across the years</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>avg_co2 <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_CO2 =</span> <span class="fu">mean</span>(CO2_emissions <span class="sc">*</span> Population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the two datasets</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(avg_renewables, avg_co2, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot with hover labels and trend line</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>avg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(merged_data, <span class="fu">aes</span>(<span class="at">x =</span> avg_CO2, <span class="at">y =</span> avg_renewables, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="at">segment.size =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># Add labels on hover</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add a linear regression line</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total Average : Renewable Energy vs CO2 Emissions"</span>,</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Total Renewable Energy Generated (TWh)"</span>, </span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Total CO2 Emissions (Tons)"</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Yet, amidst the challenges, some nations stand out for their commendable efforts. Iceland and Norway, in particular, showcase noteworthy commitment, achieving high per capita renewable energy generation coupled with relatively low per capita CO2 emissions. Additionally, there are noteworthy positive outliers in the cases of Sweden and Switzerland, albeit to a lesser extent. These instances further underscore the potential impact of wealthy nations implementing robust renewable energy strategies as effective measures to mitigate carbon emissions. Nevertheless, these isolated instances do not provide enough evidence to draw any global-scale conclusions regarding the impact of renewable energy generation on CO2 emissions.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">### PER CAPITA AVG RENEWABLE VS C02</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average renewable energy production across the years</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>avg_renewablesall <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_wind =</span> <span class="fu">mean</span>(wind_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_solar =</span> <span class="fu">mean</span>(solar_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_geo =</span> <span class="fu">mean</span>(geo_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hydro =</span> <span class="fu">mean</span>(hydro_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_nuclear =</span> <span class="fu">mean</span>(nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_renewables =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"avg"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average CO2 emissions across the years</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>avg_co2 <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_CO2 =</span> <span class="fu">mean</span>(CO2_emissions, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the two datasets</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(avg_renewablesall, avg_co2, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot with hover labels and trend line</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>avg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(merged_data, <span class="fu">aes</span>(<span class="at">x =</span> avg_renewables, <span class="at">y =</span> avg_CO2, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="at">segment.size =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add labels on hover</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add a linear regression line</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Per Capita Average : Renewable Energy Generation vs CO2 Emissions"</span>,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Per Capita Renewable Energy Generation (TWh)"</span>,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Per Capita CO2 Emissions (Tons)"</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>In the following graph, we observe a certain randomness in our data. Despite increasing renewable energy production year over year (seen by almost all of the points being above 0% on the y axis), there is no apparent trend in decreasing CO2 emissions(a roughly 50/50 spread of data either side of the 0% on the x axis). The intricacies of this relationship may be influenced by numerous factors, including the energy-intensive nature of building renewable infrastructure. As we are currently in the adoption phase, a substantial portion of the energy used for infrastructure development still originates from CO2-emitting sources. This complexity underscores the multifaceted nature of the data points and the evolving dynamics within the renewable energy landscape.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">### YEARLY CHANGE CO2 VS RENEW</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate yearly rate of change of total renewable energy as a percentage</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>raw_df_rate_change <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_renewable_energy =</span> <span class="fu">sum</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">CO2_emissions =</span> <span class="fu">sum</span>(CO2_emissions)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate_change_renewable =</span> <span class="fu">c</span>(<span class="cn">NA</span>, (<span class="fu">diff</span>(total_renewable_energy) <span class="sc">/</span> <span class="fu">lag</span>(total_renewable_energy)) <span class="sc">*</span> <span class="dv">100</span>)[<span class="sc">-</span><span class="dv">1</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CO2_emissions_change =</span> (CO2_emissions <span class="sc">/</span> <span class="fu">lag</span>(CO2_emissions) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatter plot with a line of best fit using ggplot</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(raw_df_rate_change, <span class="fu">aes</span>(<span class="at">x =</span> CO2_emissions_change, <span class="at">y =</span> rate_change_renewable, <span class="at">label =</span> year)) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="at">segment.size =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co"># Add labels on hover</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Yearly change : Renewable energy generation vs CO2 emissions"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Yearly Rate of Change of CO2 Emissions (%)"</span>,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Yearly Rate of Change of Total Renewable Energy (%)"</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Upon closer examination at the country level, we can still identify instances in which an increase in renewable energy is accompanied by a decrease in CO2 emissions. However, even among the countries with the highest cumulative renewable energy generation per capita, it remains challenging to discern a significant overall trend. The plot comparing changes in CO2 emissions per capita and renewable energy generation per capita over time for these high-renewable-generation countries reveals a nuanced picture. Notably, Switzerland and France experienced a reduction in CO2 emissions alongside increased renewable energy generation, while Iceland, to a lesser extent, exhibited a notable slowdown in emissions growth despite a substantial increase in renewable energy. Nonetheless, for the majority of cases, a clear-cut relationship is elusive. Additionnaly, it’s essential to highlight that our analysis encompasses both high and low renewable energy generation countries, and even among the nations with the highest renewable generation, a definitive negative relationship between renewable energy generation and CO2 emissions is not readily apparent. This underscores the challenge, as for countries with lower renewable energy generation, the absence of a discernible relationship becomes even more pronounced.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">### FACET GRID PER COUNTRY RENEW VS CO2</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total renewable energy production for each country and year</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>total_renewables <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_renewables =</span> <span class="fu">sum</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate PM exposure for each country and year without filtering</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>pm_exposure <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PM_exposure =</span> <span class="fu">mean</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the total renewables data with the PM exposure data using a left join</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(total_renewables, pm_exposure, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>), <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the top 10 countries with the highest total renewable energy production</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_renewables =</span> <span class="fu">sum</span>(total_renewables, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_renewables)) <span class="sc">%&gt;%</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for only these top countries</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_countries)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the data for PM exposure and renewable energy to allow using a secondary y-axis</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>max_PM <span class="ot">&lt;-</span> <span class="fu">max</span>(filtered_data<span class="sc">$</span>PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>max_renewables <span class="ot">&lt;-</span> <span class="fu">max</span>(filtered_data<span class="sc">$</span>total_renewables, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_PM =</span> PM_exposure <span class="sc">/</span> max_PM,</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">norm_renewables =</span> total_renewables <span class="sc">/</span> max_renewables)</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the rest of your code is correct and the data is prepared as `filtered_data`</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line plot with two separate y-axes and legends for PM Exposure and Renewable Energy</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> norm_renewables, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">linetype =</span> <span class="st">"Renewable Energy"</span>)) <span class="sc">+</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> filtered_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data), <span class="fu">aes</span>(<span class="at">y =</span> norm_PM, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">linetype =</span> <span class="st">"PM Exposure"</span>), <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> country, <span class="at">scales =</span> <span class="st">'free_x'</span>) <span class="sc">+</span> <span class="co"># Allows each country to have its own x-axis scale</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Normalized Renewable Energy Generation"</span>,</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> ., <span class="at">name =</span> <span class="st">"Normalized PM Exposure"</span>)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">2020</span>)) <span class="sc">+</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Renewable energy generation vs PM exposure by country"</span>,</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_data<span class="sc">$</span>country))),</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">unique</span>(filtered_data<span class="sc">$</span>country),</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">unique</span>(filtered_data<span class="sc">$</span>country),</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Country"</span>) <span class="sc">+</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Renewable Energy"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"PM Exposure"</span> <span class="ot">=</span> <span class="st">"dashed"</span>),</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Based on the comprehensive analysis of the relationship between renewable energy sources and CO2 emissions, it becomes evident that there is no discernible reduction in CO2 emissions directly attributable to the increased generation of renewable energy. These findings indicate that, at least for the present, it is not possible to definitively conclude that renewable energy generation significantly contributes to a reduction in CO2 emissions on a global scale. While renewable energy remains a crucial component of sustainable practices, the complex interplay of various factors affecting emissions necessitates a more nuanced understanding of the dynamics involved in achieving substantial reductions in CO2 emissions.</p>
</section>
<section id="renewable-energies-impact-on-pm2.5-exposure" class="level3">
<h3 class="anchored" data-anchor-id="renewable-energies-impact-on-pm2.5-exposure">3.5.2 Renewable Energies’ impact on PM2.5 Exposure</h3>
<p>What about the correlation between renewable energy generation and PM2.5 exposure? The associations between these two variables appear to hold more promise. Notably, a clear decreasing trend between these variables is observable, suggesting that an increase in renewable energy could potentially lead to a reduction in PM2.5 exposure. Nevertheless, it’s important to maintain perspective. The countries displaying the highest levels of renewable energy generation and at the same time lowest PM2.5 exposure, such as Sweden, Norway, Iceland, Canada and so on, primarily belong to occidental regions, characterized by superior infrastructure, effective air quality management, and well-defined energy policies. Therefore, while the trend regarding renewable energy generation and reduced PM2.5 exposure is encouraging, it’s essential to acknowledge that some aspects of this relationship might also be influenced by other factors that our data may not capture comprehensively.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">###  AVG RENEWABLE VS AVG PM2.5</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average renewable energy production across the years</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>avg_renewablesall <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_wind =</span> <span class="fu">mean</span>(wind_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_solar =</span> <span class="fu">mean</span>(solar_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_geo =</span> <span class="fu">mean</span>(geo_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hydro =</span> <span class="fu">mean</span>(hydro_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_nuclear =</span> <span class="fu">mean</span>(nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_renewables =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"avg"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average PM exposure across the years</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>avg_pm <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_PM_exposure =</span> <span class="fu">mean</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the two datasets</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>merged_data_pm <span class="ot">&lt;-</span> <span class="fu">merge</span>(avg_renewablesall, avg_pm, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot with hover labels and trend line</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>avg3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(merged_data_pm, <span class="fu">aes</span>(<span class="at">x =</span> avg_renewables, <span class="at">y =</span> avg_PM_exposure, <span class="at">label =</span> country)) <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="at">segment.size =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Add a linear regression line</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average renewable energy per capita vs Average PM exposure"</span>,</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Renewable Energy Per Capita"</span>,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average PM Exposure"</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Examining the situation at the country level reveals a consistent pattern of decreasing PM exposure with high renewable energy generation. This trend becomes evident when we focus on countries with the highest levels of renewable energy generation, as illustrated in the subsequent plot. It strongly implies that in nations boasting substantial renewable energy production a reduction in PM exposure is consistently observed, as depicted in previous graph.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">### FACET GRID PER COUNTRY RENEW VS PM2.5 with high renew gen</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total renewable energy production for each country and year</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>total_renewables <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_renewables =</span> <span class="fu">sum</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out the years we don't have data for PM exposure</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>raw_df_filtered <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate PM exposure for each country and year</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>pm_exposure <span class="ot">&lt;-</span> raw_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PM_exposure =</span> <span class="fu">mean</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the total renewables data with the PM exposure data</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(total_renewables, pm_exposure, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>))</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the top 10 countries with the highest total renewable energy production</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_renewables =</span> <span class="fu">sum</span>(total_renewables, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_renewables)) <span class="sc">%&gt;%</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for only these top countries</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_countries)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the data for PM exposure and renewable energy to allow using a secondary y-axis</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>max_PM <span class="ot">&lt;-</span> <span class="fu">max</span>(filtered_data<span class="sc">$</span>PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>max_renewables <span class="ot">&lt;-</span> <span class="fu">max</span>(filtered_data<span class="sc">$</span>total_renewables, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_PM =</span> PM_exposure <span class="sc">/</span> max_PM,</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">norm_renewables =</span> total_renewables <span class="sc">/</span> max_renewables)</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line plot with two separate y-axes and legends for PM Exposure and CO2 Emissions</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> norm_renewables, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">linetype =</span> <span class="st">"Renewable Energy"</span>)) <span class="sc">+</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> norm_PM, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">linetype =</span> <span class="st">"PM Exposure"</span>), <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> country, <span class="at">scales =</span> <span class="st">'free_x'</span>) <span class="sc">+</span> <span class="co"># Allows each country to have its own x-axis scale</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Normalized Renewable Energy Generation"</span>,</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> ., <span class="at">name =</span> <span class="st">"Normalized PM Exposure"</span>)</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Renewable energy generation vs PM exposure for highest renewable energy generation"</span>,</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_data<span class="sc">$</span>country))),</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">unique</span>(filtered_data<span class="sc">$</span>country),</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">unique</span>(filtered_data<span class="sc">$</span>country),</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Country"</span>) <span class="sc">+</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Renewable Energy"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"PM Exposure"</span> <span class="ot">=</span> <span class="st">"dashed"</span>),</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Nevertheless, we observe that countries characterized by the lowest levels of renewable energy generation do not exhibit any substantial decline in PM2.5 exposure, indicating a stable or rising trend in PM levels. This observation suggests that low renewable energy generation is associated with a consistent or even increasing trend in PM exposure. However, it’s important to acknowledge that the low levels of renewable energy generation may not be the sole explanation for this relationship. Indeed, these nations are often high CO2 emitters known for pollution, or are developing nations with less advanced infrastructure, energy management practices, and technological resources.</p>
<details>
<summary>
Code
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">### FACET GRID PER COUNTRY RENEW VS PM2.5 with low renew gen</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Years for which we have PM exposure data</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>years_with_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2000</span>, <span class="dv">2005</span>, <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total renewable energy production for each country and year</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>total_renewables <span class="ot">&lt;-</span> all_df <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_renewables =</span> <span class="fu">sum</span>(wind_generation, solar_generation, geo_generation, hydro_generation, nuclear_generation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out the years we don't have data for PM exposure</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>raw_df_filtered <span class="ot">&lt;-</span> raw_df <span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> years_with_data)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate PM exposure for each country and year</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>pm_exposure <span class="ot">&lt;-</span> raw_df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, year) <span class="sc">%&gt;%</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">PM_exposure =</span> <span class="fu">mean</span>(PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the total renewables data with the PM exposure data</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(total_renewables, pm_exposure, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>))</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the top 10 countries with the highest total renewable energy production</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_renewables =</span> <span class="fu">sum</span>(total_renewables, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_renewables)) <span class="sc">%&gt;%</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country)</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data for only these top countries</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top_countries)</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the data for PM exposure and renewable energy to allow using a secondary y-axis</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>max_PM <span class="ot">&lt;-</span> <span class="fu">max</span>(filtered_data<span class="sc">$</span>PM_exposure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>max_renewables <span class="ot">&lt;-</span> <span class="fu">max</span>(filtered_data<span class="sc">$</span>total_renewables, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">norm_PM =</span> PM_exposure <span class="sc">/</span> max_PM,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">norm_renewables =</span> total_renewables <span class="sc">/</span> max_renewables)</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a line plot with two separate y-axes and legends for PM Exposure and CO2 Emissions</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>fg3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> norm_renewables, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">linetype =</span> <span class="st">"Renewable Energy"</span>)) <span class="sc">+</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> norm_PM, <span class="at">group =</span> country, <span class="at">color =</span> country, <span class="at">linetype =</span> <span class="st">"PM Exposure"</span>), <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> country, <span class="at">scales =</span> <span class="st">'free_x'</span>) <span class="sc">+</span> <span class="co"># Allows each country to have its own x-axis scale</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Normalized Renewable Energy Generation"</span>,</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> ., <span class="at">name =</span> <span class="st">"Normalized PM Exposure"</span>)</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Renewable energy generation vs PM exposure for highest renewable energy generation"</span>,</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> scales<span class="sc">::</span><span class="fu">hue_pal</span>()(<span class="fu">length</span>(<span class="fu">unique</span>(filtered_data<span class="sc">$</span>country))),</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">unique</span>(filtered_data<span class="sc">$</span>country),</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">unique</span>(filtered_data<span class="sc">$</span>country),</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Country"</span>) <span class="sc">+</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Renewable Energy"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"PM Exposure"</span> <span class="ot">=</span> <span class="st">"dashed"</span>),</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">"Type"</span>) <span class="sc">+</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>),  </span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.4</span>, <span class="st">"cm"</span>)</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="eda_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>We observe an encouraging trend where PM2.5 exposure decreases as renewable energy generation increases, particularly in well-developed countries such as Sweden, Iceland, and Canada, where advanced technologies and energy policies are in place. This trend, while not as evident in less developed nations, offers a hopeful outlook, suggesting that with mindful energy generation and management, these countries could potentially replicate the positive outcomes seen in their more developed counterparts.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>