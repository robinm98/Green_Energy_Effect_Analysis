# Analysis

```{r, echo = FALSE, message = FALSE, warning = FALSE}
source(here::here("Transcript/setup.R"))
```

Embarking on the analysis phase, we move beyond basic and multivariate comparisons to delve into the intricacies of our dataset. Visual trends have highlighted a global transition to sustainable energy sources, propelled by a blend of environmental awareness, policy incentives, and technological advancements. While the initial years emphasized hydroelectric dominance, subsequent decades saw the rise of nuclear, solar, and wind amid a continuous growth in emissions. Now, our focus shifts to a nuanced exploration of the evolving relationship between renewable energy, CO2 emissions, and air quality. Our aim is to unravel any complexities and unveil insights into the dynamic interplay, providing a deeper understanding of the forces shaping our sustainable energy landscape.

## The Models

In scrutinizing the Correlation Matrix detailed in section 3.1.3, a preliminary observation unfolded: renewable sources exhibit varying degrees of negative correlation with CO2 emissions. Specifically possessing the following correlation values, Wind (`r allcor_matrix[3]`), Solar (`r allcor_matrix[4]`), Geo (`r allcor_matrix[5]`), Hydro (`r allcor_matrix[6]`), and Nuclear (`r allcor_matrix[7]`). Wind and Nuclear stand out as statistically significant contributors to this relationship. Despite these findings, the magnitudes of these correlations are somewhat modest, leaving room for deeper exploration.

Our quest for understanding the intricate relationship between CO2 emissions and renewables persists. Analysis in section 3.6.1, "Renewable Energies' impact on CO2 emissions", reveals an interesting narrative. Contrary to expectations, an increase in renewable energy production coincides with higher CO2 emissions. Noteworthy anomalies, represented by small wealthy nations, challenge the general trend by either surpassing their expected CO2 per capita estimate or exhibiting elevated renewable energy production per capita.

### Basic Multiple Linear Regression

To address our first research question, "To what extent does sustainable energy generation impact carbon dioxide emissions?", we began by constructing a basic multiple linear regression model using `raw_df`, transforming all values into logarithmic scales for both total emissions and total renewable energy generated by each country.

$$logCO2 = {\beta}_0 + logwind{\beta}_1 + logsolar{\beta}_2 + loggeo{\beta}_3 + loghydro{\beta}_4+ lognuclear{\beta}_5 + \epsilon$$

<details>
<summary>Code</summary>
```{r, echo = TRUE, message = FALSE, warning=FALSE, results='asis'}
### MODEL 1 CO2###

log_raw <- raw_df %>%
  mutate(
    log_wind = log(wind_generation),
    log_solar = log(solar_generation),
    log_geo = log(geo_generation),
    log_hydro = log(hydro_generation),
    log_nuclear = log(nuclear_generation),
    log_CO2 = log(CO2_emissions * Population)
  )

log_raw <- log_raw %>%
  mutate_at(vars(-country), ~ ifelse(is.infinite(.), 0, .))


# Fit a multiple linear regression model
model <- lm(log_CO2 ~ log_wind + log_solar + log_geo + log_hydro + log_nuclear, data = log_raw)
```
</details>
```{r, echo = FALSE, message = FALSE, warning=FALSE, results='asis'}
cat('<table class="center">', sep = '\n')
stargazer(model, 
          title = 'CO2 Basic Logarithmic Multiple Linear Regression', 
          type = 'html', 
          digits = 3)
cat('</table>', sep = '\n')
```

At a glance of our basic model  notable insights emerge. The pivotal p-values linked to each variable offer valuable interpretive cues. Wind, geothermal, hydro, and nuclear energies exhibit p-values below 0.05, indicating statistical significance in their relationship with CO2 emissions. However, solar energy's p-value surpasses this threshold, suggesting a non-significant impact on CO2 emissions within this model.

Intriguingly, we need to consider the positive correlation reflected in all coefficients with significant p-values, particularly noteworthy in the cases of Hydro and Nuclear energies, strongly influencing the rate of CO2 change. The marginal associations of Wind and Solar energy may find explanation in their emergence as globally prevalent renewable sources, gaining prominence since the turn of the century.

While the model's R-squared value of approximately 39% implies potential explanatory power, reservations linger. We remain cautious about inferring causation from this model alone. Despite its ability to provide a substantial portion of the relationship between renewable energy and CO2 emissions, the broader socio-economic context plays a pivotal role. Our society's continual quest for production and economic expansion inherently accompanies an increase in CO2 emissions. Simultaneously, the integration of new technologies, including renewable energies, further complicates the intricate relationship between environmental factors and human activities.

### Fixed Time Effect Model

The fixed time effect model is a robust approach for our dataset, accounting for time-specific variations across the observed years. This model is particularly apt when we anticipate and want to control for potential time-dependent factors that could influence the relationship between renewable energy variables and CO2 emissions. The 'Within Model' specification implies that individual country-specific effects are removed, isolating the time-specific changes and offering a more focused examination of the impact of renewable energy sources.

<details>
<summary>Code</summary>
```{r, echo = TRUE, message = FALSE, warning=FALSE, results='asis'}
### MODEL 2 CO2###

# Creation of the data frame for the fixed effect
log_raw_p <- pdata.frame(log_raw, index = c("country", "year"))

#Creation of a model with time fixed effect
modelplm <- plm(log_CO2 ~ log_wind + log_solar + log_geo + log_hydro + log_nuclear,
             data = log_raw_p,
             effect = "time", # This specifies time fixed effects
             model = "within") # This chooses the within estimator, which is for fixed effects
```
</details>
```{r, echo = FALSE, message = FALSE, warning=FALSE, results='asis'}
stargazer(modelplm,
          title = 'CO2 Fixed Time Logarithmic Multiple Linear Regression',
          type = 'html',
          digits = 3)
```

In delving into the results of the new model, several familiar insights emerge. Somewhat noteworthy is that, all renewable energy sources, except solar, again exhibit statistically significant effects on CO2 emissions. Wind, geothermal, hydro, and nuclear energies showcase coefficients with p-values less than 0.05, indicating significant impact.

Hydro and nuclear energies continue to display positive correlations with CO2 emissions, while wind energy demonstrates a positive albeit smaller effect. These results mirror our previous model's findings, emphasizing the intricate dynamics within the renewable energy landscape. The model's comparatively reduced R-squared value of approximately 36.4% still indicates a substantial portion of the variance in CO2 emissions is explained by the included variables.

### Dataframe Adjustment

Having found what we believe to be the most suitable model of a fixed time effect, we need to assess the data we were using and its relevance. In particular, for results pertaining to Solar and Wind Generation. Opting for the `raw_1990` dataset over the broader `raw_df` offers several advantages for our analysis. Focusing on data from 1990 onwards allows for a more recent examination of the relationship between renewable energy generation and CO2 emissions. By narrowing the timeframe, we ensure that the data captures more relevant and representative information regarding the current state of various energy sources. Additionally, limiting the scope to post-1990 data facilitates a more consistent and comparable analysis across countries and energy types, aligning with a period marked by increased global attention to sustainable practices and greater advancements in renewable energy technologies. Overall, the `raw_1990` dataset provides a refined lens through which we can discern the dynamics of renewable energy's impact on CO2 emissions.

<details>
<summary>Code</summary>
```{r, echo = TRUE, message = FALSE, warning=FALSE, results='asis'}
### MODEL 3 CO2###

log_raw1990 <- raw_1990 %>%
  mutate(
    log_wind = log(wind_generation),
    log_solar = log(solar_generation),
    log_geo = log(geo_generation),
    log_hydro = log(hydro_generation),
    log_nuclear = log(nuclear_generation),
    log_CO2 = log(CO2_emissions * Population)
  )

log_raw1990 <- log_raw1990 %>%
  mutate_at(vars(-country), ~ ifelse(is.infinite(.), 0, .))


# Creation of the data frame for the fixed effect
log_raw1990_p <- pdata.frame(log_raw1990, index = c("country", "year"))

#Creation of a model with time fixed effect
modelplm1990 <- plm(log_CO2 ~ log_wind + log_solar + log_geo + log_hydro + log_nuclear,
             data = log_raw1990_p,
             effect = "time", # This specifies time fixed effects
             model = "within") # This chooses the within estimator, which is for fixed effects
```
</details>
```{r, echo = FALSE, message = FALSE, warning=FALSE, results='asis'}

stargazer(modelplm1990,
          title = 'CO2 Fixed Time Logarithmic Multiple Linear Regression Since 1990',
          type = 'html',
          digits = 3)
```

Below, we assess the impact of each energy source on CO2 emissions:

- **log_wind**: For a one-unit increase in the natural logarithm of wind energy generation, the natural logarithm of CO2 emissions is estimated to increase by approximately 0.0395 units. This positive coefficient suggests that higher wind energy generation is associated with an increase in CO2 emissions.

- **log_solar**: For a one-unit increase in the natural logarithm of solar energy generation, the natural logarithm of CO2 emissions is estimated to increase by approximately 0.0087 units. However, it is not statistically significant (p-value = 0.4), suggesting that solar energy generation might not have a substantial impact on CO2 emissions in this model.

- **log_geo**: For a one-unit increase in the natural logarithm of geothermal energy generation, the natural logarithm of CO2 emissions is estimated to increase by approximately 0.0972 units. This positive coefficient suggests that higher geothermal energy generation is associated with an increase in CO2 emissions.

- **log_hydro**: For a one-unit increase in the natural logarithm of hydro energy generation, the natural logarithm of CO2 emissions is estimated to increase by approximately 0.1746 units. This positive coefficient implies that increased hydro energy generation is associated with a notable increase in CO2 emissions.

- **log_nuclear**: For a one-unit increase in the natural logarithm of nuclear energy generation, the natural logarithm of CO2 emissions is estimated to increase by approximately 0.3054 units. This positive coefficient suggests that higher nuclear energy generation is associated with a substantial increase in CO2 emissions.

The analysis, conducted using a fixed-effects model, reveals that sustainable energy generation, expect for solar, has a substantial impact on carbon dioxide emissions. The overall model, with an R-squared value of approximately 41.3%, indicates that around 41.3% of the variation in CO2 emissions can be explained by the included sustainable energy variables of, wind, solar, geothermal, hydro, and nuclear energies. This suggests a strong connection between the adoption of these sustainable energy sources and the increase in carbon dioxide emissions.

### Interpretation

The observation that increasing renewable energy generation is associated with increased CO2 emissions in our model might seem counterintuitive at first glance, but several factors could contribute to this phenomenon:

**Infrastructure Development**: The initial stages of adopting renewable energy often involve significant infrastructure development, which can be energy-intensive and may rely on conventional energy sources. The manufacturing, installation, and setup of renewable energy facilities, such as wind farms, solar arrays, nuclear power plants, and dams, can significantly contribute to CO2 emissions.

**Economic Growth**: Increased adoption of renewable energy is occurring simultaneously with economic growth. As economies expand, there is often a rise in energy demand, leading to increased overall energy production, including both renewable and non-renewable sources.

**Global Supply Chain**: The global supply chain for renewable technologies involves transportation and manufacturing processes that contribute to CO2 emissions. The extraction of raw materials for renewable technologies also has environmental impacts.

**Lag in Emission Reduction**: The transition to renewable energy is a process, and the full benefits in terms of reduced CO2 emissions might take time to materialize. During the transition, there may be a period where the growth in renewable energy is still accompanied by the use of conventional energy sources.

It's essential to consider these nuances and contextual factors when interpreting the relationship between renewable energy generation and CO2 emissions. As renewable energy infrastructure becomes more established and technology improves, we may see reductions in CO2 emissions.

## Modeling PM 2.5

Continuing with our analysis, we needed to investigate the effects of renewable energy on improving air quality in countries transitioning to cleaner sources of energy. In this model, we opted not to take the logarithm of the energy sources and PM2.5 exposure. The decision was made to maintain the original scale, facilitating a better interpretation of the coefficients. `raw_1990` remained as the dataset for the model and this decision was based on the fact that all our data for `PM_exposure` is available post-1990. Additionally, we continued employing the fixed-effects model for our analysis.

<details>
<summary>Code</summary>
```{r, echo = TRUE, message = FALSE, warning=FALSE, results='asis'}
### MODEL 1 PM###

#Creation of a model with time fixed effect
modelPMp <- plm(PM_exposure ~ wind_generation + solar_generation + geo_generation + hydro_generation + nuclear_generation,
             data = log_raw1990_p,
             effect = "time", # This specifies time fixed effects
             model = "within") # This chooses the within estimator, which is for fixed effects
```
</details>
```{r, echo = FALSE, message = FALSE, warning=FALSE, results='asis'}
#Visualization
stargazer(modelPMp,
          title = 'PM2.5 Fixed Time Multiple Linear Regression Since 1990',
          type = 'html',
          digits = 3)
````

Prior to discussing the modest R-squared value, let's first examine the coefficients of the model:

- **wind_generation**: A one-unit increase in wind energy generation is associated with a 0.1478-unit increase in PM2.5 exposure. This suggests that higher wind energy generation is linked to a moderate increase in PM2.5 exposure.

- **solar_generation**: The coefficient for solar generation is -0.0440, indicating a slight negative association. However, it is not statistically significant (p-value = 0.605), suggesting that solar energy generation might not have a substantial impact on PM2.5 exposure in this model.

- **geo_generation**: A one-unit increase in geothermal energy generation is associated with a 0.2872-unit decrease in PM2.5 exposure. This implies that higher geothermal energy generation is linked to a reduction in PM2.5 exposure.

- **hydro_generation**: A one-unit increase in hydro energy generation is associated with a 0.0122-unit increase in PM2.5 exposure. This coefficient is statistically significant (p-value = 0.049), suggesting a modest positive association between hydro energy generation and PM2.5 exposure.

- **nuclear_generation**: A one-unit increase in nuclear energy generation is associated with a 0.0303-unit decrease in PM2.5 exposure. This coefficient is statistically significant (p-value < 0.001), indicating that higher nuclear energy generation is linked to a reduction in PM2.5 exposure.

However, the R-squared value of 0.0557 suggests that the energy generation variables explain only about 5.57% of the variation in PM2.5 exposure. This low R-squared value could be attributed to several factors:

**Missing Variables**: There might be many unaccounted-for factors influencing PM2.5 exposure that are not included in our model.

**Complexity of PM2.5 Formation**: PM2.5 is influenced by various sources, including industrial activities, transportation, and meteorological conditions. The model does not capture the full complexity of these interactions.

**Spatial and Temporal Variability**: PM2.5 levels can vary significantly across different regions within countries. A fixed-effects model with specification only to the country level may not fully capture this variability.

While the R-squared value is low, the individual coefficients still provide valuable insights into the specific potential impacts of each energy generation type on PM2.5 exposure. However, further exploration and consideration of additional factors are needed to enhance the model's explanatory capacity.

## Answering The Research Questions

### To what extent does sustainable energy generation impact carbon dioxide emissions?

Our analysis uncovers a positive correlation between sustainable energy generation and carbon dioxide (CO2) emissions. Initially counterintuitive, the rise in renewable energy production aligns with increased CO2 emissions, but notable anomalies are revealed that challenge the overarching trend, notably linked to country size and wealth such as Nordic countries. The observed positive correlation may reflect that countries with robust renewable energy generation are also those with developed technologies, industries, and economy. This development often leads to increased energy demand, which, despite a rise in renewable sources, may not immediately offset the surge in industrial emissions. Hence, it's plausible that the infrastructural and economic advancements inherent to these nations inadvertently elevate CO2 emissions in the short term, as they transition towards greener practices. Finally, our chosen model elucidates approximately 41.3% of the variance in CO2 emissions, emphasizing an existing positive correlation between the adoption of sustainable energy and heightened carbon dioxide emissions.


### What are the key factors and types of sustainable energy sources that have the most significant impact on reducing CO2 emissions?

Wind, geothermal, hydro, and nuclear energies show statistically significant positive coefficients with CO2 emission rates. Solar energy, while not statistically significant, exhibits a positive coefficients but with a smaller effect. Hydro and nuclear have the largest coefficients and have been historically the most represented of the renewable variables in our data. In exploring key factors outside of our variables, exploratory analysis unveiled other important factors. Country size emerges as a pivotal factor influencing the efficacy of CO2 reduction efforts. Larger nations, endowed with extensive resources and diverse energy needs, may encounter challenges in swiftly transitioning to renewable sources, potentially affecting the overall success of emission reduction initiatives. Additionally, economic and development considerations play an important role, as the magnitude of a country's economic growth can influence its ability to invest in and adopt sustainable energy technologies. The apparent need for tailored strategies and policy frameworks that account for the unique circumstances of each nation in fostering effective and sustainable CO2 reduction.

### How does sustainable energy generation impact the quality of air (reduction of PM 2.5)?

According to our modeling, wind and hydro energy show positive associations with PM2.5 exposure, suggesting a potential trade-off between renewable energy adoption and air quality. On the other hand, solar, geothermal, and nuclear exhibit negative associations. However, only Geothermal energy is linked to a substantial reduction in PM2.5 exposure, emphasizing its positive impact on air quality. 

After considering the R-squared value of 0.0557, we know that many omitted variables are not being considered. For this reason, it is not feasible to assert that the generation of renewable energy has a considerable influence on the levels of PM2.5 exposure. It's important to also acknowledge the limitations highlighted in _section 3.4_, which is the potential oversimplification of air quality assessments based on country-wide averages across a year. These factors caution against drawing definitive conclusions and underscore the need for a more nuanced understanding of the relationship between sustainable energy generation and air quality.


### Is there a temporal trend between the growth of sustainable energy generation and the reduction in CO2 emissions and what implications does this trend hold for future sustainability efforts?

The transition to renewable energy is a gradual and complex process, with the potential for future sustainability efforts to contribute to reductions in CO2 emissions as technology advances and renewable infrastructure becomes more established. However, our current modeling limitations prevent a definitive answer to this question. Our exploratory analysis helped paint a better picture. From our line plots, we are seeing trends of per capita emissions dropping, especially in the developed countries, but it would be dangerous to link this solely to the increased adoption of renewable. Growing populations and increased efficiency are factors playing influential roles for this trend. We believe that by 2050, with a mature solar and wind energy market, and ramped up productions globally, a clearer idea may be available as to the relationships we have evaluated.